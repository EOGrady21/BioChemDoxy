
> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18HU90001 FLAG Report:,  2019-03-15 11:38:58
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18HU92037"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18HU92037 FLAG Report:,  2019-03-15 11:47:51
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged PHOSPHATE, event 92037398, station CTD-84:

           sample_key depth value method qc
 18HU92037_362_114449     0  0.25  PO4_0  1
 18HU92037_362_114448    10  0.27  PO4_0  1
 18HU92037_362_114447    20  0.23  PO4_0  1
 18HU92037_362_114446    30  0.29  PO4_0  1
 18HU92037_362_114445    40  0.52  PO4_0  7
 18HU92037_362_114444    50  0.87  PO4_0  1
 18HU92037_362_114443    60  1.05  PO4_0  1
 18HU92037_362_114442    70  1.05  PO4_0  1
 18HU92037_362_114441    80  1.22  PO4_0  1
 18HU92037_362_114440    90  1.31  PO4_0  1
 18HU92037_362_114439   100  1.41  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 92037398, station CTD-84:

           sample_key depth value method qc
 18HU92037_362_114449     0  0.57 SiO4_0  1
 18HU92037_362_114448    10  0.62 SiO4_0  1
 18HU92037_362_114447    20  0.77 SiO4_0  1
 18HU92037_362_114446    30  1.04 SiO4_0  7
 18HU92037_362_114445    40  2.52 SiO4_0  1
 18HU92037_362_114444    50  5.29 SiO4_0  1
 18HU92037_362_114443    60  9.47 SiO4_0  1
 18HU92037_362_114442    70  8.22 SiO4_0  1
 18HU92037_362_114441    80 11.03 SiO4_0  1
 18HU92037_362_114440    90 12.69 SiO4_0  1
 18HU92037_362_114439   100 13.75 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 92037400, station CTD-85:

           sample_key depth value   method qc
 18HU92037_364_114466     0  0.00 NO2NO3_0  7
 18HU92037_364_114465    10  0.00 NO2NO3_0  7
 18HU92037_364_114464    20  0.00 NO2NO3_0  1
 18HU92037_364_114463    30  0.01 NO2NO3_0  1
 18HU92037_364_114462    40  0.38 NO2NO3_0  1
 18HU92037_364_114461    50  3.88 NO2NO3_0  1
 18HU92037_364_114460    60  5.85 NO2NO3_0  1
 18HU92037_364_114459    70  6.06 NO2NO3_0  1
 18HU92037_364_114458    80  7.81 NO2NO3_0  1
 18HU92037_364_114457    90  9.38 NO2NO3_0  1
 18HU92037_364_114456   100  8.56 NO2NO3_0  1
 18HU92037_364_114455   110  8.56 NO2NO3_0  1
 18HU92037_364_114454   120  8.49 NO2NO3_0  1
 18HU92037_364_114453   130 10.01 NO2NO3_0  1
 18HU92037_364_114452   140 11.37 NO2NO3_0  1
 18HU92037_364_114451   150  9.99 NO2NO3_0  1
 18HU92037_364_114450   200 17.31 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 92037400, station CTD-85:

           sample_key depth value method qc
 18HU92037_364_114466     0  0.02  PO4_0  1
 18HU92037_364_114465    10  0.04  PO4_0  1
 18HU92037_364_114464    20  0.00  PO4_0  1
 18HU92037_364_114463    30  0.02  PO4_0  1
 18HU92037_364_114462    40  0.23  PO4_0  1
 18HU92037_364_114461    50  0.38  PO4_0  1
 18HU92037_364_114460    60  0.34  PO4_0  1
 18HU92037_364_114459    70  0.45  PO4_0  1
 18HU92037_364_114458    80  0.52  PO4_0  1
 18HU92037_364_114457    90  0.56  PO4_0  1
 18HU92037_364_114456   100  0.52  PO4_0  1
 18HU92037_364_114455   110  0.54  PO4_0  1
 18HU92037_364_114454   120  0.53  PO4_0  2
 18HU92037_364_114453   130  0.57  PO4_0  1
 18HU92037_364_114452   140  0.71  PO4_0  1
 18HU92037_364_114451   150  0.67  PO4_0  1
 18HU92037_364_114450   200  1.06  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 92037400, station CTD-85:

           sample_key depth value method qc
 18HU92037_364_114466     0  0.89 SiO4_0  1
 18HU92037_364_114465    10  0.78 SiO4_0  1
 18HU92037_364_114464    20  0.78 SiO4_0  1
 18HU92037_364_114463    30  0.97 SiO4_0  1
 18HU92037_364_114462    40  1.98 SiO4_0  1
 18HU92037_364_114461    50  2.98 SiO4_0  1
 18HU92037_364_114460    60  3.50 SiO4_0  1
 18HU92037_364_114459    70  3.52 SiO4_0  1
 18HU92037_364_114458    80  4.14 SiO4_0  1
 18HU92037_364_114457    90  4.82 SiO4_0  1
 18HU92037_364_114456   100  4.37 SiO4_0  1
 18HU92037_364_114455   110  4.54 SiO4_0  1
 18HU92037_364_114454   120  4.57 SiO4_0  2
 18HU92037_364_114453   130  5.23 SiO4_0  1
 18HU92037_364_114452   140  5.97 SiO4_0  1
 18HU92037_364_114451   150  5.35 SiO4_0  1
 18HU92037_364_114450   200  9.50 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18HU92053"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18HU92053 FLAG Report:,  2019-03-15 11:48:15
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged SALINITY, event 1, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU92053_002_121001  990.72      34.9879    3
 18HU92053_002_121002  783.33      34.9578    3
 18HU92053_002_121003  591.39      34.9331    3
 18HU92053_002_121004  403.00      35.1869    3
 18HU92053_002_121005  304.56      35.4280    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 2, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU92053_113_121006  299.44      35.4654    3
 18HU92053_113_121007  152.07      35.8230    3
 18HU92053_113_121008  122.18      35.8581    3
 18HU92053_113_121009  111.52      35.8910    3
 18HU92053_113_121010  101.84      35.9390    3
 18HU92053_113_121011   92.49      35.9741    3
 18HU92053_113_121012   82.36      36.0640    3
 18HU92053_113_121013   72.62      36.1065    3
 18HU92053_113_121014   62.54      36.1096    3
 18HU92053_113_121015   52.34      36.1196    3
 18HU92053_113_121016   42.57      36.1224    3
 18HU92053_113_121017   23.27      36.1237    3
 18HU92053_113_121018   12.97      36.1236    3
 18HU92053_113_121019    3.52      36.1235    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 3, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU92053_225_121020  300.41      36.3823    3
 18HU92053_225_121021  152.34      36.5091    3
 18HU92053_225_121022  120.91      36.5094    3
 18HU92053_225_121023  111.52      36.5098    3
 18HU92053_225_121024  102.38      36.5095    3
 18HU92053_225_121025   92.33      36.5097    3
 18HU92053_225_121026   83.11      36.5094    3
 18HU92053_225_121027   72.80      36.5093    3
 18HU92053_225_121028   62.96      36.5095    3
 18HU92053_225_121029   52.39      36.5090    3
 18HU92053_225_121030   42.99      36.5079    3
 18HU92053_225_121031   42.92      36.5077    3
 18HU92053_225_121032   22.90      36.5081    3
 18HU92053_225_121033   23.27      36.5082    3
 18HU92053_225_121034   13.22      36.5067    3
 18HU92053_225_121035    3.75      36.5085    3
 18HU92053_225_121036    3.69      36.5090    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18HU93039"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18HU93039 FLAG Report:,  2019-03-15 11:48:31
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged SALINITY, event 1, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_002_130501  407.60      34.9546    3
 18HU93039_002_130502  407.23      34.9554    3
 18HU93039_002_130503  407.28      34.9556    3
 18HU93039_002_130504  407.91      34.9562    3
 18HU93039_002_130505  407.93      34.9569    3
 18HU93039_002_130506  408.11      34.9572    3
 18HU93039_002_130507  408.49      34.9575    3
 18HU93039_002_130508  407.19      34.9576    3
 18HU93039_002_130509  405.56      34.9576    3
 18HU93039_002_130510  405.87      34.9577    3
 18HU93039_002_130511  407.91      34.9562    3
 18HU93039_002_130512  408.50      34.9588    3
 18HU93039_002_130513  408.27      34.9589    3
 18HU93039_002_130514  407.30      34.9589    3
 18HU93039_002_130515  407.03      34.9591    3
 18HU93039_002_130516  403.35      34.9589    3
 18HU93039_002_130517  404.42      34.9598    3
 18HU93039_002_130518  403.11      34.9601    3
 18HU93039_002_130519  402.79      34.9611    3
 18HU93039_002_130520  403.23      34.9624    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 1, station CAST#1:

           sample_key  depth O2_Winkler_Molar qc
 18HU93039_002_130519 402.79         184.9817  3
 18HU93039_002_130518 403.11         186.3662  3
 18HU93039_002_130520 403.23         184.4458  3
 18HU93039_002_130516 403.35         183.9545  3
 18HU93039_002_130517 404.42         184.1778  3
 18HU93039_002_130509 405.56         185.5623  3
 18HU93039_002_130510 405.87         185.0710  3
 18HU93039_002_130515 407.03         183.8652  3
 18HU93039_002_130508 407.19         183.9545  3
 18HU93039_002_130502 407.23         185.5623  3
 18HU93039_002_130503 407.28         185.7633  0
 18HU93039_002_130514 407.30         184.3565  3
 18HU93039_002_130501 407.60         185.6963  3
 18HU93039_002_130504 407.91         178.2827  3
 18HU93039_002_130511 407.91         184.4458  3
 18HU93039_002_130505 407.93         181.8555  3
 18HU93039_002_130506 408.11         185.9642  3
 18HU93039_002_130513 408.27         184.5351  3
 18HU93039_002_130507 408.49         185.1157  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 10, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_003_130649 4242.97      34.8970    3
 18HU93039_003_130650 3973.28      34.8997    3
 18HU93039_003_130651 3571.42      34.9098    3
 18HU93039_003_130652 3296.99      34.9178    3
 18HU93039_003_130653 3301.05      34.9181    3
 18HU93039_003_130654 2613.25      34.9656    3
 18HU93039_003_130655 2330.07      34.9634    3
 18HU93039_003_130656 2037.54      34.9706    3
 18HU93039_003_130657 1644.29      34.9537    3
 18HU93039_003_130658 1647.86      34.9542    3
 18HU93039_003_130659 1177.17      35.0119    3
 18HU93039_003_130660 1027.67      35.0080    3
 18HU93039_003_130661  815.84      35.1062    3
 18HU93039_003_130662  707.98      35.2770    3
 18HU93039_003_130663  708.65      35.2762    3
 18HU93039_003_130664  607.73      35.6232    3
 18HU93039_003_130665  213.45      36.5785    3
 18HU93039_003_130666  213.45      36.5785    3
 18HU93039_003_130667   12.36      36.1487    3
 18HU93039_003_130668   12.36      36.1487    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 10, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU93039_003_130668   12.36         221.9606  3
 18HU93039_003_130667   12.36         221.2908  3
 18HU93039_003_130666  213.45         209.6787  3
 18HU93039_003_130665  213.45         209.5898  3
 18HU93039_003_130664  607.73         160.2847  3
 18HU93039_003_130662  707.98         152.5139  3
 18HU93039_003_130663  708.65         151.1741  3
 18HU93039_003_130661  815.84         169.3507  3
 18HU93039_003_130660 1027.67         239.8242  3
 18HU93039_003_130659 1177.17         255.3435  0
 18HU93039_003_130657 1644.29         277.6066  3
 18HU93039_003_130658 1647.86         275.1503  2
 18HU93039_003_130656 2037.54         277.3386  3
 18HU93039_003_130655 2330.07         279.1697  3
 18HU93039_003_130652 3296.99         289.7987  3
 18HU93039_003_130653 3301.05         288.7269  3
 18HU93039_003_130651 3571.42         284.3502  2
 18HU93039_003_130650 3973.28         287.4318  3
 18HU93039_003_130649 4242.97         288.7269  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 11, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_014_130669 5298.43      34.8827    3
 18HU93039_014_130670 4886.89      34.8869    3
 18HU93039_014_130671 4416.08      34.8978    3
 18HU93039_014_130672 3913.69      34.9107    3
 18HU93039_014_130673 3439.23      34.9255    3
 18HU93039_014_130674 2946.13      34.9309    3
 18HU93039_014_130675 2464.42      34.9614    3
 18HU93039_014_130676 1483.39      34.9744    3
 18HU93039_014_130677 1193.25      35.0073    3
 18HU93039_014_130678 1194.47      35.0069    3
 18HU93039_014_130679 1034.50      35.0609    3
 18HU93039_014_130680  885.18      35.1405    3
 18HU93039_014_130681  755.99      35.4341    3
 18HU93039_014_130682  602.17      35.9704    3
 18HU93039_014_130683  446.05      36.3814    3
 18HU93039_014_130684  447.71      36.3817    3
 18HU93039_014_130685  199.40      36.6141    3
 18HU93039_014_130686  123.28      36.6988    3
 18HU93039_014_130687   12.66      36.3862    3
 18HU93039_014_130688   12.66      36.3862    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 11, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU93039_014_130688   12.66         223.7471  3
 18HU93039_014_130687   12.66         225.2208  3
 18HU93039_014_130686  123.28         192.2171  3
 18HU93039_014_130685  199.40         207.3117  3
 18HU93039_014_130683  446.05         186.1875  3
 18HU93039_014_130684  447.71         185.9196  3
 18HU93039_014_130682  602.17         179.0419  3
 18HU93039_014_130681  755.99         147.4673  2
 18HU93039_014_130680  885.18         160.5974  3
 18HU93039_014_130679 1034.50         216.6903  2
 18HU93039_014_130676 1483.39         282.5192  2
 18HU93039_014_130673 3439.23         281.1570  0
 18HU93039_014_130670 4886.89         277.2493  3
 18HU93039_014_130669 5298.43         275.9988  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 11, station CAST#1:

           sample_key   depth    value   method qc
 18HU93039_014_130688   12.66  0.27545 NO2NO3_0  1
 18HU93039_014_130687   12.66  0.32095 NO2NO3_0  1
 18HU93039_014_130686  123.28  3.17554 NO2NO3_0  1
 18HU93039_014_130685  199.40  2.91453 NO2NO3_0  1
 18HU93039_014_130683  446.05  8.37498 NO2NO3_0  1
 18HU93039_014_130684  447.71  8.28296 NO2NO3_0  1
 18HU93039_014_130682  602.17 13.25148 NO2NO3_0  1
 18HU93039_014_130681  755.99 22.68899 NO2NO3_0  7
 18HU93039_014_130680  885.18 25.47205 NO2NO3_0  1
 18HU93039_014_130679 1034.50 21.46300 NO2NO3_0  7
 18HU93039_014_130678 1194.47 19.66954 NO2NO3_0  1
 18HU93039_014_130676 1483.39 18.77248 NO2NO3_0  1
 18HU93039_014_130674 2946.13  4.56196 NO2NO3_0  1
 18HU93039_014_130673 3439.23 18.16650 NO2NO3_0  1
 18HU93039_014_130672 3913.69 18.41354 NO2NO3_0  1
 18HU93039_014_130671 4416.08 18.03952 NO2NO3_0  1
 18HU93039_014_130670 4886.89 20.48847 NO2NO3_0  1
 18HU93039_014_130669 5298.43 20.51447 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 11, station CAST#1:

           sample_key   depth   value method qc
 18HU93039_014_130688   12.66 0.00000  PO4_0  1
 18HU93039_014_130687   12.66 0.00000  PO4_0  1
 18HU93039_014_130686  123.28 0.09749  PO4_0  1
 18HU93039_014_130685  199.40 0.06000  PO4_0  1
 18HU93039_014_130683  446.05 0.40897  PO4_0  1
 18HU93039_014_130684  447.71 0.38154  PO4_0  1
 18HU93039_014_130682  602.17 0.74355  PO4_0  7
 18HU93039_014_130681  755.99 1.40553  PO4_0  1
 18HU93039_014_130680  885.18 1.65353  PO4_0  7
 18HU93039_014_130679 1034.50 1.38297  PO4_0  1
 18HU93039_014_130678 1194.47 1.24000  PO4_0  7
 18HU93039_014_130676 1483.39 1.22304  PO4_0  1
 18HU93039_014_130674 2946.13 0.21903  PO4_0  1
 18HU93039_014_130673 3439.23 1.23551  PO4_0  1
 18HU93039_014_130672 3913.69 1.24801  PO4_0  1
 18HU93039_014_130671 4416.08 1.22605  PO4_0  1
 18HU93039_014_130670 4886.89 1.47399  PO4_0  1
 18HU93039_014_130669 5298.43 1.45747  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 11, station CAST#1:

           sample_key   depth    value method qc
 18HU93039_014_130688   12.66  1.16354 SiO4_0  1
 18HU93039_014_130687   12.66  1.12954 SiO4_0  1
 18HU93039_014_130686  123.28  1.57801 SiO4_0  1
 18HU93039_014_130685  199.40  1.43348 SiO4_0  1
 18HU93039_014_130683  446.05  2.82651 SiO4_0  1
 18HU93039_014_130684  447.71  2.80905 SiO4_0  1
 18HU93039_014_130682  602.17  4.95855 SiO4_0  1
 18HU93039_014_130681  755.99 11.05600 SiO4_0  1
 18HU93039_014_130680  885.18 15.03352 SiO4_0  1
 18HU93039_014_130679 1034.50 13.35601 SiO4_0  7
 18HU93039_014_130678 1194.47 11.14602 SiO4_0  1
 18HU93039_014_130676 1483.39 12.25952 SiO4_0  1
 18HU93039_014_130674 2946.13  2.29755 SiO4_0  1
 18HU93039_014_130673 3439.23 18.98702 SiO4_0  1
 18HU93039_014_130672 3913.69 16.34347 SiO4_0  1
 18HU93039_014_130671 4416.08 17.29555 SiO4_0  1
 18HU93039_014_130670 4886.89 34.94700 SiO4_0  1
 18HU93039_014_130669 5298.43 36.75654 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 12, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_025_130689 5152.20      34.8830    3
 18HU93039_025_130690 4698.94      34.8884    3
 18HU93039_025_130691 4170.16      34.8999    3
 18HU93039_025_130692 3658.85      34.9170    3
 18HU93039_025_130693 3659.21      34.9170    3
 18HU93039_025_130694 2810.20      34.9538    3
 18HU93039_025_130695 2521.72      34.9589    3
 18HU93039_025_130696 2232.38      34.9403    3
 18HU93039_025_130697 1961.16      34.9421    3
 18HU93039_025_130698 1967.49      34.9416    3
 18HU93039_025_130699 1381.36      35.0233    3
 18HU93039_025_130700 1228.39      35.0643    3
 18HU93039_025_130701  990.80      35.0936    3
 18HU93039_025_130702  796.41      35.4213    3
 18HU93039_025_130703  799.97      35.4147    3
 18HU93039_025_130704  612.28      36.0253    3
 18HU93039_025_130705  389.30      36.5050    3
 18HU93039_025_130706  208.60      36.5754    3
 18HU93039_025_130707   84.75      36.4520    3
 18HU93039_025_130708   14.65      36.4533    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 12, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU93039_025_130708   14.65         225.2208  3
 18HU93039_025_130707   84.75         226.2480  3
 18HU93039_025_130706  208.60         210.3491  3
 18HU93039_025_130705  389.30         219.6830  3
 18HU93039_025_130704  612.28         183.1060  3
 18HU93039_025_130702  796.41         156.0867  3
 18HU93039_025_130703  799.97         154.3450  3
 18HU93039_025_130701  990.80         183.1953  3
 18HU93039_025_130700 1228.39         238.3058  3
 18HU93039_025_130699 1381.36         253.4902  2
 18HU93039_025_130697 1961.16         284.8415  3
 18HU93039_025_130696 2232.38         283.0551  3
 18HU93039_025_130695 2521.72         280.1968  3
 18HU93039_025_130693 3659.21         278.8570  2
 18HU93039_025_130690 4698.94         278.0085  3
 18HU93039_025_130689 5152.20         273.2299  4


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 12, station CAST#1:

           sample_key   depth    value   method qc
 18HU93039_025_130708   14.65  0.00000 NO2NO3_0  1
 18HU93039_025_130707   84.75  0.00000 NO2NO3_0  1
 18HU93039_025_130706  208.60  3.13097 NO2NO3_0  1
 18HU93039_025_130705  389.30  4.14900 NO2NO3_0  7
 18HU93039_025_130704  612.28 12.23800 NO2NO3_0  1
 18HU93039_025_130702  796.41 22.02404 NO2NO3_0  1
 18HU93039_025_130703  799.97 22.54950 NO2NO3_0  1
 18HU93039_025_130701  990.80 23.93055 NO2NO3_0  1
 18HU93039_025_130700 1228.39 20.32006 NO2NO3_0  1
 18HU93039_025_130699 1381.36 18.64153 NO2NO3_0  1
 18HU93039_025_130697 1961.16 18.59700 NO2NO3_0  1
 18HU93039_025_130698 1967.49 20.56698 NO2NO3_0  1
 18HU93039_025_130696 2232.38 18.40000 NO2NO3_0  1
 18HU93039_025_130695 2521.72 18.47556 NO2NO3_0  1
 18HU93039_025_130694 2810.20  1.73845 NO2NO3_0  1
 18HU93039_025_130692 3658.85 18.87149 NO2NO3_0  1
 18HU93039_025_130693 3659.21 18.92904 NO2NO3_0  1
 18HU93039_025_130691 4170.16 18.61652 NO2NO3_0  1
 18HU93039_025_130690 4698.94 20.98656 NO2NO3_0  1
 18HU93039_025_130689 5152.20 21.15452 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 12, station CAST#1:

           sample_key   depth    value method qc
 18HU93039_025_130708   14.65  1.08697 SiO4_0  1
 18HU93039_025_130707   84.75  1.08245 SiO4_0  1
 18HU93039_025_130706  208.60  1.51952 SiO4_0  1
 18HU93039_025_130705  389.30  1.83795 SiO4_0  1
 18HU93039_025_130704  612.28  4.69549 SiO4_0  1
 18HU93039_025_130702  796.41 11.01505 SiO4_0  1
 18HU93039_025_130703  799.97 11.38497 SiO4_0  7
 18HU93039_025_130701  990.80 14.29599 SiO4_0  1
 18HU93039_025_130700 1228.39 12.41148 SiO4_0  1
 18HU93039_025_130699 1381.36 11.49253 SiO4_0  1
 18HU93039_025_130697 1961.16 12.72602 SiO4_0  1
 18HU93039_025_130698 1967.49 12.72448 SiO4_0  1
 18HU93039_025_130696 2232.38 13.36906 SiO4_0  1
 18HU93039_025_130695 2521.72 15.46401 SiO4_0  1
 18HU93039_025_130694 2810.20  1.39045 SiO4_0  1
 18HU93039_025_130692 3658.85 18.73155 SiO4_0  1
 18HU93039_025_130693 3659.21 20.70756 SiO4_0  1
 18HU93039_025_130691 4170.16 17.16251 SiO4_0  1
 18HU93039_025_130690 4698.94 34.81449 SiO4_0  1
 18HU93039_025_130689 5152.20 34.80901 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 13, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_036_130709 5300.86      34.8780    3
 18HU93039_036_130710 5007.71      34.8860    3
 18HU93039_036_130711 4723.30      34.8911    3
 18HU93039_036_130712 4424.68      34.8965    3
 18HU93039_036_130713 4127.58      34.9018    3
 18HU93039_036_130714 3827.59      34.9109    3
 18HU93039_036_130715 3536.95      34.9217    3
 18HU93039_036_130716 3246.23      34.9357    3
 18HU93039_036_130717 2953.90      34.9488    3
 18HU93039_036_130718 2649.33      34.9556    3
 18HU93039_036_130719 2060.82      34.9480    3
 18HU93039_036_130720 2062.80      34.9481    3
 18HU93039_036_130721 1766.36      34.9532    3
 18HU93039_036_130722 1470.15      34.9776    3
 18HU93039_036_130723 1169.93      35.0317    3
 18HU93039_036_130724  876.04      35.2983    3
 18HU93039_036_130725  587.73      36.0810    3
 18HU93039_036_130726  290.60      36.5318    3
 18HU93039_036_130727   46.48      36.4318    3
 18HU93039_036_130728   46.48      36.4318    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 13, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU93039_036_130728   46.48         227.9451  3
 18HU93039_036_130727   46.48         226.2480  3
 18HU93039_036_130726  290.60         219.9063  3
 18HU93039_036_130725  587.73         203.6943  3
 18HU93039_036_130724  876.04         163.5003  3
 18HU93039_036_130723 1169.93         230.4009  2
 18HU93039_036_130722 1470.15         265.9503  2
 18HU93039_036_130721 1766.36         280.0182  3
 18HU93039_036_130719 2060.82         271.6221  2
 18HU93039_036_130720 2062.80         281.9832  3
 18HU93039_036_130717 2953.90         280.7328  3
 18HU93039_036_130716 3246.23         280.9114  3
 18HU93039_036_130715 3536.95         285.1541  3
 18HU93039_036_130713 4127.58         277.8299  2
 18HU93039_036_130712 4424.68         279.6609  2
 18HU93039_036_130710 5007.71         277.5172  3
 18HU93039_036_130709 5300.86         272.6493  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 14, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_047_130729 5265.53      34.8782    3
 18HU93039_047_130730 4958.56      34.8866    3
 18HU93039_047_130731 4653.93      34.8921    3
 18HU93039_047_130732 4338.20      34.8970    3
 18HU93039_047_130733 4339.87      34.8969    3
 18HU93039_047_130734 3742.13      34.9147    3
 18HU93039_047_130735 3457.48      34.9277    3
 18HU93039_047_130736 3172.01      34.9418    3
 18HU93039_047_130737 2883.11      34.9540    3
 18HU93039_047_130738 2888.63      34.9541    3
 18HU93039_047_130739 2313.79      34.9695    3
 18HU93039_047_130740 2043.60      34.9681    3
 18HU93039_047_130741 1758.50      34.9809    3
 18HU93039_047_130742 1478.42      35.0410    3
 18HU93039_047_130743 1485.68      35.0404    3
 18HU93039_047_130744  935.44      35.1835    3
 18HU93039_047_130745  591.07      36.1924    3
 18HU93039_047_130746  310.08      36.5327    3
 18HU93039_047_130747    9.99      36.4407    3
 18HU93039_047_130748    9.99      36.4407    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 14, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU93039_047_130748    9.99         225.3995  3
 18HU93039_047_130747    9.99         225.6674  3
 18HU93039_047_130746  310.08         216.6457  3
 18HU93039_047_130745  591.07         209.1428  2
 18HU93039_047_130744  935.44         166.8498  3
 18HU93039_047_130742 1478.42         256.5270  2
 18HU93039_047_130743 1485.68         236.5640  3
 18HU93039_047_130741 1758.50         272.4707  3
 18HU93039_047_130740 2043.60         277.6959  3
 18HU93039_047_130739 2313.79         270.4610  2
 18HU93039_047_130737 2883.11         278.8570  3
 18HU93039_047_130736 3172.01         278.4998  3
 18HU93039_047_130735 3457.48         282.5638  3
 18HU93039_047_130732 4338.20         280.3755  2
 18HU93039_047_130733 4339.87         276.5794  3
 18HU93039_047_130730 4958.56         276.9813  3
 18HU93039_047_130729 5265.53         271.8008  2


-> QC repot:
      Filename        Pressure        Uniqueno Variable        Values
 18HU93039_014         5406.67          130669     pres     5406.67  
 18HU93039_014  12.76 to 12.76  130687, 130688     ntrz  0.32  0.28  
                          Test.failed
  Regional Impossible Parameter Value
       Gradient or Inversion too high



-> Flagged SALINITY, event 15, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_058_130749 5291.48      34.8735    3
 18HU93039_058_130750 5013.88      34.8820    3
 18HU93039_058_130751 4719.23      34.8891    3
 18HU93039_058_130752 4420.80      34.8952    3
 18HU93039_058_130753 4122.87      34.9020    3
 18HU93039_058_130754 3835.22      34.9119    3
 18HU93039_058_130755 3541.72      34.9250    3
 18HU93039_058_130756 3249.39      34.9409    3
 18HU93039_058_130757 2954.65      34.9548    3
 18HU93039_058_130758 2662.39      34.9687    3
 18HU93039_058_130759 2365.78      34.9686    3
 18HU93039_058_130760 2077.05      34.9562    3
 18HU93039_058_130761 1782.59      34.9966    3
 18HU93039_058_130762 1482.22      35.0524    3
 18HU93039_058_130763 1184.68      35.1817    3
 18HU93039_058_130764 1184.70      35.1834    3
 18HU93039_058_130765  602.67      36.2598    3
 18HU93039_058_130766  345.06      36.5307    3
 18HU93039_058_130767   45.95      36.4506    3
 18HU93039_058_130768   45.95      36.4506    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 15, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU93039_058_130768   45.95         227.4538  3
 18HU93039_058_130767   45.95         227.8111  3
 18HU93039_058_130766  345.06         222.8092  3
 18HU93039_058_130765  602.67         214.1898  3
 18HU93039_058_130763 1184.68         206.7311  2
 18HU93039_058_130764 1184.70         204.2302  3
 18HU93039_058_130762 1482.22         252.7309  2
 18HU93039_058_130761 1782.59         271.6668  3
 18HU93039_058_130760 2077.05         279.7949  3
 18HU93039_058_130759 2365.78         263.6726  2
 18HU93039_058_130757 2954.65         277.2493  3
 18HU93039_058_130756 3249.39         279.4823  3
 18HU93039_058_130755 3541.72         280.1522  3
 18HU93039_058_130753 4122.87         279.7949  3
 18HU93039_058_130752 4420.80         279.0803  3
 18HU93039_058_130751 4719.23         271.3988  2
 18HU93039_058_130750 5013.88         274.2124  3
 18HU93039_058_130749 5291.48         271.0415  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 15, station CAST#1:

           sample_key   depth   value method qc
 18HU93039_058_130768   45.95 0.00000  PO4_0  1
 18HU93039_058_130767   45.95 0.00000  PO4_0  1
 18HU93039_058_130766  345.06 0.13055  PO4_0  1
 18HU93039_058_130765  602.67 0.34998  PO4_0  1
 18HU93039_058_130763 1184.68 1.37499  PO4_0  7
 18HU93039_058_130764 1184.70 1.41152  PO4_0  1
 18HU93039_058_130762 1482.22 1.27646  PO4_0  1
 18HU93039_058_130761 1782.59 1.23701  PO4_0  1
 18HU93039_058_130760 2077.05 1.23851  PO4_0  1
 18HU93039_058_130759 2365.78 1.23401  PO4_0  1
 18HU93039_058_130758 2662.39 1.31496  PO4_0  1
 18HU93039_058_130757 2954.65 1.30704  PO4_0  1
 18HU93039_058_130756 3249.39 1.31155  PO4_0  1
 18HU93039_058_130755 3541.72 1.31102  PO4_0  1
 18HU93039_058_130754 3835.22 0.58046  PO4_0  1
 18HU93039_058_130753 4122.87 1.31397  PO4_0  1
 18HU93039_058_130752 4420.80 1.34802  PO4_0  1
 18HU93039_058_130751 4719.23 1.30852  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 15, station CAST#1:

           sample_key   depth    value method qc
 18HU93039_058_130768   45.95  0.80452 SiO4_0  1
 18HU93039_058_130767   45.95  0.79250 SiO4_0  1
 18HU93039_058_130766  345.06  1.45404 SiO4_0  1
 18HU93039_058_130765  602.67  2.50646 SiO4_0  1
 18HU93039_058_130763 1184.68 12.63648 SiO4_0  1
 18HU93039_058_130764 1184.70 12.86747 SiO4_0  7
 18HU93039_058_130762 1482.22 11.87651 SiO4_0  1
 18HU93039_058_130761 1782.59 12.12297 SiO4_0  1
 18HU93039_058_130760 2077.05 12.84701 SiO4_0  1
 18HU93039_058_130759 2365.78 13.65250 SiO4_0  1
 18HU93039_058_130758 2662.39 11.33448 SiO4_0  1
 18HU93039_058_130757 2954.65 20.29254 SiO4_0  1
 18HU93039_058_130756 3249.39 22.26703 SiO4_0  1
 18HU93039_058_130755 3541.72 23.68007 SiO4_0  1
 18HU93039_058_130754 3835.22  4.26499 SiO4_0  1
 18HU93039_058_130753 4122.87 27.75555 SiO4_0  1
 18HU93039_058_130752 4420.80 30.22555 SiO4_0  1
 18HU93039_058_130751 4719.23 30.48557 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 16, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_069_130769 5298.50      34.8776    3
 18HU93039_069_130770 5008.29      34.8869    3
 18HU93039_069_130771 4706.61      34.8908    3
 18HU93039_069_130772 4412.11      34.8959    3
 18HU93039_069_130773 4415.80      34.8958    3
 18HU93039_069_130774 3829.21      34.9111    3
 18HU93039_069_130775 3463.39      34.9274    3
 18HU93039_069_130776 3175.25      34.9437    3
 18HU93039_069_130777 2884.93      34.9589    3
 18HU93039_069_130778 2881.24      34.9599    3
 18HU93039_069_130779 2300.72      34.9650    3
 18HU93039_069_130780 2300.72      34.9650    3
 18HU93039_069_130781 1685.24      35.0138    3
 18HU93039_069_130782 1447.13      35.0423    3
 18HU93039_069_130783 1451.67      35.0428    3
 18HU93039_069_130784  874.87      35.4082    3
 18HU93039_069_130785  692.63      35.9831    3
 18HU93039_069_130786   54.39      36.4778    3
 18HU93039_069_130787   54.39      36.4778    3
 18HU93039_069_130788   54.39      36.4778    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 16, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU93039_069_130788   54.39         224.6849  3
 18HU93039_069_130786   54.39         214.0782  4
 18HU93039_069_130785  692.63         201.7292  3
 18HU93039_069_130784  874.87         168.6362  3
 18HU93039_069_130782 1447.13         251.4805  3
 18HU93039_069_130783 1451.67         250.9892  3
 18HU93039_069_130781 1685.24         267.1115  3
 18HU93039_069_130780 2300.72         279.6609  3
 18HU93039_069_130778 2881.24         274.8823  3
 18HU93039_069_130777 2884.93         276.4454  3
 18HU93039_069_130776 3175.25         277.6512  3
 18HU93039_069_130775 3463.39         281.4027  3
 18HU93039_069_130772 4412.11         272.4707  2
 18HU93039_069_130773 4415.80         275.1503  2
 18HU93039_069_130771 4706.61         276.0435  2
 18HU93039_069_130770 5008.29         277.8745  3
 18HU93039_069_130769 5298.50         270.7736  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 17, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_080_130789 5103.19      34.8821    3
 18HU93039_080_130790 4810.88      34.8877    3
 18HU93039_080_130791 4516.87      34.8930    3
 18HU93039_080_130792 4218.74      34.8996    3
 18HU93039_080_130793 3929.88      34.9073    3
 18HU93039_080_130794 3638.73      34.9190    3
 18HU93039_080_130795 3348.29      34.9325    3
 18HU93039_080_130796 3049.11      34.9454    3
 18HU93039_080_130797 2764.35      34.9569    3
 18HU93039_080_130798 2470.94      34.9477    3
 18HU93039_080_130799 2169.82      34.9409    3
 18HU93039_080_130800 1832.10      34.9534    3
 18HU93039_080_130801 1588.02      34.9789    3
 18HU93039_080_130802 1284.18      35.0350    3
 18HU93039_080_130803 1094.14      35.0796    3
 18HU93039_080_130804 1012.11      34.8380    3
 18HU93039_080_130805  957.29      35.1225    3
 18HU93039_080_130806  654.16      35.9795    3
 18HU93039_080_130807  316.41      36.5455    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 17, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU93039_080_130807  316.41         215.1719  3
 18HU93039_080_130806  654.16         194.0030  3
 18HU93039_080_130805  957.29         169.1274  3
 18HU93039_080_130804 1012.11         205.7486  3
 18HU93039_080_130803 1094.14         209.3214  3
 18HU93039_080_130802 1284.18         243.7543  3
 18HU93039_080_130801 1588.02         272.2920  3
 18HU93039_080_130800 1832.10         279.0803  3
 18HU93039_080_130799 2169.82         265.8163  2
 18HU93039_080_130798 2470.94         232.4553  2
 18HU93039_080_130797 2764.35         278.8570  3
 18HU93039_080_130796 3049.11         282.1619  3
 18HU93039_080_130795 3348.29         287.0298  3
 18HU93039_080_130794 3638.73         195.7448  2
 18HU93039_080_130793 3929.88         280.9114  2
 18HU93039_080_130792 4218.74         281.4473  0
 18HU93039_080_130791 4516.87         278.3658  2
 18HU93039_080_130790 4810.88         277.4279  3
 18HU93039_080_130789 5103.19         274.4804  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 17, station CAST#1:

           sample_key   depth    value   method qc
 18HU93039_080_130807  316.41  3.68002 NO2NO3_0  1
 18HU93039_080_130806  654.16 11.32204 NO2NO3_0  1
 18HU93039_080_130805  957.29 23.73150 NO2NO3_0  1
 18HU93039_080_130804 1012.11 21.05399 NO2NO3_0  7
 18HU93039_080_130803 1094.14 21.05956 NO2NO3_0  1
 18HU93039_080_130802 1284.18 19.70853 NO2NO3_0  7
 18HU93039_080_130801 1588.02 18.59597 NO2NO3_0  1
 18HU93039_080_130800 1832.10 18.22402 NO2NO3_0  1
 18HU93039_080_130799 2169.82 18.03252 NO2NO3_0  1
 18HU93039_080_130798 2470.94 19.26598 NO2NO3_0  1
 18HU93039_080_130797 2764.35 18.43706 NO2NO3_0  1
 18HU93039_080_130796 3049.11 18.38047 NO2NO3_0  1
 18HU93039_080_130795 3348.29 18.25349 NO2NO3_0  1
 18HU93039_080_130794 3638.73 15.11402 NO2NO3_0  1
 18HU93039_080_130793 3929.88 18.62349 NO2NO3_0  1
 18HU93039_080_130792 4218.74 19.12105 NO2NO3_0  1
 18HU93039_080_130791 4516.87 19.01754 NO2NO3_0  1
 18HU93039_080_130790 4810.88 19.82853 NO2NO3_0  1
 18HU93039_080_130789 5103.19 20.42849 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 17, station CAST#1:

           sample_key   depth   value method qc
 18HU93039_080_130807  316.41 0.18653  PO4_0  1
 18HU93039_080_130806  654.16 0.66347  PO4_0  1
 18HU93039_080_130805  957.29 1.56650  PO4_0  1
 18HU93039_080_130804 1012.11 1.44050  PO4_0  1
 18HU93039_080_130803 1094.14 1.40649  PO4_0  7
 18HU93039_080_130802 1284.18 1.32498  PO4_0  1
 18HU93039_080_130801 1588.02 1.24849  PO4_0  1
 18HU93039_080_130800 1832.10 1.18547  PO4_0  1
 18HU93039_080_130799 2169.82 1.18905  PO4_0  1
 18HU93039_080_130798 2470.94 1.27903  PO4_0  1
 18HU93039_080_130797 2764.35 1.22702  PO4_0  1
 18HU93039_080_130796 3049.11 1.22948  PO4_0  1
 18HU93039_080_130795 3348.29 1.24054  PO4_0  1
 18HU93039_080_130794 3638.73 0.93953  PO4_0  1
 18HU93039_080_130793 3929.88 1.25396  PO4_0  1
 18HU93039_080_130792 4218.74 1.26595  PO4_0  1
 18HU93039_080_130791 4516.87 1.31755  PO4_0  1
 18HU93039_080_130790 4810.88 1.37305  PO4_0  1
 18HU93039_080_130789 5103.19 1.36853  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 17, station CAST#1:

           sample_key   depth    value method qc
 18HU93039_080_130807  316.41  1.39150 SiO4_0  1
 18HU93039_080_130806  654.16  4.24696 SiO4_0  1
 18HU93039_080_130805  957.29 14.05599 SiO4_0  1
 18HU93039_080_130804 1012.11 13.25703 SiO4_0  1
 18HU93039_080_130803 1094.14 12.98354 SiO4_0  1
 18HU93039_080_130802 1284.18 12.50499 SiO4_0  7
 18HU93039_080_130801 1588.02 11.86601 SiO4_0  1
 18HU93039_080_130800 1832.10 11.89204 SiO4_0  1
 18HU93039_080_130799 2169.82 11.95554 SiO4_0  1
 18HU93039_080_130798 2470.94 11.75452 SiO4_0  1
 18HU93039_080_130797 2764.35 16.73954 SiO4_0  1
 18HU93039_080_130796 3049.11 18.66855 SiO4_0  1
 18HU93039_080_130795 3348.29 20.59854 SiO4_0  1
 18HU93039_080_130794 3638.73  7.64601 SiO4_0  1
 18HU93039_080_130793 3929.88 24.99455 SiO4_0  1
 18HU93039_080_130792 4218.74 28.51650 SiO4_0  1
 18HU93039_080_130791 4516.87 29.12749 SiO4_0  1
 18HU93039_080_130790 4810.88 34.74953 SiO4_0  1
 18HU93039_080_130789 5103.19 37.65253 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 18, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_091_130809 5163.56      34.8821    3
 18HU93039_091_130810 4924.00      34.8910    3
 18HU93039_091_130811 4623.13      34.8921    3
 18HU93039_091_130812 4329.64      34.8975    3
 18HU93039_091_130813 4038.85      34.9039    3
 18HU93039_091_130814 3737.44      34.9158    3
 18HU93039_091_130815 3449.28      34.9260    3
 18HU93039_091_130816 3145.18      34.9418    3
 18HU93039_091_130817 2850.97      34.9511    3
 18HU93039_091_130818 2851.46      34.9517    3
 18HU93039_091_130819 2269.76      34.9553    3
 18HU93039_091_130820 1975.65      34.9436    3
 18HU93039_091_130821 1688.75      34.9649    3
 18HU93039_091_130822 1386.24      35.0476    3
 18HU93039_091_130823 1386.24      35.0476    3
 18HU93039_091_130824  791.01      35.5198    3
 18HU93039_091_130825  494.31      36.4607    3
 18HU93039_091_130826  198.32      36.6237    3
 18HU93039_091_130827    8.99      36.4220    3
 18HU93039_091_130828    8.99      36.4220    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 18, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU93039_091_130828    8.99         218.2539  3
 18HU93039_091_130827    8.99         218.6558  3
 18HU93039_091_130826  198.32         211.3762  3
 18HU93039_091_130825  494.31         204.9898  3
 18HU93039_091_130824  791.01         169.5740  3
 18HU93039_091_130823 1386.24         212.3583  3
 18HU93039_091_130822 1386.24         252.3737  3
 18HU93039_091_130821 1688.75         277.6959  3
 18HU93039_091_130820 1975.65         284.1716  3
 18HU93039_091_130819 2269.76         270.0144  2
 18HU93039_091_130817 2850.97         279.8842  3
 18HU93039_091_130818 2851.46         244.3795  2
 18HU93039_091_130816 3145.18         281.0900  3
 18HU93039_091_130815 3449.28         279.7949  3
 18HU93039_091_130814 3737.44         199.2283  2
 18HU93039_091_130813 4038.85         279.8842  4
 18HU93039_091_130812 4329.64         277.9638  2
 18HU93039_091_130811 4623.13         280.2862  3
 18HU93039_091_130810 4924.00         282.1619  3
 18HU93039_091_130809 5163.56         274.7037  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 18, station CAST#1:

           sample_key   depth    value   method qc
 18HU93039_091_130828    8.99  0.66647 NO2NO3_0  1
 18HU93039_091_130827    8.99  0.64746 NO2NO3_0  1
 18HU93039_091_130826  198.32  1.83452 NO2NO3_0  1
 18HU93039_091_130825  494.31  5.64453 NO2NO3_0  7
 18HU93039_091_130824  791.01 18.56299 NO2NO3_0  7
 18HU93039_091_130823 1386.24 21.08747 NO2NO3_0  1
 18HU93039_091_130822 1386.24 18.92557 NO2NO3_0  1
 18HU93039_091_130821 1688.75 18.35099 NO2NO3_0  1
 18HU93039_091_130820 1975.65 18.27303 NO2NO3_0  1
 18HU93039_091_130819 2269.76 18.06800 NO2NO3_0  1
 18HU93039_091_130817 2850.97 18.20901 NO2NO3_0  1
 18HU93039_091_130818 2851.46 18.79750 NO2NO3_0  1
 18HU93039_091_130816 3145.18 18.60756 NO2NO3_0  1
 18HU93039_091_130815 3449.28 18.39846 NO2NO3_0  1
 18HU93039_091_130814 3737.44 12.35203 NO2NO3_0  1
 18HU93039_091_130813 4038.85 18.49603 NO2NO3_0  1
 18HU93039_091_130812 4329.64 18.61905 NO2NO3_0  1
 18HU93039_091_130811 4623.13 19.55151 NO2NO3_0  1
 18HU93039_091_130810 4924.00 19.22403 NO2NO3_0  1
 18HU93039_091_130809 5163.56 20.46798 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 18, station CAST#1:

           sample_key   depth   value method qc
 18HU93039_091_130828    8.99 0.04000  PO4_0  1
 18HU93039_091_130827    8.99 0.04400  PO4_0  1
 18HU93039_091_130826  198.32 0.09101  PO4_0  1
 18HU93039_091_130825  494.31 0.28502  PO4_0  1
 18HU93039_091_130824  791.01 1.17797  PO4_0  7
 18HU93039_091_130823 1386.24 1.40502  PO4_0  1
 18HU93039_091_130822 1386.24 1.24599  PO4_0  1
 18HU93039_091_130821 1688.75 1.21800  PO4_0  1
 18HU93039_091_130820 1975.65 1.20649  PO4_0  1
 18HU93039_091_130819 2269.76 1.20096  PO4_0  1
 18HU93039_091_130817 2850.97 1.21645  PO4_0  1
 18HU93039_091_130818 2851.46 1.23697  PO4_0  1
 18HU93039_091_130816 3145.18 1.24753  PO4_0  1
 18HU93039_091_130815 3449.28 1.25449  PO4_0  1
 18HU93039_091_130814 3737.44 0.77302  PO4_0  1
 18HU93039_091_130813 4038.85 1.26996  PO4_0  1
 18HU93039_091_130812 4329.64 1.27201  PO4_0  1
 18HU93039_091_130811 4623.13 1.32699  PO4_0  1
 18HU93039_091_130810 4924.00 1.28852  PO4_0  1
 18HU93039_091_130809 5163.56 1.38053  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 18, station CAST#1:

           sample_key   depth    value method qc
 18HU93039_091_130828    8.99  1.10400 SiO4_0  1
 18HU93039_091_130827    8.99  1.10646 SiO4_0  1
 18HU93039_091_130826  198.32  1.00750 SiO4_0  1
 18HU93039_091_130825  494.31  2.02801 SiO4_0  7
 18HU93039_091_130824  791.01  8.77601 SiO4_0  1
 18HU93039_091_130823 1386.24 13.31052 SiO4_0  1
 18HU93039_091_130822 1386.24 11.81399 SiO4_0  1
 18HU93039_091_130821 1688.75 11.65002 SiO4_0  1
 18HU93039_091_130820 1975.65 12.23000 SiO4_0  1
 18HU93039_091_130819 2269.76 12.71497 SiO4_0  1
 18HU93039_091_130817 2850.97 17.16502 SiO4_0  1
 18HU93039_091_130818 2851.46 11.75702 SiO4_0  1
 18HU93039_091_130816 3145.18 19.58055 SiO4_0  1
 18HU93039_091_130815 3449.28 21.89304 SiO4_0  1
 18HU93039_091_130814 3737.44  6.70503 SiO4_0  1
 18HU93039_091_130813 4038.85 25.70256 SiO4_0  1
 18HU93039_091_130812 4329.64 25.36502 SiO4_0  1
 18HU93039_091_130811 4623.13 31.16847 SiO4_0  1
 18HU93039_091_130810 4924.00 29.60202 SiO4_0  1
 18HU93039_091_130809 5163.56 37.26198 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 2, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_113_130521   74.64      33.0861    3
 18HU93039_113_130522   56.45      33.0561    3
 18HU93039_113_130523   41.73      32.8978    3
 18HU93039_113_130524    5.99      32.6421    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 2, station CAST#1:

           sample_key depth O2_Winkler_Molar qc
 18HU93039_113_130524  5.99         343.5694  3
 18HU93039_113_130523 41.73         331.1092  3
 18HU93039_113_130522 56.45         326.3530  0
 18HU93039_113_130521 74.64         326.6432  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 3, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_225_130525 1151.64      34.8665    3
 18HU93039_225_130526 1107.18      34.8632    3
 18HU93039_225_130527  942.77      34.8628    3
 18HU93039_225_130528  755.15      34.8500    3
 18HU93039_225_130529  570.74      34.7695    3
 18HU93039_225_130530  390.81      34.6242    3
 18HU93039_225_130531  203.83      33.7270    3
 18HU93039_225_130532  203.83      33.7270    3
 18HU93039_225_130533   55.43      33.2925    3
 18HU93039_225_130534   15.61      32.7499    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 3, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU93039_225_130534   15.61         340.1306  3
 18HU93039_225_130533   55.43         327.3578  3
 18HU93039_225_130532  203.83         319.7209  3
 18HU93039_225_130531  203.83         319.7656  3
 18HU93039_225_130530  390.81         290.3793  3
 18HU93039_225_130529  570.74         294.0861  3
 18HU93039_225_130528  755.15         294.5327  3
 18HU93039_225_130527  942.77         297.0783  3
 18HU93039_225_130526 1107.18         299.6686  3
 18HU93039_225_130525 1151.64         299.8919  0


-> QC repot:
      Filename          Pressure        Uniqueno Variable        Values
 18HU93039_003    12.46 to 12.46  130667, 130668     ntrz  0.64  0.66  
 18HU93039_003  215.22 to 215.22  130665, 130666     ntrz  3.43  3.34  
 18HU93039_003  215.22 to 215.22  130665, 130666     phos  0.20  0.21  
                     Test.failed
  Gradient or Inversion too high
  Gradient or Inversion too high
  Gradient or Inversion too high



-> Flagged NITRATE, event 3, station CAST#1:

           sample_key   depth    value   method qc
 18HU93039_225_130534   15.61  3.22103 NO2NO3_0  1
 18HU93039_225_130533   55.43  8.53949 NO2NO3_0  1
 18HU93039_225_130532  203.83 11.92946 NO2NO3_0  1
 18HU93039_225_130531  203.83 12.05800 NO2NO3_0  1
 18HU93039_225_130530  390.81 16.54006 NO2NO3_0  1
 18HU93039_225_130529  570.74 16.85453 NO2NO3_0  1
 18HU93039_225_130528  755.15 17.20003 NO2NO3_0  1
 18HU93039_225_130527  942.77 17.29304 NO2NO3_0  7
 18HU93039_225_130526 1107.18 17.41953 NO2NO3_0  1
 18HU93039_225_130525 1151.64 17.26898 NO2NO3_0  7


-> QC repot:
      Filename          Pressure        Uniqueno Variable        Values
 18HU93039_003    12.46 to 12.46  130667, 130668     ntrz  0.64  0.66  
 18HU93039_003  215.22 to 215.22  130665, 130666     ntrz  3.43  3.34  
                     Test.failed
  Gradient or Inversion too high
  Gradient or Inversion too high



-> Flagged PHOSPHATE, event 3, station CAST#1:

           sample_key   depth   value method qc
 18HU93039_225_130534   15.61 0.64804  PO4_0  1
 18HU93039_225_130533   55.43 0.99802  PO4_0  1
 18HU93039_225_130532  203.83 1.05451  PO4_0  1
 18HU93039_225_130531  203.83 1.05502  PO4_0  1
 18HU93039_225_130530  390.81 1.14046  PO4_0  1
 18HU93039_225_130529  570.74 1.10396  PO4_0  1
 18HU93039_225_130528  755.15 1.14250  PO4_0  1
 18HU93039_225_130527  942.77 1.12250  PO4_0  1
 18HU93039_225_130526 1107.18 1.14446  PO4_0  7
 18HU93039_225_130525 1151.64 1.14549  PO4_0  1


-> QC repot:
      Filename          Pressure        Uniqueno Variable        Values
 18HU93039_003  215.22 to 215.22  130665, 130666     phos  0.20  0.21  
                     Test.failed
  Gradient or Inversion too high



-> Flagged SILICATE, event 3, station CAST#1:

           sample_key   depth    value method qc
 18HU93039_225_130534   15.61  4.64646 SiO4_0  1
 18HU93039_225_130533   55.43  9.17355 SiO4_0  1
 18HU93039_225_130532  203.83 10.61204 SiO4_0  1
 18HU93039_225_130531  203.83 10.36502 SiO4_0  1
 18HU93039_225_130530  390.81 11.72304 SiO4_0  1
 18HU93039_225_130529  570.74 10.88902 SiO4_0  1
 18HU93039_225_130528  755.15 10.55648 SiO4_0  1
 18HU93039_225_130527  942.77 10.10099 SiO4_0  1
 18HU93039_225_130526 1107.18 10.18850 SiO4_0  1
 18HU93039_225_130525 1151.64 10.23849 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 39, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_263_131229 2738.54      34.9193    3
 18HU93039_263_131230 2622.56      34.9218    3
 18HU93039_263_131231 2419.31      34.9248    3
 18HU93039_263_131232 2167.48      34.9050    3
 18HU93039_263_131233 1970.35      34.8953    3
 18HU93039_263_131234 1772.63      34.8740    3
 18HU93039_263_131235 1575.00      34.8556    3
 18HU93039_263_131236 1382.58      34.8660    3
 18HU93039_263_131237 1179.34      34.8915    3
 18HU93039_263_131238 1088.20      34.8900    3
 18HU93039_263_131239  890.86      34.9220    3
 18HU93039_263_131240  789.86      34.9284    3
 18HU93039_263_131241  693.67      34.9660    3
 18HU93039_263_131242  620.47      35.0012    3
 18HU93039_263_131243  621.09      35.0051    3
 18HU93039_263_131244  364.22      34.8281    3
 18HU93039_263_131245  257.89      34.8214    3
 18HU93039_263_131246  172.20      34.5379    3
 18HU93039_263_131247  137.86      34.7606    3
 18HU93039_263_131248   94.98      33.7815    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 39, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU93039_263_131248   94.98         321.3734  3
 18HU93039_263_131247  137.86         207.7137  3
 18HU93039_263_131246  172.20         244.2902  3
 18HU93039_263_131245  257.89         252.7756  3
 18HU93039_263_131244  364.22         279.6163  3
 18HU93039_263_131242  620.47         267.1115  3
 18HU93039_263_131243  621.09         266.7095  3
 18HU93039_263_131241  693.67         275.5075  3
 18HU93039_263_131240  789.86         285.6900  3
 18HU93039_263_131239  890.86         289.2628  3
 18HU93039_263_131238 1088.20         298.2395  3
 18HU93039_263_131237 1179.34         296.7210  3
 18HU93039_263_131236 1382.58         304.9831  3
 18HU93039_263_131235 1575.00         309.8957  3
 18HU93039_263_131234 1772.63         304.5812  0
 18HU93039_263_131233 1970.35         297.8822  3
 18HU93039_263_131232 2167.48         295.2919  0
 18HU93039_263_131231 2419.31         292.2550  3
 18HU93039_263_131230 2622.56         293.8181  3
 18HU93039_263_131229 2738.54         292.1657  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 4, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_264_130535 2224.86      34.9086    3
 18HU93039_264_130536 1890.05      34.8751    3
 18HU93039_264_130537 1596.51      34.8598    3
 18HU93039_264_130538 1308.31      34.8736    3
 18HU93039_264_130539 1003.71      34.8644    3
 18HU93039_264_130540  803.10      34.9692    3
 18HU93039_264_130541  595.68      35.0047    3
 18HU93039_264_130542  315.72      34.9245    3
 18HU93039_264_130543  250.32      34.5873    3
 18HU93039_264_130544  155.07      34.0988    3
 18HU93039_264_130545  104.20      33.9048    3
 18HU93039_264_130546   57.12      33.1533    3
 18HU93039_264_130547    8.46      32.8784    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 4, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU93039_264_130547    8.46         328.6529  3
 18HU93039_264_130546   57.12         330.1267  3
 18HU93039_264_130545  104.20         321.5520  3
 18HU93039_264_130544  155.07         308.2880  3
 18HU93039_264_130543  250.32         275.1949  3
 18HU93039_264_130542  315.72         238.0378  3
 18HU93039_264_130541  595.68         257.5542  3
 18HU93039_264_130540  803.10         272.1134  3
 18HU93039_264_130539 1003.71         299.9366  3
 18HU93039_264_130538 1308.31         300.1152  0
 18HU93039_264_130537 1596.51         305.5191  3
 18HU93039_264_130536 1890.05         300.8744  3
 18HU93039_264_130535 2224.86         292.0764  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 4, station CAST#1:

           sample_key   depth    value   method qc
 18HU93039_264_130547    8.46  0.00000 NO2NO3_0  1
 18HU93039_264_130546   57.12  1.13049 NO2NO3_0  1
 18HU93039_264_130545  104.20 10.66154 NO2NO3_0  7
 18HU93039_264_130544  155.07 13.34502 NO2NO3_0  1
 18HU93039_264_130543  250.32 16.98699 NO2NO3_0  1
 18HU93039_264_130542  315.72 19.92347 NO2NO3_0  1
 18HU93039_264_130541  595.68 19.14605 NO2NO3_0  1
 18HU93039_264_130540  803.10 18.61800 NO2NO3_0  1
 18HU93039_264_130539 1003.71 17.19806 NO2NO3_0  1
 18HU93039_264_130538 1308.31 17.09847 NO2NO3_0  1
 18HU93039_264_130537 1596.51 16.94503 NO2NO3_0  1
 18HU93039_264_130536 1890.05 17.42697 NO2NO3_0  1
 18HU93039_264_130535 2224.86 17.33149 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 4, station CAST#1:

           sample_key   depth    value method qc
 18HU93039_264_130547    8.46  1.63249 SiO4_0  1
 18HU93039_264_130546   57.12  1.88701 SiO4_0  1
 18HU93039_264_130545  104.20  6.89747 SiO4_0  1
 18HU93039_264_130544  155.07  9.89701 SiO4_0  1
 18HU93039_264_130543  250.32 11.32651 SiO4_0  7
 18HU93039_264_130542  315.72 13.09898 SiO4_0  1
 18HU93039_264_130541  595.68 12.25806 SiO4_0  1
 18HU93039_264_130540  803.10 11.90747 SiO4_0  1
 18HU93039_264_130539 1003.71 10.18400 SiO4_0  1
 18HU93039_264_130538 1308.31 10.54548 SiO4_0  1
 18HU93039_264_130537 1596.51 10.72952 SiO4_0  1
 18HU93039_264_130536 1890.05 11.19149 SiO4_0  1
 18HU93039_264_130535 2224.86 13.14396 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 40, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_265_131249 1939.81      34.8788    3
 18HU93039_265_131250 1884.64      34.8760    3
 18HU93039_265_131251 1682.59      34.8614    3
 18HU93039_265_131252 1475.60      34.8627    3
 18HU93039_265_131253 1279.42      34.8744    3
 18HU93039_265_131254 1081.73      34.8580    3
 18HU93039_265_131255  885.92      34.8604    3
 18HU93039_265_131256  744.42      34.8663    3
 18HU93039_265_131257  592.94      34.8823    3
 18HU93039_265_131258  447.15      34.8749    3
 18HU93039_265_131259  298.08      34.8196    3
 18HU93039_265_131260  203.21      34.6586    3
 18HU93039_265_131261  100.73      34.0134    3
 18HU93039_265_131262   50.98      33.1525    3
 18HU93039_265_131263    4.44      33.1406    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 40, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU93039_265_131263    4.44         319.8549  0
 18HU93039_265_131262   50.98         319.7209  3
 18HU93039_265_131261  100.73         314.1831  3
 18HU93039_265_131260  203.21         289.2628  3
 18HU93039_265_131259  298.08         296.2744  3
 18HU93039_265_131258  447.15         295.1579  3
 18HU93039_265_131257  592.94         300.6511  3
 18HU93039_265_131256  744.42         307.3501  3
 18HU93039_265_131255  885.92         305.0725  3
 18HU93039_265_131254 1081.73         308.2433  3
 18HU93039_265_131253 1279.42         303.8220  3
 18HU93039_265_131252 1475.60         309.0025  3
 18HU93039_265_131251 1682.59         308.4220  3
 18HU93039_265_131250 1884.64         305.1395  0
 18HU93039_265_131249 1939.81         304.0899  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 40, station CAST#1:

           sample_key   depth    value   method qc
 18HU93039_265_131263    4.44  1.34450 NO2NO3_0  1
 18HU93039_265_131262   50.98  1.52904 NO2NO3_0  1
 18HU93039_265_131261  100.73 12.84304 NO2NO3_0  1
 18HU93039_265_131260  203.21 17.22300 NO2NO3_0  7
 18HU93039_265_131259  298.08 17.52350 NO2NO3_0  1
 18HU93039_265_131258  447.15 18.01747 NO2NO3_0  7
 18HU93039_265_131257  592.94 17.63748 NO2NO3_0  1
 18HU93039_265_131256  744.42 17.62649 NO2NO3_0  1
 18HU93039_265_131255  885.92 17.42299 NO2NO3_0  1
 18HU93039_265_131254 1081.73 17.22301 NO2NO3_0  1
 18HU93039_265_131253 1279.42 17.49601 NO2NO3_0  1
 18HU93039_265_131252 1475.60 17.29601 NO2NO3_0  7
 18HU93039_265_131251 1682.59 17.13401 NO2NO3_0  1
 18HU93039_265_131250 1884.64 17.15656 NO2NO3_0  1
 18HU93039_265_131249 1939.81 17.45154 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 40, station CAST#1:

           sample_key   depth   value method qc
 18HU93039_265_131263    4.44 0.33953  PO4_0  1
 18HU93039_265_131262   50.98 0.31402  PO4_0  1
 18HU93039_265_131261  100.73 1.00799  PO4_0  1
 18HU93039_265_131260  203.21 1.20398  PO4_0  1
 18HU93039_265_131259  298.08 1.17899  PO4_0  7
 18HU93039_265_131258  447.15 1.24900  PO4_0  1
 18HU93039_265_131257  592.94 1.20305  PO4_0  1
 18HU93039_265_131256  744.42 1.20252  PO4_0  1
 18HU93039_265_131255  885.92 1.19452  PO4_0  1
 18HU93039_265_131254 1081.73 1.18149  PO4_0  1
 18HU93039_265_131253 1279.42 1.20253  PO4_0  7
 18HU93039_265_131252 1475.60 1.19154  PO4_0  1
 18HU93039_265_131251 1682.59 1.18252  PO4_0  7
 18HU93039_265_131250 1884.64 1.24254  PO4_0  1
 18HU93039_265_131249 1939.81 1.22746  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 40, station CAST#1:

           sample_key   depth    value method qc
 18HU93039_265_131263    4.44  1.47646 SiO4_0  1
 18HU93039_265_131262   50.98  1.61049 SiO4_0  1
 18HU93039_265_131261  100.73  7.05653 SiO4_0  1
 18HU93039_265_131260  203.21  9.90599 SiO4_0  1
 18HU93039_265_131259  298.08  9.69105 SiO4_0  1
 18HU93039_265_131258  447.15 10.17146 SiO4_0  7
 18HU93039_265_131257  592.94 10.31196 SiO4_0  1
 18HU93039_265_131256  744.42 10.44900 SiO4_0  1
 18HU93039_265_131255  885.92 10.47347 SiO4_0  1
 18HU93039_265_131254 1081.73 10.73002 SiO4_0  1
 18HU93039_265_131253 1279.42 11.29448 SiO4_0  1
 18HU93039_265_131252 1475.60 11.13148 SiO4_0  7
 18HU93039_265_131251 1682.59 11.17147 SiO4_0  1
 18HU93039_265_131250 1884.64 11.54102 SiO4_0  1
 18HU93039_265_131249 1939.81 11.54053 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 41, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_275_131264 1172.33      34.8585    3
 18HU93039_275_131265 1088.16      34.8625    3
 18HU93039_275_131266  890.10      34.8665    3
 18HU93039_275_131267  695.70      34.8702    3
 18HU93039_275_131268  498.81      34.8748    3
 18HU93039_275_131269  396.64      34.8511    3
 18HU93039_275_131270  300.20      34.7766    3
 18HU93039_275_131271  200.29      34.5501    3
 18HU93039_275_131272  100.48      33.6784    3
 18HU93039_275_131273   50.63      33.1203    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 41, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU93039_275_131273   50.63         341.3810  3
 18HU93039_275_131272  100.48         329.3675  3
 18HU93039_275_131271  200.29         301.2764  3
 18HU93039_275_131270  300.20         299.2220  3
 18HU93039_275_131269  396.64         300.8298  0
 18HU93039_275_131268  498.81         303.8220  3
 18HU93039_275_131267  695.70         306.2336  3
 18HU93039_275_131266  890.10         306.0550  3
 18HU93039_275_131265 1088.16         308.0200  3
 18HU93039_275_131264 1172.33         306.5462  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 42, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_276_131274  857.76      34.8654    3
 18HU93039_276_131275  792.43      34.8622    3
 18HU93039_276_131276  629.93      34.8460    3
 18HU93039_276_131277  498.01      34.8087    3
 18HU93039_276_131278  400.02      34.6845    3
 18HU93039_276_131279  284.52      34.1058    3
 18HU93039_276_131280  202.20      33.8682    3
 18HU93039_276_131281  130.58      33.7310    3
 18HU93039_276_131282   81.60      33.6230    3
 18HU93039_276_131283   32.43      32.9866    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 42, station CAST#1:

           sample_key  depth O2_Winkler_Molar qc
 18HU93039_276_131283  32.43         354.3771  3
 18HU93039_276_131282  81.60         323.1598  3
 18HU93039_276_131281 130.58         320.5695  3
 18HU93039_276_131280 202.20         316.1035  3
 18HU93039_276_131279 284.52         306.9705  0
 18HU93039_276_131278 400.02         294.3987  3
 18HU93039_276_131277 498.01         295.6492  3
 18HU93039_276_131276 629.93         298.2841  3
 18HU93039_276_131275 792.43         302.3035  3
 18HU93039_276_131274 857.76         303.5987  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 42, station CAST#1:

           sample_key  depth    value   method qc
 18HU93039_276_131283  32.43  2.82402 NO2NO3_0  1
 18HU93039_276_131282  81.60 11.24502 NO2NO3_0  1
 18HU93039_276_131281 130.58 12.03005 NO2NO3_0  1
 18HU93039_276_131280 202.20 12.72549 NO2NO3_0  1
 18HU93039_276_131279 284.52 13.97605 NO2NO3_0  2
 18HU93039_276_131278 400.02 16.25853 NO2NO3_0  2
 18HU93039_276_131277 498.01 17.16749 NO2NO3_0  1
 18HU93039_276_131276 629.93 17.14305 NO2NO3_0  7
 18HU93039_276_131275 792.43 17.08098 NO2NO3_0  1
 18HU93039_276_131274 857.76 15.24349 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 42, station CAST#1:

           sample_key  depth   value method qc
 18HU93039_276_131283  32.43 0.47554  PO4_0  1
 18HU93039_276_131282  81.60 1.11551  PO4_0  1
 18HU93039_276_131281 130.58 1.07850  PO4_0  1
 18HU93039_276_131280 202.20 1.08199  PO4_0  1
 18HU93039_276_131279 284.52 1.10700  PO4_0  1
 18HU93039_276_131278 400.02 1.14051  PO4_0  1
 18HU93039_276_131277 498.01 1.14503  PO4_0  1
 18HU93039_276_131276 629.93 1.14095  PO4_0  1
 18HU93039_276_131275 792.43 1.15502  PO4_0  7
 18HU93039_276_131274 857.76 1.15800  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 42, station CAST#1:

           sample_key  depth    value method qc
 18HU93039_276_131283  32.43  2.27196 SiO4_0  1
 18HU93039_276_131282  81.60 10.83403 SiO4_0  1
 18HU93039_276_131281 130.58 11.25054 SiO4_0  1
 18HU93039_276_131280 202.20 11.19256 SiO4_0  1
 18HU93039_276_131279 284.52 11.63451 SiO4_0  1
 18HU93039_276_131278 400.02 10.98105 SiO4_0  2
 18HU93039_276_131277 498.01 10.84154 SiO4_0  1
 18HU93039_276_131276 629.93 10.44853 SiO4_0  1
 18HU93039_276_131275 792.43 10.33150 SiO4_0  1
 18HU93039_276_131274 857.76 10.26649 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 43, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_277_131284  454.05      34.3108    3
 18HU93039_277_131285  422.66      34.2632    3
 18HU93039_277_131286  374.39      33.9610    3
 18HU93039_277_131287  296.48      33.7878    3
 18HU93039_277_131288  145.39      33.5828    3
 18HU93039_277_131289   44.16      32.8479    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 43, station CAST#1:

           sample_key  depth O2_Winkler_Molar qc
 18HU93039_277_131289  44.16         358.1732  3
 18HU93039_277_131288 145.39         324.0083  3
 18HU93039_277_131287 296.48         319.2297  3
 18HU93039_277_131286 374.39         311.0569  3
 18HU93039_277_131285 422.66         301.9463  3
 18HU93039_277_131284 454.05         301.1200  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 44, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_278_131290  195.43      33.2212    3
 18HU93039_278_131291  146.15      33.1187    3
 18HU93039_278_131292   95.81      32.9496    3
 18HU93039_278_131293   43.48      32.7850    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 44, station CAST#1:

           sample_key  depth O2_Winkler_Molar qc
 18HU93039_278_131293  43.48         346.6956  3
 18HU93039_278_131292  95.81         334.5481  3
 18HU93039_278_131291 146.15         333.3199  0
 18HU93039_278_131290 195.43         329.1889  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 45, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_279_131294  142.53      33.4375    3
 18HU93039_279_131295   99.71      33.4383    3
 18HU93039_279_131296   59.53      33.4271    3
 18HU93039_279_131297    9.36      32.8403    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 45, station CAST#1:

           sample_key  depth O2_Winkler_Molar qc
 18HU93039_279_131297   9.36         361.7013  0
 18HU93039_279_131296  59.53         327.3355  0
 18HU93039_279_131295  99.71         325.8394  3
 18HU93039_279_131294 142.53         323.2044  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 46, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_280_131298  432.74      34.5564    3
 18HU93039_280_131299  338.89      34.4571    3
 18HU93039_280_131300  213.57      34.1416    3
 18HU93039_280_131301   98.43      33.6467    3
 18HU93039_280_131302    7.77      32.6945    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 46, station CAST#1:

           sample_key  depth O2_Winkler_Molar qc
 18HU93039_280_131302   7.77         361.9693  3
 18HU93039_280_131301  98.43         325.9733  3
 18HU93039_280_131300 213.57         306.4569  3
 18HU93039_280_131299 338.89         294.6443  0
 18HU93039_280_131298 432.74         291.0046  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 5, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_284_130549 2753.17      34.9217    3
 18HU93039_284_130550 2504.70      34.9356    3
 18HU93039_284_130551 2254.05      34.9561    3
 18HU93039_284_130552 2003.21      34.9668    3
 18HU93039_284_130553 2001.70      34.9668    3
 18HU93039_284_130554 1477.93      34.9603    3
 18HU93039_284_130555 1164.81      34.9553    3
 18HU93039_284_130556  961.75      34.9756    3
 18HU93039_284_130557  763.19      34.9920    3
 18HU93039_284_130558  763.90      34.9918    3
 18HU93039_284_130559  571.68      35.0179    3
 18HU93039_284_130560  474.28      35.0264    3
 18HU93039_284_130561  394.66      35.0342    3
 18HU93039_284_130562  346.12      34.8004    3
 18HU93039_284_130563  347.69      34.8132    3
 18HU93039_284_130564  251.34      35.0084    3
 18HU93039_284_130565  179.69      34.5081    3
 18HU93039_284_130566  121.57      34.4725    3
 18HU93039_284_130567    6.26      32.7436    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 5, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU93039_284_130567    6.26         301.9016  3
 18HU93039_284_130566  121.57         237.9931  3
 18HU93039_284_130565  179.69         237.1446  3
 18HU93039_284_130564  251.34         189.8943  3
 18HU93039_284_130562  346.12         246.5679  2
 18HU93039_284_130563  347.69         242.9504  3
 18HU93039_284_130561  394.66         226.2922  3
 18HU93039_284_130560  474.28         240.3155  3
 18HU93039_284_130559  571.68         250.4979  3
 18HU93039_284_130557  763.19         265.6823  0
 18HU93039_284_130558  763.90         264.1192  3
 18HU93039_284_130556  961.75         272.9619  3
 18HU93039_284_130555 1164.81         279.1697  3
 18HU93039_284_130554 1477.93         280.2415  3
 18HU93039_284_130553 2001.70         277.9192  3
 18HU93039_284_130552 2003.21         277.1600  3
 18HU93039_284_130551 2254.05         278.5444  2
 18HU93039_284_130550 2504.70         283.3677  3
 18HU93039_284_130549 2753.17         289.0395  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 6, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_304_130569 3459.69      34.8960    3
 18HU93039_304_130570 3154.56      34.9119    3
 18HU93039_304_130571 2835.72      34.9248    3
 18HU93039_304_130572 2541.41      34.9462    3
 18HU93039_304_130573 2499.28      34.9476    3
 18HU93039_304_130574 1938.06      34.9657    3
 18HU93039_304_130575 1628.73      34.9014    3
 18HU93039_304_130576 1355.07      34.9028    3
 18HU93039_304_130577 1082.03      34.9484    3
 18HU93039_304_130578  943.76      34.9549    3
 18HU93039_304_130579  797.15      34.9197    3
 18HU93039_304_130580  705.17      34.9482    3
 18HU93039_304_130581  609.28      35.0190    3
 18HU93039_304_130582  559.73      34.7844    3
 18HU93039_304_130583  406.73      34.9937    3
 18HU93039_304_130584  405.83      35.0002    3
 18HU93039_304_130585  108.47      35.4405    3
 18HU93039_304_130586   58.20      34.0508    3
 18HU93039_304_130587   10.04      32.6317    3
 18HU93039_304_130588   10.04      32.6317    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 6, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU93039_304_130588   10.04         298.9094  3
 18HU93039_304_130587   10.04         299.3560  3
 18HU93039_304_130586   58.20         254.0261  2
 18HU93039_304_130585  108.47         186.5448  3
 18HU93039_304_130584  405.83         206.2845  2
 18HU93039_304_130583  406.73         209.9913  2
 18HU93039_304_130582  559.73         274.5697  3
 18HU93039_304_130581  609.28         244.7368  3
 18HU93039_304_130580  705.17         271.1755  3
 18HU93039_304_130579  797.15         280.7328  3
 18HU93039_304_130578  943.76         278.0532  3
 18HU93039_304_130577 1082.03         279.7949  3
 18HU93039_304_130576 1355.07         292.6123  3
 18HU93039_304_130575 1628.73         293.0589  3
 18HU93039_304_130574 1938.06         277.3386  0
 18HU93039_304_130573 2499.28         279.9735  3
 18HU93039_304_130572 2541.41         281.3580  3
 18HU93039_304_130571 2835.72         287.4764  3
 18HU93039_304_130570 3154.56         291.0492  3
 18HU93039_304_130569 3459.69         287.9677  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 7, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_315_130589 3795.39      34.9019    3
 18HU93039_315_130590 3296.61      34.9157    3
 18HU93039_315_130591 3062.39      34.9246    3
 18HU93039_315_130592 2553.82      34.9538    3
 18HU93039_315_130593 2557.75      34.9536    3
 18HU93039_315_130594 2276.88      34.9607    3
 18HU93039_315_130595 2017.90      34.9607    3
 18HU93039_315_130596 1476.96      34.9401    3
 18HU93039_315_130597 1192.46      34.9134    3
 18HU93039_315_130598 1098.56      34.9014    3
 18HU93039_315_130599  955.84      34.9431    3
 18HU93039_315_130600  756.23      34.8690    3
 18HU93039_315_130601  634.34      34.9510    3
 18HU93039_315_130602  503.37      35.0762    3
 18HU93039_315_130603  503.47      35.0783    3
 18HU93039_315_130604  306.79      35.3936    3
 18HU93039_315_130605  130.61      35.9171    3
 18HU93039_315_130606    6.95      34.3072    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 7, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU93039_315_130606    6.95         259.1178  3
 18HU93039_315_130605  130.61         175.1119  3
 18HU93039_315_130604  306.79         148.8518  3
 18HU93039_315_130603  503.47         184.7584  3
 18HU93039_315_130599  955.84         275.6862  0
 18HU93039_315_130598 1098.56         256.7950  2
 18HU93039_315_130596 1476.96         283.5910  3
 18HU93039_315_130595 2017.90         279.5269  3
 18HU93039_315_130594 2276.88         278.1425  3
 18HU93039_315_130593 2557.75         277.7405  3
 18HU93039_315_130591 3062.39         285.4667  3
 18HU93039_315_130590 3296.61         286.6725  3
 18HU93039_315_130589 3795.39         284.4842  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 8, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_326_130609 3632.63      34.9011    3
 18HU93039_326_130610 3379.93      34.9103    3
 18HU93039_326_130611 3043.15      34.9299    3
 18HU93039_326_130612 2775.37      34.9468    3
 18HU93039_326_130613 2776.10      34.9465    3
 18HU93039_326_130614 2192.60      34.9605    3
 18HU93039_326_130615 1888.96      34.9508    3
 18HU93039_326_130616 1594.75      34.9478    3
 18HU93039_326_130617 1301.52      34.9635    3
 18HU93039_326_130618 1303.76      34.9636    3
 18HU93039_326_130619  989.32      34.9995    3
 18HU93039_326_130620  890.46      35.0117    3
 18HU93039_326_130621  797.19      35.0190    3
 18HU93039_326_130622  646.24      35.0754    3
 18HU93039_326_130623  541.48      35.0874    3
 18HU93039_326_130624  537.77      35.0926    3
 18HU93039_326_130625  249.11      35.6859    3
 18HU93039_326_130626  150.65      36.4011    3
 18HU93039_326_130627    8.60      35.3522    3
 18HU93039_326_130628    8.60      35.3522    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 8, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU93039_326_130627    8.60         235.5815  3
 18HU93039_326_130628    8.60         235.8053  3
 18HU93039_326_130626  150.65         193.9137  3
 18HU93039_326_130625  249.11         166.0459  2
 18HU93039_326_130624  537.77         172.7449  3
 18HU93039_326_130623  541.48         174.0400  3
 18HU93039_326_130622  646.24         208.6069  3
 18HU93039_326_130621  797.19         238.7524  3
 18HU93039_326_130620  890.46         250.1407  3
 18HU93039_326_130619  989.32         260.3678  3
 18HU93039_326_130617 1301.52         273.7211  3
 18HU93039_326_130618 1303.76         273.2299  2
 18HU93039_326_130616 1594.75         282.2959  3
 18HU93039_326_130615 1888.96         280.6881  3
 18HU93039_326_130614 2192.60         274.8823  2
 18HU93039_326_130612 2775.37         278.0978  3
 18HU93039_326_130613 2776.10         277.7405  3
 18HU93039_326_130611 3043.15         279.8842  4
 18HU93039_326_130610 3379.93         290.3347  3
 18HU93039_326_130609 3632.63         289.7987  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 9, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU93039_339_130629 3529.66      34.9000    3
 18HU93039_339_130630 3217.98      34.9123    3
 18HU93039_339_130631 2899.70      34.9307    3
 18HU93039_339_130632 2598.55      34.9513    3
 18HU93039_339_130633 2293.17      34.9608    3
 18HU93039_339_130634 2006.21      34.9453    3
 18HU93039_339_130635 1726.23      34.9435    3
 18HU93039_339_130636 1424.19      34.9580    3
 18HU93039_339_130637 1154.61      34.9872    3
 18HU93039_339_130638  875.12      35.0415    3
 18HU93039_339_130639  833.40      35.0946    3
 18HU93039_339_130640  789.55      35.0424    3
 18HU93039_339_130641  598.52      35.1313    3
 18HU93039_339_130642  402.05      35.6368    3
 18HU93039_339_130643  299.24      36.0521    3
 18HU93039_339_130644  300.20      36.0597    3
 18HU93039_339_130645  152.77      36.0343    3
 18HU93039_339_130646  109.39      36.1047    3
 18HU93039_339_130647  109.39      36.1047    3
 18HU93039_339_130648   14.82      36.1052    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 9, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU93039_339_130647  109.39         224.6849  3
 18HU93039_339_130646  109.39         224.5509  3
 18HU93039_339_130645  152.77         177.9259  3
 18HU93039_339_130643  299.24         175.4691  3
 18HU93039_339_130644  300.20         175.2682  0
 18HU93039_339_130642  402.05         164.0808  3
 18HU93039_339_130641  598.52         157.9624  3
 18HU93039_339_130640  789.55         225.6223  3
 18HU93039_339_130639  833.40         230.0883  3
 18HU93039_339_130638  875.12         237.2339  3
 18HU93039_339_130637 1154.61         266.2629  3
 18HU93039_339_130636 1424.19         278.0978  3
 18HU93039_339_130635 1726.23         282.5638  3
 18HU93039_339_130634 2006.21         274.8823  2
 18HU93039_339_130633 2293.17         279.2143  3
 18HU93039_339_130632 2598.55         279.4823  3
 18HU93039_339_130631 2899.70         283.8143  2
 18HU93039_339_130630 3217.98         291.8978  3
 18HU93039_339_130629 3529.66         291.3172  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18HU94030"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18HU94030 FLAG Report:,  2019-03-15 11:50:38
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged SALINITY, event 1, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_002_150601 1373.76      34.9339    3
 18HU94030_002_150602 1375.23      34.9344    3
 18HU94030_002_150603 1376.31      34.9344    3
 18HU94030_002_150604 1380.60      34.9330    3
 18HU94030_002_150605 1378.93      34.9338    3
 18HU94030_002_150606 1379.91      34.9337    3
 18HU94030_002_150607 1381.76      34.9338    3
 18HU94030_002_150608 1382.08      34.9337    3
 18HU94030_002_150609 1383.41      34.9324    3
 18HU94030_002_150610 1384.16      34.9327    3
 18HU94030_002_150611 1386.86      34.9324    3
 18HU94030_002_150612 1386.80      34.9332    3
 18HU94030_002_150613 1388.34      34.9321    3
 18HU94030_002_150614 2743.57      34.2884    2
 18HU94030_002_150615 1388.39      34.9317    3
 18HU94030_002_150616 1391.41      34.9319    3
 18HU94030_002_150617 1390.65      34.9315    3
 18HU94030_002_150618 1390.54      34.9308    3
 18HU94030_002_150619 1389.90      34.9313    3
 18HU94030_002_150620 1390.84      34.9319    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 10, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_003_150737 4074.27      34.9082    3
 18HU94030_003_150738 3964.66      34.9104    3
 18HU94030_003_150739 3736.84      34.9147    3
 18HU94030_003_150740 3436.66      34.9227    3
 18HU94030_003_150741 3149.02      34.9329    3
 18HU94030_003_150742 2867.17      34.9445    3
 18HU94030_003_150743 2608.81      34.9480    3
 18HU94030_003_150744 2281.75      34.9423    3
 18HU94030_003_150745 1997.89      34.9605    3
 18HU94030_003_150746 1712.36      34.9567    3
 18HU94030_003_150747 1483.99      34.9656    3
 18HU94030_003_150748 1221.73      34.8526    3
 18HU94030_003_150749 1063.37      34.9942    3
 18HU94030_003_150750  814.39      35.0505    3
 18HU94030_003_150751  633.73      35.0948    3
 18HU94030_003_150752  496.67      35.5519    3
 18HU94030_003_150753  340.98      36.2692    3
 18HU94030_003_150754  204.34      36.5852    3
 18HU94030_003_150755  109.75      36.6802    3
 18HU94030_003_150756   12.10      36.2517    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 10, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU94030_003_150756   12.10         219.1024  3
 18HU94030_003_150755  109.75         204.1413  3
 18HU94030_003_150754  204.34         216.2442  3
 18HU94030_003_150753  340.98         171.7177  3
 18HU94030_003_150752  496.67         163.0090  3
 18HU94030_003_150751  633.73         167.5348  0
 18HU94030_003_150750  814.39         217.1816  3
 18HU94030_003_150749 1063.37         265.6823  3
 18HU94030_003_150748 1221.73         301.3657  3
 18HU94030_003_150747 1483.99         281.8493  3
 18HU94030_003_150746 1712.36         282.6085  3
 18HU94030_003_150745 1997.89         284.7968  3
 18HU94030_003_150744 2281.75         288.5929  3
 18HU94030_003_150743 2608.81         287.8337  3
 18HU94030_003_150742 2867.17         287.8337  3
 18HU94030_003_150741 3149.02         288.5929  3
 18HU94030_003_150740 3436.66         291.1385  3
 18HU94030_003_150739 3736.84         291.1385  3
 18HU94030_003_150738 3964.66         271.0862  3
 18HU94030_003_150737 4074.27         291.8978  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 11, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_014_150757 5395.93      34.8876    3
 18HU94030_014_150758 5293.43      34.8871    3
 18HU94030_014_150759 5066.24      34.8912    3
 18HU94030_014_150760 4527.03      34.8996    3
 18HU94030_014_150761 4217.10      34.9068    3
 18HU94030_014_150762 3740.95      34.9196    3
 18HU94030_014_150763 3376.17      34.9320    3
 18HU94030_014_150764 3067.85      34.9443    3
 18HU94030_014_150765 2781.53      34.9592    3
 18HU94030_014_150766 2473.76      34.9693    3
 18HU94030_014_150767 2278.50      34.9734    3
 18HU94030_014_150768 1986.64      34.9477    3
 18HU94030_014_150769 1787.99      34.9426    3
 18HU94030_014_150770 1377.78      34.9875    3
 18HU94030_014_150771  984.40      35.0470    3
 18HU94030_014_150772  844.82      34.7781    3
 18HU94030_014_150773  601.25      35.3589    3
 18HU94030_014_150774  297.35      36.4831    3
 18HU94030_014_150775  103.66      36.6919    3
 18HU94030_014_150776   11.39      36.4555    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 11, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU94030_014_150776   11.39         213.6539  3
 18HU94030_014_150775  103.66         202.4889  3
 18HU94030_014_150774  297.35         191.0108  3
 18HU94030_014_150773  601.25         158.0964  3
 18HU94030_014_150772  844.82         239.3776  3
 18HU94030_014_150771  984.40         246.7912  3
 18HU94030_014_150770 1377.78         250.1853  3
 18HU94030_014_150769 1787.99         288.0123  3
 18HU94030_014_150768 1986.64         286.4939  3
 18HU94030_014_150767 2278.50         281.4920  3
 18HU94030_014_150766 2473.76         272.7833  3
 18HU94030_014_150765 2781.53         281.5366  3
 18HU94030_014_150764 3067.85         273.4978  3
 18HU94030_014_150763 3376.17         283.9929  3
 18HU94030_014_150762 3740.95         284.2162  3
 18HU94030_014_150761 4217.10         281.3133  3
 18HU94030_014_150760 4527.03         280.1968  3
 18HU94030_014_150759 5066.24         275.7755  3
 18HU94030_014_150758 5293.43         244.2755  0
 18HU94030_014_150757 5395.93         274.5697  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 11, station CAST#1:

           sample_key   depth    value   method qc
 18HU94030_014_150776   11.39  0.31501 NO2NO3_0  1
 18HU94030_014_150775  103.66  1.96847 NO2NO3_0  1
 18HU94030_014_150774  297.35  7.26398 NO2NO3_0  1
 18HU94030_014_150773  601.25 23.38751 NO2NO3_0  1
 18HU94030_014_150772  844.82 20.59153 NO2NO3_0  1
 18HU94030_014_150771  984.40 20.45698 NO2NO3_0  1
 18HU94030_014_150770 1377.78 18.40701 NO2NO3_0  1
 18HU94030_014_150769 1787.99 18.44948 NO2NO3_0  1
 18HU94030_014_150768 1986.64 18.35752 NO2NO3_0  1
 18HU94030_014_150767 2278.50 19.09451 NO2NO3_0  1
 18HU94030_014_150766 2473.76 18.75650 NO2NO3_0  1
 18HU94030_014_150765 2781.53 19.10805 NO2NO3_0  1
 18HU94030_014_150764 3067.85 17.81250 NO2NO3_0  1
 18HU94030_014_150763 3376.17 19.39000 NO2NO3_0  1
 18HU94030_014_150762 3740.95 19.31698 NO2NO3_0  4
 18HU94030_014_150761 4217.10 19.75506 NO2NO3_0  1
 18HU94030_014_150760 4527.03 20.01152 NO2NO3_0  1
 18HU94030_014_150759 5066.24 21.27098 NO2NO3_0  1
 18HU94030_014_150758 5293.43 20.21405 NO2NO3_0  1
 18HU94030_014_150757 5395.93 21.41948 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 11, station CAST#1:

           sample_key   depth   value method qc
 18HU94030_014_150776   11.39 0.09501  PO4_0  1
 18HU94030_014_150775  103.66 0.15101  PO4_0  1
 18HU94030_014_150774  297.35 0.38650  PO4_0  1
 18HU94030_014_150773  601.25 1.36645  PO4_0  1
 18HU94030_014_150772  844.82 1.30400  PO4_0  1
 18HU94030_014_150771  984.40 1.25399  PO4_0  1
 18HU94030_014_150770 1377.78 1.13502  PO4_0  1
 18HU94030_014_150769 1787.99 1.15202  PO4_0  1
 18HU94030_014_150768 1986.64 1.14751  PO4_0  1
 18HU94030_014_150767 2278.50 1.19749  PO4_0  1
 18HU94030_014_150766 2473.76 1.16548  PO4_0  1
 18HU94030_014_150765 2781.53 1.21246  PO4_0  1
 18HU94030_014_150764 3067.85 1.12750  PO4_0  1
 18HU94030_014_150763 3376.17 1.22454  PO4_0  4
 18HU94030_014_150762 3740.95 1.24053  PO4_0  1
 18HU94030_014_150761 4217.10 1.28145  PO4_0  1
 18HU94030_014_150760 4527.03 1.29899  PO4_0  1
 18HU94030_014_150759 5066.24 1.38998  PO4_0  1
 18HU94030_014_150758 5293.43 1.28205  PO4_0  1
 18HU94030_014_150757 5395.93 1.38105  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 12, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_025_150777 5392.22      34.8866    3
 18HU94030_025_150778 5297.82      34.8865    3
 18HU94030_025_150779 5097.88      34.8943    3
 18HU94030_025_150780 4802.03      34.8975    3
 18HU94030_025_150781 4398.76      34.9033    3
 18HU94030_025_150782 3991.63      34.9121    3
 18HU94030_025_150783 3598.02      34.9253    3
 18HU94030_025_150784 3209.31      34.9424    3
 18HU94030_025_150785 2801.90      34.9578    3
 18HU94030_025_150786 2401.17      34.9714    3
 18HU94030_025_150787 2075.58      34.9584    3
 18HU94030_025_150788 1684.80      34.9649    3
 18HU94030_025_150789 1294.46      35.0023    3
 18HU94030_025_150790  899.92      35.0477    3
 18HU94030_025_150791  658.41      35.0454    3
 18HU94030_025_150792  436.28      35.3645    3
 18HU94030_025_150793  306.08      35.6885    3
 18HU94030_025_150794  197.41      35.8352    3
 18HU94030_025_150795  104.00      36.0373    3
 18HU94030_025_150796   11.10      35.4996    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 12, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU94030_025_150796   11.10         231.2053  3
 18HU94030_025_150795  104.00         206.9995  3
 18HU94030_025_150793  306.08         198.1118  3
 18HU94030_025_150792  436.28         167.2964  3
 18HU94030_025_150791  658.41         188.4652  3
 18HU94030_025_150790  899.92         242.6378  3
 18HU94030_025_150789 1294.46         271.3542  3
 18HU94030_025_150788 1684.80         281.4920  3
 18HU94030_025_150787 2075.58         284.4842  3
 18HU94030_025_150786 2401.17         278.2765  3
 18HU94030_025_150785 2801.90         283.4869  0
 18HU94030_025_150784 3209.31         137.9547  3
 18HU94030_025_150783 3598.02         285.0201  3
 18HU94030_025_150782 3991.63         282.6085  3
 18HU94030_025_150781 4398.76         281.1794  3
 18HU94030_025_150780 4802.03         281.1794  3
 18HU94030_025_150779 5097.88         279.3036  3
 18HU94030_025_150778 5297.82         214.8146  3
 18HU94030_025_150777 5392.22         273.7211  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 13, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_036_150797 5389.25      34.8866    3
 18HU94030_036_150798 5279.66      34.8897    3
 18HU94030_036_150799 5085.42      34.8935    3
 18HU94030_036_150800 4710.47      34.8981    3
 18HU94030_036_150801 4318.87      34.9034    3
 18HU94030_036_150802 3938.19      34.9120    3
 18HU94030_036_150803 3642.23      34.9227    3
 18HU94030_036_150804 3252.00      34.9388    3
 18HU94030_036_150805 2833.18      34.9537    3
 18HU94030_036_150806 2460.08      34.9669    3
 18HU94030_036_150807 2160.09      34.9702    3
 18HU94030_036_150808 1879.12      34.9463    3
 18HU94030_036_150809 1572.79      34.9567    3
 18HU94030_036_150810 1256.93      34.9920    3
 18HU94030_036_150811  997.56      35.0422    3
 18HU94030_036_150812  741.18      35.1609    3
 18HU94030_036_150813  457.78      35.1030    3
 18HU94030_036_150814  256.32      35.7248    3
 18HU94030_036_150815  152.35      36.0975    3
 18HU94030_036_150816   13.08      35.3444    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 13, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU94030_036_150816   13.08         228.9723  3
 18HU94030_036_150815  152.35         196.0127  3
 18HU94030_036_150814  256.32         193.9137  3
 18HU94030_036_150813  457.78         176.6750  3
 18HU94030_036_150812  741.18         221.9602  3
 18HU94030_036_150811  997.56         257.8222  3
 18HU94030_036_150810 1256.93         273.0512  3
 18HU94030_036_150809 1572.79         285.6007  3
 18HU94030_036_150808 1879.12         288.5483  3
 18HU94030_036_150807 2160.09         282.8764  3
 18HU94030_036_150806 2460.08         282.1172  3
 18HU94030_036_150805 2833.18         283.1444  3
 18HU94030_036_150804 3252.00         284.6182  3
 18HU94030_036_150803 3642.23         284.6628  3
 18HU94030_036_150802 3938.19         274.7483  3
 18HU94030_036_150801 4318.87         281.4473  3
 18HU94030_036_150800 4710.47         279.0656  0
 18HU94030_036_150799 5085.42         276.3114  3
 18HU94030_036_150798 5279.66         264.5212  3
 18HU94030_036_150797 5389.25         270.3716  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 14, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_047_150817 5400.11      34.8880    3
 18HU94030_047_150818 5294.07      34.8890    3
 18HU94030_047_150819 5081.89      34.8912    3
 18HU94030_047_150820 4765.25      34.8958    3
 18HU94030_047_150821 4362.13      34.9022    3
 18HU94030_047_150822 3892.90      34.9137    3
 18HU94030_047_150823 3524.07      34.9273    3
 18HU94030_047_150824 3145.87      34.9446    3
 18HU94030_047_150825 2764.14      34.9574    3
 18HU94030_047_150826 2486.57      34.9670    3
 18HU94030_047_150827 2170.14      34.9593    3
 18HU94030_047_150828 1881.13      34.9524    3
 18HU94030_047_150829 1580.98      34.9577    3
 18HU94030_047_150830 1292.71      34.9861    3
 18HU94030_047_150831 1013.06      35.0346    3
 18HU94030_047_150832  816.26      35.0896    3
 18HU94030_047_150833  591.92      35.0880    3
 18HU94030_047_150834  394.35      35.3196    3
 18HU94030_047_150835  193.44      35.9543    3
 18HU94030_047_150836   11.02      34.1411    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 14, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU94030_047_150836   11.02         240.9858  3
 18HU94030_047_150835  193.44         202.5778  3
 18HU94030_047_150834  394.35         170.1546  3
 18HU94030_047_150833  591.92         183.8206  3
 18HU94030_047_150832  816.26         236.0728  3
 18HU94030_047_150831 1013.06         259.9659  3
 18HU94030_047_150830 1292.71         277.6066  3
 18HU94030_047_150829 1580.98         283.9036  3
 18HU94030_047_150828 1881.13         286.8065  3
 18HU94030_047_150827 2170.14         283.5910  3
 18HU94030_047_150826 2486.57         283.0850  0
 18HU94030_047_150825 2764.14         283.1891  3
 18HU94030_047_150824 3145.87         284.0823  3
 18HU94030_047_150823 3524.07         286.8958  3
 18HU94030_047_150822 3892.90         285.1988  3
 18HU94030_047_150821 4362.13         281.3133  3
 18HU94030_047_150820 4765.25         280.1968  3
 18HU94030_047_150819 5081.89         277.6066  3
 18HU94030_047_150818 5294.07         265.8163  3
 18HU94030_047_150817 5400.11         274.1677  3


-> QC repot:
      Filename Pressure Uniqueno Variable  Values                          Test.failed
 18HU94030_014  5167.03   150759     pres 5167.03  Regional Impossible Parameter Value
 18HU94030_014  5401.54   150758     pres 5401.54  Regional Impossible Parameter Value
 18HU94030_014  5507.43   150757     pres 5507.43  Regional Impossible Parameter Value



-> Flagged SALINITY, event 15, station CAST#2:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_058_150837 4059.09      34.8974    3
 18HU94030_058_150838 3735.95      34.9075    3
 18HU94030_058_150839 3458.92      34.9194    3
 18HU94030_058_150840 3156.96      34.9345    3
 18HU94030_058_150841 2867.17      34.9462    3
 18HU94030_058_150842 2561.11      34.9574    3
 18HU94030_058_150843 2362.29      34.9558    3
 18HU94030_058_150844 2172.28      34.9393    3
 18HU94030_058_150845 1981.84      34.9335    3
 18HU94030_058_150846 1786.37      34.9459    3
 18HU94030_058_150847 1579.10      34.9671    3
 18HU94030_058_150848 1384.39      35.0065    3
 18HU94030_058_150849 1185.95      35.0656    3
 18HU94030_058_150850  999.74      35.0762    3
 18HU94030_058_150851  807.44      34.4211    3
 18HU94030_058_150852  594.78      35.4748    3
 18HU94030_058_150853  397.31      36.3104    3
 18HU94030_058_150854  192.21      36.5728    3
 18HU94030_058_150855   96.25      36.7142    3
 18HU94030_058_150856    6.92      35.4727    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 15, station CAST#2:

           sample_key   depth O2_Winkler_Molar qc
 18HU94030_058_150856    6.92         228.7490  3
 18HU94030_058_150855   96.25         177.2560  3
 18HU94030_058_150854  192.21         212.9835  3
 18HU94030_058_150853  397.31         192.6190  3
 18HU94030_058_150852  594.78         183.7312  3
 18HU94030_058_150851  807.44         249.5154  3
 18HU94030_058_150850  999.74         225.5777  3
 18HU94030_058_150849 1185.95         250.7212  3
 18HU94030_058_150848 1384.39         267.4687  3
 18HU94030_058_150847 1579.10         280.5541  3
 18HU94030_058_150846 1786.37         282.2065  3
 18HU94030_058_150845 1981.84         285.6900  3
 18HU94030_058_150844 2172.28         280.6881  3
 18HU94030_058_150843 2362.29         281.3580  3
 18HU94030_058_150842 2561.11         288.4143  3
 18HU94030_058_150841 2867.17         280.5988  3
 18HU94030_058_150840 3156.96         285.2881  3
 18HU94030_058_150839 3458.92         283.0997  3
 18HU94030_058_150838 3735.95         281.4621  0
 18HU94030_058_150837 4059.09         282.5638  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 16, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_069_150857 5391.55      34.8664    3
 18HU94030_069_150858 5282.63      34.8692    3
 18HU94030_069_150859 4909.62      34.8814    3
 18HU94030_069_150860 4605.13      34.8872    3
 18HU94030_069_150861 4314.78      34.8917    3
 18HU94030_069_150862 4032.55      34.8988    3
 18HU94030_069_150863 3657.73      34.9111    3
 18HU94030_069_150864 3264.57      34.9309    3
 18HU94030_069_150865 2949.42      34.9446    3
 18HU94030_069_150866 2771.71      34.9390    3
 18HU94030_069_150867 2463.53      34.9259    3
 18HU94030_069_150868 2182.08      34.9160    3
 18HU94030_069_150869 1994.76      34.9320    3
 18HU94030_069_150870 1498.48      34.9745    3
 18HU94030_069_150871 1177.22      35.0199    3
 18HU94030_069_150872  984.39      34.9905    3
 18HU94030_069_150873  759.71      35.3291    3
 18HU94030_069_150874  521.80      36.1667    3
 18HU94030_069_150875  203.48      36.5689    3
 18HU94030_069_150876   11.81      35.6346    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 16, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU94030_069_150876   11.81         227.6771  3
 18HU94030_069_150875  203.48         223.1218  3
 18HU94030_069_150874  521.80         188.6438  3
 18HU94030_069_150873  759.71         152.0226  3
 18HU94030_069_150872  984.39         210.8399  3
 18HU94030_069_150871 1177.22         250.1853  3
 18HU94030_069_150870 1498.48         272.5747  0
 18HU94030_069_150869 1994.76         285.4667  3
 18HU94030_069_150868 2182.08         291.8084  3
 18HU94030_069_150867 2463.53         289.4861  3
 18HU94030_069_150866 2771.71         284.9308  3
 18HU94030_069_150865 2949.42         279.2143  3
 18HU94030_069_150864 3264.57         282.6085  3
 18HU94030_069_150863 3657.73         284.4395  3
 18HU94030_069_150862 4032.55         285.1094  3
 18HU94030_069_150861 4314.78         283.8143  3
 18HU94030_069_150860 4605.13         284.3949  3
 18HU94030_069_150859 4909.62         279.7502  3
 18HU94030_069_150858 5282.63         265.5037  3
 18HU94030_069_150857 5391.55         270.6396  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 17, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_080_150877 5338.38      34.8690    3
 18HU94030_080_150878 5192.78      34.8740    3
 18HU94030_080_150879 4884.91      34.8807    3
 18HU94030_080_150880 4607.21      34.8854    3
 18HU94030_080_150881 4230.98      34.8918    3
 18HU94030_080_150882 3854.81      34.9025    3
 18HU94030_080_150883 3426.08      34.9209    3
 18HU94030_080_150884 3135.17      34.9315    3
 18HU94030_080_150885 2950.93      34.9323    3
 18HU94030_080_150886 2652.25      34.9403    3
 18HU94030_080_150887 2376.54      34.9504    3
 18HU94030_080_150888 2093.86      34.9179    3
 18HU94030_080_150889 1789.67      34.9472    3
 18HU94030_080_150890 1478.31      34.9930    3
 18HU94030_080_150891 1187.83      35.0040    3
 18HU94030_080_150892  793.90      35.2893    3
 18HU94030_080_150893  513.71      36.0511    3
 18HU94030_080_150894  204.53      36.5135    3
 18HU94030_080_150895  107.64      36.5711    3
 18HU94030_080_150896   13.49      36.2787    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 17, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU94030_080_150896   13.49         224.1936  3
 18HU94030_080_150895  107.64         200.9700  3
 18HU94030_080_150894  204.53         213.7428  3
 18HU94030_080_150893  513.71         213.9214  3
 18HU94030_080_150892  793.90         167.4303  3
 18HU94030_080_150891 1187.83         245.0494  3
 18HU94030_080_150889 1789.67         283.2784  3
 18HU94030_080_150888 2093.86         292.0317  3
 18HU94030_080_150887 2376.54         284.0823  3
 18HU94030_080_150886 2652.25         285.9133  3
 18HU94030_080_150885 2950.93         288.5929  3
 18HU94030_080_150884 3135.17         284.8861  3
 18HU94030_080_150883 3426.08         284.4842  3
 18HU94030_080_150882 3854.81         282.8764  3
 18HU94030_080_150881 4230.98         283.0997  3
 18HU94030_080_150880 4607.21         281.1347  3
 18HU94030_080_150878 5192.78         275.1355  0
 18HU94030_080_150877 5338.38         270.9522  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 2, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_113_150621   68.23      33.4777    3
 18HU94030_113_150622   30.87      33.2321    3
 18HU94030_113_150623   11.35      32.4349    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 2, station CAST#1:

           sample_key depth O2_Winkler_Molar qc
 18HU94030_113_150623 11.35          321.284  3
 18HU94030_113_150622 30.87          345.981  3
 18HU94030_113_150621 68.23          383.808  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 3, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_225_150624  972.80      34.8532    3
 18HU94030_225_150625  898.31      34.8430    3
 18HU94030_225_150626  798.67      34.8209    3
 18HU94030_225_150627  699.05      34.7783    3
 18HU94030_225_150628  548.98      34.7274    3
 18HU94030_225_150629  297.87      34.4918    3
 18HU94030_225_150630  100.46      33.6333    3
 18HU94030_225_150631   11.01      32.5362    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 3, station CAST#1:

           sample_key  depth O2_Winkler_Molar qc
 18HU94030_225_150631  11.01         331.6452  3
 18HU94030_225_150630 100.46         323.4724  3
 18HU94030_225_150629 297.87         306.3229  3
 18HU94030_225_150628 548.98         295.7385  3
 18HU94030_225_150627 699.05         297.0337  3
 18HU94030_225_150626 798.67         301.0977  3
 18HU94030_225_150625 898.31         301.5443  3
 18HU94030_225_150624 972.80         302.5492  0


-> QC repot:
      Filename Pressure Uniqueno Variable Values                          Test.failed
 18HU94030_003    12.20   150756     slca  -0.29    Global Impossible Parameter Value
 18HU94030_003   110.63   150755     slca  -0.13    Global Impossible Parameter Value
 18HU94030_003    12.20   150756     slca  -0.29  Regional Impossible Parameter Value
 18HU94030_003   110.63   150755     slca  -0.13  Regional Impossible Parameter Value



-> Flagged SALINITY, event 39, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_263_151317 2891.56      34.9016    3
 18HU94030_263_151318 2792.45      34.9131    3
 18HU94030_263_151319 2724.41      34.9138    3
 18HU94030_263_151320 2491.55      34.9166    3
 18HU94030_263_151321 2313.93      34.9162    3
 18HU94030_263_151322 2145.86      34.9022    3
 18HU94030_263_151323 2098.82      34.9095    3
 18HU94030_263_151324 1984.37      34.9020    3
 18HU94030_263_151325 1784.19      34.9036    3
 18HU94030_263_151326 1587.53      34.8999    3
 18HU94030_263_151327 1389.54      34.9117    3
 18HU94030_263_151328 1189.87      34.9350    3
 18HU94030_263_151329  990.83      34.9628    3
 18HU94030_263_151330  793.24      34.9737    3
 18HU94030_263_151331  600.46      34.9969    3
 18HU94030_263_151332  445.78      35.0649    3
 18HU94030_263_151333  349.84      34.8453    3
 18HU94030_263_151334  250.61      35.0968    3
 18HU94030_263_151335  102.59      34.7488    3
 18HU94030_263_151336   12.78      32.4969    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 39, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU94030_263_151336   12.78         270.6396  3
 18HU94030_263_151335  102.59         236.2961  3
 18HU94030_263_151334  250.61         173.8614  3
 18HU94030_263_151333  349.84         209.4107  3
 18HU94030_263_151332  445.78         218.9233  3
 18HU94030_263_151331  600.46         250.3193  3
 18HU94030_263_151330  793.24         271.9200  0
 18HU94030_263_151329  990.83         276.4901  3
 18HU94030_263_151328 1189.87         286.6725  3
 18HU94030_263_151327 1389.54         291.4065  3
 18HU94030_263_151326 1587.53         295.3366  3
 18HU94030_263_151325 1784.19         294.8900  3
 18HU94030_263_151324 1984.37         294.3541  3
 18HU94030_263_151323 2098.82         293.5055  3
 18HU94030_263_151322 2145.86         296.8997  3
 18HU94030_263_151321 2313.93         291.1385  3
 18HU94030_263_151320 2491.55         291.6745  3
 18HU94030_263_151319 2724.41         293.1482  3
 18HU94030_263_151318 2792.45         294.2201  3
 18HU94030_263_151317 2891.56         294.7560  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 4, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_264_150632 2235.60      34.9468    3
 18HU94030_264_150633 2089.93      34.9423    3
 18HU94030_264_150634 1991.73      34.8923    3
 18HU94030_264_150635 1791.60      34.8843    3
 18HU94030_264_150636 1587.36      34.8770    3
 18HU94030_264_150637 1483.36      34.8732    3
 18HU94030_264_150638 1369.48      34.8975    3
 18HU94030_264_150639 1206.82      34.8822    3
 18HU94030_264_150640 1045.69      34.9068    3
 18HU94030_264_150641  857.54      34.9487    3
 18HU94030_264_150642  691.94      34.9180    3
 18HU94030_264_150643  502.95      34.8402    3
 18HU94030_264_150644  264.62      34.8229    3
 18HU94030_264_150645   87.47      34.0378    3
 18HU94030_264_150646   10.24      32.3496    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 4, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU94030_264_150646   10.24         304.1346  3
 18HU94030_264_150645   87.47         309.8957  3
 18HU94030_264_150644  264.62         255.4552  3
 18HU94030_264_150643  502.95         298.2841  3
 18HU94030_264_150642  691.94         288.8609  3
 18HU94030_264_150641  857.54         285.5114  3
 18HU94030_264_150640 1045.69         296.5424  3
 18HU94030_264_150639 1206.82         277.1153  3
 18HU94030_264_150638 1369.48         246.6125  3
 18HU94030_264_150637 1483.36         306.2783  3
 18HU94030_264_150636 1587.36         305.6977  3
 18HU94030_264_150635 1791.60         297.7482  3
 18HU94030_264_150634 1991.73         305.0725  3
 18HU94030_264_150632 2235.60         289.2628  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 40, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_265_151337 2044.02      34.8671    3
 18HU94030_265_151338 1947.20      34.8638    3
 18HU94030_265_151339 1816.89      34.8623    3
 18HU94030_265_151340 1547.21      34.8650    3
 18HU94030_265_151341 1191.44      34.8871    3
 18HU94030_265_151342  995.99      34.9017    3
 18HU94030_265_151343  801.49      34.9382    3
 18HU94030_265_151344  731.72      34.8939    3
 18HU94030_265_151345  638.01      34.9878    3
 18HU94030_265_151346  509.46      34.8803    3
 18HU94030_265_151347  396.42      35.0209    3
 18HU94030_265_151348  303.44      35.0176    3
 18HU94030_265_151349  105.11      33.9359    3
 18HU94030_265_151350   12.95      32.1817    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 40, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU94030_265_151350   12.95         279.3483  3
 18HU94030_265_151349  105.11         314.4064  3
 18HU94030_265_151348  303.44         220.0398  3
 18HU94030_265_151347  396.42         235.0456  3
 18HU94030_265_151346  509.46         274.3910  3
 18HU94030_265_151345  638.01         265.8610  3
 18HU94030_265_151344  731.72         289.0395  3
 18HU94030_265_151343  801.49         273.8998  3
 18HU94030_265_151342  995.99         293.0589  3
 18HU94030_265_151341 1191.44         297.7781  0
 18HU94030_265_151340 1547.21         304.4026  3
 18HU94030_265_151339 1816.89         305.0725  3
 18HU94030_265_151338 1947.20         305.0278  3
 18HU94030_265_151337 2044.02         306.0996  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 41, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_275_151351  992.92      34.8403    3
 18HU94030_275_151352  892.26      34.8360    3
 18HU94030_275_151353  741.72      34.8323    3
 18HU94030_275_151354  596.35      34.8137    3
 18HU94030_275_151355  443.21      34.7524    3
 18HU94030_275_151356  258.36      34.5283    3
 18HU94030_275_151357  152.43      34.0529    3
 18HU94030_275_151358   43.47      33.3068    3
 18HU94030_275_151359   12.61      32.3495    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 41, station CAST#1:

           sample_key  depth O2_Winkler_Molar qc
 18HU94030_275_151359  12.61         336.7364  3
 18HU94030_275_151358  43.47         337.2723  3
 18HU94030_275_151357 152.43         314.4064  3
 18HU94030_275_151356 258.36         297.6142  3
 18HU94030_275_151355 443.21         298.9540  3
 18HU94030_275_151354 596.35         303.9707  0
 18HU94030_275_151353 741.72         306.3676  3
 18HU94030_275_151352 892.26         306.8142  3
 18HU94030_275_151351 992.92         305.3851  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 42, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_276_151360 1067.37      34.8250    3
 18HU94030_276_151361  945.82      34.8161    3
 18HU94030_276_151362  800.51      34.8176    3
 18HU94030_276_151363  500.72      34.7488    3
 18HU94030_276_151364  302.48      34.5695    3
 18HU94030_276_151365   54.08      33.2850    3
 18HU94030_276_151366   12.90      32.4623    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 42, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU94030_276_151366   12.90         334.9947  3
 18HU94030_276_151365   54.08         338.8801  3
 18HU94030_276_151364  302.48         300.0406  0
 18HU94030_276_151363  500.72         299.5793  3
 18HU94030_276_151362  800.51         304.3579  3
 18HU94030_276_151361  945.82         303.9113  3
 18HU94030_276_151360 1067.37         304.1346  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 43, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_277_151367  526.80      34.7016    3
 18HU94030_277_151368  374.05      34.5453    3
 18HU94030_277_151369  245.80      34.3211    3
 18HU94030_277_151370   54.46      33.2359    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 43, station CAST#1:

           sample_key  depth O2_Winkler_Molar qc
 18HU94030_277_151370  54.46         339.2820  3
 18HU94030_277_151369 245.80         298.8647  3
 18HU94030_277_151368 374.05         299.9513  0
 18HU94030_277_151367 526.80         299.0880  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 44, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_278_151371  177.04      34.1358    3
 18HU94030_278_151372  103.79      33.5249    3
 18HU94030_278_151373   12.80      32.1957    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 44, station CAST#1:

           sample_key  depth O2_Winkler_Molar qc
 18HU94030_278_151373  12.80         321.6860  3
 18HU94030_278_151372 103.79         329.1143  0
 18HU94030_278_151371 177.04         309.4938  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 45, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_279_151374  109.71      33.5670    3
 18HU94030_279_151375   52.53      33.1562    3
 18HU94030_279_151376   13.64      31.8748    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 45, station CAST#1:

           sample_key  depth O2_Winkler_Molar qc
 18HU94030_279_151376  13.64         325.8693  0
 18HU94030_279_151375  52.53         340.2199  3
 18HU94030_279_151374 109.71         311.1909  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 5, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_284_150647 3039.70      34.9133    3
 18HU94030_284_150648 2930.71      34.9219    3
 18HU94030_284_150649 2818.46      34.9282    3
 18HU94030_284_150650 2510.56      34.9507    3
 18HU94030_284_150651 2280.00      34.9523    3
 18HU94030_284_150652 2038.88      34.9689    3
 18HU94030_284_150653 1877.21      34.9688    3
 18HU94030_284_150654 1646.23      34.9537    3
 18HU94030_284_150655 1440.30      34.9498    3
 18HU94030_284_150656 1232.75      34.9569    3
 18HU94030_284_150657 1084.38      34.9646    3
 18HU94030_284_150658  898.59      34.9765    3
 18HU94030_284_150659  731.52      34.9927    3
 18HU94030_284_150660  461.40      34.8027    3
 18HU94030_284_150661  322.35      34.9383    3
 18HU94030_284_150662  252.30      34.7615    3
 18HU94030_284_150663  165.04      34.1689    3
 18HU94030_284_150664  102.57      33.8977    3
 18HU94030_284_150665   62.73      33.4024    3
 18HU94030_284_150666   11.63      32.4291    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 5, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU94030_284_150666   11.63         273.0517  3
 18HU94030_284_150665   62.73         332.9403  3
 18HU94030_284_150664  102.57         318.0239  3
 18HU94030_284_150663  165.04         308.3326  3
 18HU94030_284_150662  252.30         253.7135  3
 18HU94030_284_150661  322.35         242.1465  3
 18HU94030_284_150660  461.40         292.6123  3
 18HU94030_284_150659  731.52         270.9076  3
 18HU94030_284_150658  898.59         277.5172  3
 18HU94030_284_150657 1084.38         283.4570  3
 18HU94030_284_150656 1232.75         284.3502  3
 18HU94030_284_150655 1440.30         287.9677  3
 18HU94030_284_150654 1646.23         286.3599  3
 18HU94030_284_150653 1877.21         285.0648  3
 18HU94030_284_150652 2038.88         283.0551  3
 18HU94030_284_150651 2280.00         285.6007  0
 18HU94030_284_150650 2510.56         285.6900  3
 18HU94030_284_150649 2818.46         292.5230  3
 18HU94030_284_150648 2930.71         294.3541  3
 18HU94030_284_150647 3039.70         294.6667  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 6, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_304_150667 3523.58      34.9107    3
 18HU94030_304_150668 3429.35      34.9121    3
 18HU94030_304_150669 3322.39      34.9165    3
 18HU94030_304_150670 3142.05      34.9201    3
 18HU94030_304_150671 2936.83      34.9289    3
 18HU94030_304_150672 2752.46      34.9353    3
 18HU94030_304_150673 2560.84      34.9403    3
 18HU94030_304_150674 2356.67      34.9609    3
 18HU94030_304_150675 2176.11      34.9664    3
 18HU94030_304_150676 1990.93      34.9671    3
 18HU94030_304_150677 1781.12      34.9644    3
 18HU94030_304_150678 1587.78      34.9330    3
 18HU94030_304_150679 1384.17      34.9083    3
 18HU94030_304_150680 1180.79      34.9569    3
 18HU94030_304_150681  989.61      34.9742    3
 18HU94030_304_150682  787.25      34.9794    3
 18HU94030_304_150683  578.13      34.9737    3
 18HU94030_304_150684  403.71      34.8062    3
 18HU94030_304_150685  207.40      34.4379    3
 18HU94030_304_150686   11.82      32.2965    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 6, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU94030_304_150686   11.82         274.3910  3
 18HU94030_304_150685  207.40         279.0803  3
 18HU94030_304_150684  403.71         283.1891  3
 18HU94030_304_150683  578.13         272.5153  3
 18HU94030_304_150682  787.25         278.9464  3
 18HU94030_304_150680 1180.79         283.5910  3
 18HU94030_304_150679 1384.17         296.8104  3
 18HU94030_304_150678 1587.78         290.1560  3
 18HU94030_304_150677 1781.12         282.9211  3
 18HU94030_304_150676 1990.93         281.8046  3
 18HU94030_304_150675 2176.11         281.4027  3
 18HU94030_304_150674 2356.67         281.8493  3
 18HU94030_304_150673 2560.84         288.9949  3
 18HU94030_304_150672 2752.46         289.4415  3
 18HU94030_304_150671 2936.83         291.1385  3
 18HU94030_304_150670 3142.05         293.4609  0
 18HU94030_304_150669 3322.39         292.3444  3
 18HU94030_304_150668 3429.35         293.8628  3
 18HU94030_304_150667 3523.58         293.3269  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 7, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_315_150687 3833.62      34.9103    3
 18HU94030_315_150688 3689.41      34.9118    3
 18HU94030_315_150689 3547.16      34.9138    3
 18HU94030_315_150690 3346.73      34.9183    3
 18HU94030_315_150691 3076.88      34.9313    3
 18HU94030_315_150692 2762.86      34.9413    3
 18HU94030_315_150693 2510.11      34.9579    3
 18HU94030_315_150694 2279.74      34.9652    3
 18HU94030_315_150695 2028.05      34.9571    3
 18HU94030_315_150696 1716.43      34.9642    3
 18HU94030_315_150697 1219.32      34.9310    3
 18HU94030_315_150698 1077.07      34.9215    3
 18HU94030_315_150699  957.06      34.9729    3
 18HU94030_315_150700  730.81      34.9763    3
 18HU94030_315_150701  590.99      34.9338    3
 18HU94030_315_150702  490.11      34.8724    3
 18HU94030_315_150703  272.08      34.5366    3
 18HU94030_315_150704  115.92      33.5948    3
 18HU94030_315_150705   51.99      32.7032    3
 18HU94030_315_150706   10.43      32.1564    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 7, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU94030_315_150706   10.43         285.8687  3
 18HU94030_315_150705   51.99         355.5829  3
 18HU94030_315_150704  115.92         335.3966  3
 18HU94030_315_150703  272.08         295.7385  3
 18HU94030_315_150702  490.11         281.3580  3
 18HU94030_315_150701  590.99         275.9095  3
 18HU94030_315_150700  730.81         255.3212  3
 18HU94030_315_150699  957.06         215.2612  3
 18HU94030_315_150698 1077.07         294.1308  3
 18HU94030_315_150697 1219.32         292.3890  3
 18HU94030_315_150696 1716.43         284.2162  3
 18HU94030_315_150695 2028.05         285.0947  0
 18HU94030_315_150694 2279.74         283.0997  3
 18HU94030_315_150693 2510.11         284.0823  3
 18HU94030_315_150692 2762.86         289.5754  3
 18HU94030_315_150691 3076.88         290.7813  3
 18HU94030_315_150690 3346.73         292.2104  3
 18HU94030_315_150689 3547.16         291.4065  3
 18HU94030_315_150688 3689.41         290.6026  3
 18HU94030_315_150687 3833.62         291.4958  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 8, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_326_150707 1945.34      34.8878    3
 18HU94030_326_150708 1651.75      34.8811    3
 18HU94030_326_150709 1504.43      34.8929    3
 18HU94030_326_150710 1283.02      34.8765    3
 18HU94030_326_150711 1094.34      34.8601    3
 18HU94030_326_150712  891.29      34.8943    3
 18HU94030_326_150713  690.31      35.0249    3
 18HU94030_326_150714  576.38      34.7376    3
 18HU94030_326_150715  394.35      35.2242    3
 18HU94030_326_150716  192.14      36.1184    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 8, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU94030_326_150716  192.14         189.8050  3
 18HU94030_326_150715  394.35         158.5430  0
 18HU94030_326_150714  576.38         246.0319  3
 18HU94030_326_150713  690.31         242.9951  3
 18HU94030_326_150712  891.29         289.4415  3
 18HU94030_326_150711 1094.34         303.5540  3
 18HU94030_326_150710 1283.02         304.8938  3
 18HU94030_326_150709 1504.43         302.4375  3
 18HU94030_326_150708 1651.75         303.7327  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 8, station CAST#1:

           sample_key   depth    value   method qc
 18HU94030_326_150716  192.14 11.17751 NO2NO3_0  2
 18HU94030_326_150715  394.35 24.84350 NO2NO3_0  1
 18HU94030_326_150714  576.38 20.66353 NO2NO3_0  1
 18HU94030_326_150713  690.31 21.17750 NO2NO3_0  1
 18HU94030_326_150712  891.29 18.85947 NO2NO3_0  1
 18HU94030_326_150711 1094.34 18.53604 NO2NO3_0  1
 18HU94030_326_150710 1283.02 18.68349 NO2NO3_0  1
 18HU94030_326_150709 1504.43 18.97302 NO2NO3_0  1
 18HU94030_326_150708 1651.75 18.54301 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 8, station CAST#1:

           sample_key   depth   value method qc
 18HU94030_326_150716  192.14 0.56753  PO4_0  2
 18HU94030_326_150715  394.35 1.42398  PO4_0  2
 18HU94030_326_150714  576.38 1.25103  PO4_0  1
 18HU94030_326_150713  690.31 1.25048  PO4_0  1
 18HU94030_326_150712  891.29 1.17998  PO4_0  1
 18HU94030_326_150711 1094.34 1.10301  PO4_0  1
 18HU94030_326_150710 1283.02 1.09902  PO4_0  1
 18HU94030_326_150709 1504.43 1.10047  PO4_0  1
 18HU94030_326_150708 1651.75 1.12498  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 8, station CAST#1:

           sample_key   depth    value method qc
 18HU94030_326_150716  192.14  4.35255 SiO4_0  2
 18HU94030_326_150715  394.35 14.01797 SiO4_0  1
 18HU94030_326_150714  576.38 13.12001 SiO4_0  1
 18HU94030_326_150713  690.31 12.69306 SiO4_0  1
 18HU94030_326_150712  891.29 11.12805 SiO4_0  1
 18HU94030_326_150711 1094.34 10.59903 SiO4_0  1
 18HU94030_326_150710 1283.02 11.02798 SiO4_0  1
 18HU94030_326_150709 1504.43 11.56753 SiO4_0  1
 18HU94030_326_150708 1651.75 11.04597 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 9, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU94030_339_150717 3245.07      34.9257    3
 18HU94030_339_150718 2992.34      34.9403    3
 18HU94030_339_150719 2759.44      34.9459    3
 18HU94030_339_150720 2466.64      34.9657    3
 18HU94030_339_150721 2451.53      34.9622    3
 18HU94030_339_150722 2183.47      34.9595    3
 18HU94030_339_150723 2090.20      34.9485    3
 18HU94030_339_150724 1863.69      34.8988    3
 18HU94030_339_150725 1436.66      34.9249    3
 18HU94030_339_150726 1211.45      34.8560    3
 18HU94030_339_150727  953.83      34.9267    3
 18HU94030_339_150728  830.61      34.7765    3
 18HU94030_339_150729  699.37      34.8357    3
 18HU94030_339_150730  532.41      35.1076    3
 18HU94030_339_150731  438.64      35.4576    3
 18HU94030_339_150732  308.02      35.9283    3
 18HU94030_339_150733  221.29      36.4778    3
 18HU94030_339_150734  105.21      36.6724    3
 18HU94030_339_150735   49.92      36.4291    3
 18HU94030_339_150736   10.36      36.4223    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 9, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU94030_339_150736   10.36         216.2888  3
 18HU94030_339_150735   49.92         188.0637  3
 18HU94030_339_150734  105.21         183.0171  3
 18HU94030_339_150733  221.29         190.8768  3
 18HU94030_339_150732  308.02         176.0944  3
 18HU94030_339_150731  438.64         168.3235  3
 18HU94030_339_150730  532.41         165.8226  3
 18HU94030_339_150729  699.37         252.5670  0
 18HU94030_339_150728  830.61         291.9424  3
 18HU94030_339_150727  953.83         279.8842  3
 18HU94030_339_150726 1211.45         304.0899  3
 18HU94030_339_150725 1436.66         291.4958  3
 18HU94030_339_150724 1863.69         307.5288  3
 18HU94030_339_150723 2090.20         286.8958  3
 18HU94030_339_150722 2183.47         285.4221  3
 18HU94030_339_150721 2451.53         282.1619  3
 18HU94030_339_150720 2466.64         282.6085  3
 18HU94030_339_150719 2759.44         287.4318  3
 18HU94030_339_150718 2992.34         286.0026  3
 18HU94030_339_150717 3245.07         292.0764  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 9, station CAST#1:

           sample_key   depth    value   method qc
 18HU94030_339_150736   10.36  0.00000 NO2NO3_0  1
 18HU94030_339_150735   49.92  0.12900 NO2NO3_0  1
 18HU94030_339_150734  105.21  4.48904 NO2NO3_0  1
 18HU94030_339_150733  221.29  6.66000 NO2NO3_0  1
 18HU94030_339_150732  308.02 13.23854 NO2NO3_0  1
 18HU94030_339_150731  438.64 20.60554 NO2NO3_0  1
 18HU94030_339_150730  532.41 24.66453 NO2NO3_0  1
 18HU94030_339_150729  699.37 19.70999 NO2NO3_0  1
 18HU94030_339_150728  830.61 17.85898 NO2NO3_0  1
 18HU94030_339_150727  953.83 19.50749 NO2NO3_0  1
 18HU94030_339_150726 1211.45 18.06204 NO2NO3_0  1
 18HU94030_339_150725 1436.66 18.91397 NO2NO3_0  1
 18HU94030_339_150724 1863.69 18.58254 NO2NO3_0  1
 18HU94030_339_150723 2090.20 19.15756 NO2NO3_0  2
 18HU94030_339_150722 2183.47 19.27549 NO2NO3_0  2
 18HU94030_339_150721 2451.53 19.53202 NO2NO3_0  1
 18HU94030_339_150720 2466.64 19.12251 NO2NO3_0  1
 18HU94030_339_150719 2759.44 18.96546 NO2NO3_0  2
 18HU94030_339_150718 2992.34 19.09906 NO2NO3_0  2
 18HU94030_339_150717 3245.07 18.68202 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 9, station CAST#1:

           sample_key   depth   value method qc
 18HU94030_339_150736   10.36 0.13598  PO4_0  1
 18HU94030_339_150735   49.92 0.10548  PO4_0  1
 18HU94030_339_150734  105.21 0.28055  PO4_0  1
 18HU94030_339_150733  221.29 0.36647  PO4_0  1
 18HU94030_339_150732  308.02 0.70154  PO4_0  1
 18HU94030_339_150731  438.64 1.14548  PO4_0  1
 18HU94030_339_150730  532.41 1.49404  PO4_0  1
 18HU94030_339_150729  699.37 1.24404  PO4_0  1
 18HU94030_339_150728  830.61 1.18398  PO4_0  1
 18HU94030_339_150727  953.83 1.15354  PO4_0  1
 18HU94030_339_150726 1211.45 1.09203  PO4_0  1
 18HU94030_339_150725 1436.66 1.12050  PO4_0  1
 18HU94030_339_150724 1863.69 1.12346  PO4_0  1
 18HU94030_339_150723 2090.20 1.14504  PO4_0  2
 18HU94030_339_150722 2183.47 1.15049  PO4_0  1
 18HU94030_339_150721 2451.53 1.17953  PO4_0  2
 18HU94030_339_150720 2466.64 1.24550  PO4_0  1
 18HU94030_339_150719 2759.44 1.14504  PO4_0  1
 18HU94030_339_150718 2992.34 1.13898  PO4_0  1
 18HU94030_339_150717 3245.07 1.15754  PO4_0  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 9, station CAST#1:

           sample_key   depth    value method qc
 18HU94030_339_150736   10.36  1.89597 SiO4_0  1
 18HU94030_339_150735   49.92  1.62196 SiO4_0  1
 18HU94030_339_150734  105.21  2.43903 SiO4_0  1
 18HU94030_339_150733  221.29  2.74599 SiO4_0  1
 18HU94030_339_150732  308.02  5.29196 SiO4_0  1
 18HU94030_339_150731  438.64  9.78355 SiO4_0  1
 18HU94030_339_150730  532.41 14.41547 SiO4_0  1
 18HU94030_339_150729  699.37 12.47152 SiO4_0  1
 18HU94030_339_150728  830.61 11.46496 SiO4_0  1
 18HU94030_339_150727  953.83 11.79999 SiO4_0  1
 18HU94030_339_150726 1211.45 10.90450 SiO4_0  1
 18HU94030_339_150725 1436.66 11.42602 SiO4_0  1
 18HU94030_339_150724 1863.69 11.67396 SiO4_0  1
 18HU94030_339_150723 2090.20 14.08401 SiO4_0  1
 18HU94030_339_150722 2183.47 14.86302 SiO4_0  2
 18HU94030_339_150721 2451.53 17.32747 SiO4_0  2
 18HU94030_339_150720 2466.64 17.26955 SiO4_0  2
 18HU94030_339_150719 2759.44 16.35806 SiO4_0  1
 18HU94030_339_150718 2992.34 17.43901 SiO4_0  2
 18HU94030_339_150717 3245.07 18.16055 SiO4_0  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18HU95003"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18HU95003 FLAG Report:,  2019-03-15 11:52:19
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged SALINITY, event 1, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_002_152901   23.94      30.7366    3
 18HU95003_002_152902   23.92      30.7393    3
 18HU95003_002_152903   23.90      30.7157    3
 18HU95003_002_152904   23.86      30.6927    3
 18HU95003_002_152905   23.83      30.6796    3
 18HU95003_002_152906   23.84      30.6525    3
 18HU95003_002_152907   23.85      30.6557    3
 18HU95003_002_152908   23.86      30.6554    3
 18HU95003_002_152909   23.85      30.6613    3
 18HU95003_002_152910   23.84      30.6573    3
 18HU95003_002_152911   23.81      30.6650    3
 18HU95003_002_152912   23.80      30.6605    3
 18HU95003_002_152913   23.80      30.6644    3
 18HU95003_002_152914   23.79      30.6657    3
 18HU95003_002_152915   23.77      30.6654    3
 18HU95003_002_152916   23.74      30.6615    3
 18HU95003_002_152917   23.74      30.6679    3
 18HU95003_002_152918   23.73      30.6827    3
 18HU95003_002_152919   23.73      30.6954    3
 18HU95003_002_152920   23.72      30.6658    3
 18HU95003_002_152921   23.73      30.6613    3
 18HU95003_002_152922   23.73      30.6596    3
 18HU95003_002_152923   23.71      30.6595    3
 18HU95003_002_152924   23.69      30.6586    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 100, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_004_154454 2903.64      34.9346    3
 18HU95003_004_154455 2732.02      34.9431    3
 18HU95003_004_154456 2267.90      34.9429    3
 18HU95003_004_154457 1891.71      34.9323    3
 18HU95003_004_154458 1493.76      34.9226    3
 18HU95003_004_154459 1114.10      34.9428    3
 18HU95003_004_154460  692.85      34.9842    3
 18HU95003_004_154461  401.48      35.0334    3
 18HU95003_004_154462  313.15      35.1448    3
 18HU95003_004_154463  218.38      35.2898    3
 18HU95003_004_154464  115.62      35.3872    3
 18HU95003_004_154465   20.03      34.0186    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 100, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU95003_004_154465   20.03         312.4414  3
 18HU95003_004_154464  115.62         247.0145  3
 18HU95003_004_154463  218.38         218.9680  3
 18HU95003_004_154462  313.15         159.7488  0
 18HU95003_004_154461  401.48         175.9604  3
 18HU95003_004_154460  692.85         249.2921  3
 18HU95003_004_154459 1114.10         275.6415  3
 18HU95003_004_154458 1493.76         279.7056  3
 18HU95003_004_154457 1891.71         283.8590  3
 18HU95003_004_154456 2267.90         280.0182  3
 18HU95003_004_154455 2732.02         278.0978  3
 18HU95003_004_154454 2903.64         240.0475  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 101, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_005_154466  742.64      34.9536    3
 18HU95003_005_154467  678.94      34.9578    3
 18HU95003_005_154468  444.31      34.9325    3
 18HU95003_005_154469  296.08      35.0416    3
 18HU95003_005_154470  196.59      35.0581    3
 18HU95003_005_154471   99.56      34.6748    3
 18HU95003_005_154472   10.28      33.3065    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 101, station CAST#1:

           sample_key  depth O2_Winkler_Molar qc
 18HU95003_005_154472  10.28         328.1617  3
 18HU95003_005_154471  99.56         226.6495  3
 18HU95003_005_154470 196.59         166.0905  3
 18HU95003_005_154469 296.08         169.4847  3
 18HU95003_005_154468 444.31         224.4612  3
 18HU95003_005_154467 678.94         264.3425  3
 18HU95003_005_154466 742.64         267.2008  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 102, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_006_154473   52.80      32.5190    3
 18HU95003_006_154474   31.03      32.3830    3
 18HU95003_006_154475   10.68      32.2745    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 102, station CAST#1:

           sample_key depth O2_Winkler_Molar qc
 18HU95003_006_154475 10.68         367.9314  0
 18HU95003_006_154474 31.03         363.9790  3
 18HU95003_006_154473 52.80         351.6975  3


-> QC repot:
      Filename Pressure Uniqueno Variable     Values                          Test.failed
 18HU95003_102  5238.09   153255     pres  5238.09    Regional Impossible Parameter Value
 18HU95003_102  5429.86   153254     pres  5429.86    Regional Impossible Parameter Value



-> Flagged SALINITY, event 103, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_007_154476  244.01      32.8311    3
 18HU95003_007_154477  175.30      32.6925    3
 18HU95003_007_154478   77.83      32.3897    3
 18HU95003_007_154479   21.52      31.6948    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 103, station CAST#1:

           sample_key  depth O2_Winkler_Molar qc
 18HU95003_007_154479  21.52         371.8392  3
 18HU95003_007_154478  77.83         305.8763  3
 18HU95003_007_154477 175.30         289.7094  3
 18HU95003_007_154476 244.01         282.8318  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 104, station CAST#2:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_008_154480   94.70      32.3431    3
 18HU95003_008_154481   49.68      31.8148    3
 18HU95003_008_154482   10.56      31.1463    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 104, station CAST#2:

           sample_key depth O2_Winkler_Molar qc
 18HU95003_008_154482 10.56         362.6839  0
 18HU95003_008_154481 49.68         365.5868  3
 18HU95003_008_154480 94.70         297.8822  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 105, station CAST#2:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_009_154483  139.17      32.8446    3
 18HU95003_009_154484   88.71      32.3116    3
 18HU95003_009_154485   45.83      31.6293    3
 18HU95003_009_154486   10.72      30.5428    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 105, station CAST#2:

           sample_key  depth O2_Winkler_Molar qc
 18HU95003_009_154486  10.72         410.1574  3
 18HU95003_009_154485  45.83         376.5285  3
 18HU95003_009_154484  88.71         355.5383  3
 18HU95003_009_154483 139.17         278.3211  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 106, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_010_154487  125.79      32.7691    3
 18HU95003_010_154488   80.66      32.2544    3
 18HU95003_010_154489   35.98      31.5478    3
 18HU95003_010_154490   10.37      31.0671    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 106, station CAST#1:

           sample_key  depth O2_Winkler_Molar qc
 18HU95003_010_154490  10.37         393.4993  3
 18HU95003_010_154489  35.98         392.8294  3
 18HU95003_010_154488  80.66         364.1576  3
 18HU95003_010_154487 125.79         308.2880  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 107, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_011_154491   75.66      31.7550    3
 18HU95003_011_154492   41.30      31.3477    3
 18HU95003_011_154493   10.52      30.5923    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 107, station CAST#1:

           sample_key depth O2_Winkler_Molar qc
 18HU95003_011_154493 10.52         426.4137  3
 18HU95003_011_154492 41.30         389.7032  3
 18HU95003_011_154491 75.66         372.5537  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 11, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_014_153070 4302.56      34.8802    3
 18HU95003_014_153071 4205.78      34.8802    3
 18HU95003_014_153072 4097.91      34.8856    3
 18HU95003_014_153073 3914.86      34.8903    3
 18HU95003_014_153074 3741.44      34.8935    3
 18HU95003_014_153075 3532.24      34.8990    3
 18HU95003_014_153076 3333.67      34.9057    3
 18HU95003_014_153077 3135.95      34.9147    3
 18HU95003_014_153078 2908.77      34.9228    3
 18HU95003_014_153079 2808.44      34.9250    3
 18HU95003_014_153080 2617.00      34.9369    3
 18HU95003_014_153081 2412.32      34.9401    3
 18HU95003_014_153082 2241.48      34.9360    3
 18HU95003_014_153083 1980.35      34.9281    3
 18HU95003_014_153084 1740.02      34.9008    3
 18HU95003_014_153085 1519.03      34.9099    3
 18HU95003_014_153086 1192.64      34.9429    3
 18HU95003_014_153087  992.89      34.9137    3
 18HU95003_014_153088  710.35      34.8782    3
 18HU95003_014_153089  525.56      34.5151    3
 18HU95003_014_153090  363.78      34.6646    3
 18HU95003_014_153091  217.26      35.5697    3
 18HU95003_014_153092   15.90      33.2769    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 11, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU95003_014_153092   15.90         339.5500  3
 18HU95003_014_153091  217.26         161.7585  3
 18HU95003_014_153090  363.78         216.6010  3
 18HU95003_014_153089  525.56         257.7329  3
 18HU95003_014_153088  710.35         254.7406  3
 18HU95003_014_153087  992.89         277.2939  3
 18HU95003_014_153086 1192.64         273.2299  3
 18HU95003_014_153085 1519.03         277.6512  3
 18HU95003_014_153084 1740.02         281.0454  3
 18HU95003_014_153083 1980.35         281.1794  3
 18HU95003_014_153082 2241.48         274.7483  0
 18HU95003_014_153081 2412.32         275.5969  3
 18HU95003_014_153080 2617.00         274.4357  3
 18HU95003_014_153079 2808.44         278.0532  3
 18HU95003_014_153078 2908.77         277.2493  3
 18HU95003_014_153077 3135.95         277.8299  3
 18HU95003_014_153076 3333.67         281.2240  3
 18HU95003_014_153075 3532.24         279.1697  3
 18HU95003_014_153074 3741.44         279.4376  3
 18HU95003_014_153073 3914.86         278.5891  3
 18HU95003_014_153072 4097.91         280.3308  3
 18HU95003_014_153071 4205.78         274.9716  3
 18HU95003_014_153070 4302.56         277.6066  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 12, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_025_153093 5341.96      34.8617    3
 18HU95003_025_153094 5114.47      34.8691    3
 18HU95003_025_153095 4874.18      34.8742    3
 18HU95003_025_153096 4625.56      34.8785    3
 18HU95003_025_153097 4270.76      34.8848    3
 18HU95003_025_153098 4020.68      34.8906    3
 18HU95003_025_153099 3735.11      34.8992    3
 18HU95003_025_153100 3453.81      34.9106    3
 18HU95003_025_153101 3159.46      34.9233    3
 18HU95003_025_153102 2890.39      34.9355    3
 18HU95003_025_153103 2651.84      34.9443    3
 18HU95003_025_153104 2409.20      34.9501    3
 18HU95003_025_153105 2161.08      34.9450    3
 18HU95003_025_153106 1818.49      34.9384    3
 18HU95003_025_153107 1615.03      34.9408    3
 18HU95003_025_153108 1410.94      34.9638    3
 18HU95003_025_153109 1200.83      34.9882    3
 18HU95003_025_153110 1011.67      35.0461    3
 18HU95003_025_153111  800.90      35.0947    3
 18HU95003_025_153112  599.91      35.2037    3
 18HU95003_025_153113  427.95      35.6157    3
 18HU95003_025_153114  242.59      36.2765    3
 18HU95003_025_153115  101.56      36.5676    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 12, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU95003_025_153115  101.56         205.0345  3
 18HU95003_025_153114  242.59         203.3370  3
 18HU95003_025_153113  427.95         202.5331  3
 18HU95003_025_153112  599.91         149.7003  3
 18HU95003_025_153111  800.90         201.9972  3
 18HU95003_025_153110 1011.67         240.8960  3
 18HU95003_025_153109 1200.83         258.7600  3
 18HU95003_025_153108 1410.94         268.6746  3
 18HU95003_025_153107 1615.03         270.7289  3
 18HU95003_025_153106 1818.49         275.5075  3
 18HU95003_025_153105 2161.08         271.8008  3
 18HU95003_025_153104 2409.20         272.7386  3
 18HU95003_025_153103 2651.84         272.7386  3
 18HU95003_025_153102 2890.39         273.6318  3
 18HU95003_025_153101 3159.46         275.3289  3
 18HU95003_025_153100 3453.81         273.7658  3
 18HU95003_025_153099 3735.11         275.1949  3
 18HU95003_025_153098 4020.68         274.3464  3
 18HU95003_025_153097 4270.76         273.0959  3
 18HU95003_025_153096 4625.56         270.7289  3
 18HU95003_025_153095 4874.18         268.7639  3
 18HU95003_025_153094 5114.47         267.2454  3
 18HU95003_025_153093 5341.96         263.7173  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 13, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_036_153116 5375.89      34.8631    3
 18HU95003_036_153117 5276.89      34.8678    3
 18HU95003_036_153118 5103.20      34.8718    3
 18HU95003_036_153119 4897.86      34.8760    3
 18HU95003_036_153120 4654.93      34.8801    3
 18HU95003_036_153121 4417.67      34.8841    3
 18HU95003_036_153122 4222.53      34.8878    3
 18HU95003_036_153123 3926.28      34.8948    3
 18HU95003_036_153124 3541.35      34.9087    3
 18HU95003_036_153125 3247.30      34.9228    3
 18HU95003_036_153126 3025.47      34.9356    3
 18HU95003_036_153127 2758.30      34.9442    3
 18HU95003_036_153128 2560.51      34.9469    3
 18HU95003_036_153129 2326.72      34.9448    3
 18HU95003_036_153130 2120.03      34.9136    3
 18HU95003_036_153131 1816.61      34.9426    3
 18HU95003_036_153132 1483.55      34.9696    3
 18HU95003_036_153133 1077.51      35.0494    3
 18HU95003_036_153134  723.32      35.3888    3
 18HU95003_036_153135  583.49      35.8062    3
 18HU95003_036_153136  279.15      36.5486    3
 18HU95003_036_153137  149.54      36.5563    3
 18HU95003_036_153138    6.96      36.5490    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 13, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU95003_036_153138    6.96         233.0363  3
 18HU95003_036_153137  149.54         224.9078  3
 18HU95003_036_153136  279.15         212.9389  3
 18HU95003_036_153135  583.49         198.6030  3
 18HU95003_036_153134  723.32         151.0401  3
 18HU95003_036_153133 1077.51         228.2573  3
 18HU95003_036_153132 1483.55         265.8163  3
 18HU95003_036_153131 1816.61         274.7930  3
 18HU95003_036_153130 2120.03         282.7871  3
 18HU95003_036_153129 2326.72         275.6192  0
 18HU95003_036_153128 2560.51         274.8823  3
 18HU95003_036_153127 2758.30         274.7483  3
 18HU95003_036_153126 3025.47         273.6765  3
 18HU95003_036_153125 3247.30         276.2668  3
 18HU95003_036_153124 3541.35         277.9192  3
 18HU95003_036_153123 3926.28         277.8745  3
 18HU95003_036_153122 4222.53         276.4901  3
 18HU95003_036_153121 4417.67         273.7211  3
 18HU95003_036_153120 4654.93         274.1231  3
 18HU95003_036_153119 4897.86         273.1406  3
 18HU95003_036_153118 5103.20         261.8416  3
 18HU95003_036_153117 5276.89         267.8260  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 14, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_047_153139 5369.42      34.8614    3
 18HU95003_047_153140 5279.01      34.8657    3
 18HU95003_047_153141 5108.99      34.8708    3
 18HU95003_047_153142 4825.06      34.8775    3
 18HU95003_047_153143 4635.81      34.8814    3
 18HU95003_047_153144 4417.11      34.8849    3
 18HU95003_047_153145 4121.33      34.8910    3
 18HU95003_047_153146 3840.04      34.9000    3
 18HU95003_047_153147 3535.31      34.9132    3
 18HU95003_047_153148 3247.37      34.9268    3
 18HU95003_047_153149 2954.96      34.9362    3
 18HU95003_047_153150 2658.73      34.9447    3
 18HU95003_047_153151 2367.60      34.9496    3
 18HU95003_047_153152 2064.93      34.9540    3
 18HU95003_047_153153 1780.82      34.9560    3
 18HU95003_047_153154 1474.74      35.0000    3
 18HU95003_047_153155 1194.10      35.0429    3
 18HU95003_047_153156  889.27      35.2685    3
 18HU95003_047_153157  710.08      35.7713    3
 18HU95003_047_153158  575.03      36.2363    3
 18HU95003_047_153159  297.99      36.5477    3
 18HU95003_047_153160  101.52      36.5499    3
 18HU95003_047_153161   12.67      36.5507    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 14, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU95003_047_153161   12.67         230.7587  3
 18HU95003_047_153160  101.52         228.1684  3
 18HU95003_047_153159  297.99         227.6767  3
 18HU95003_047_153158  575.03         183.5526  3
 18HU95003_047_153157  710.08         167.2964  3
 18HU95003_047_153156  889.27         144.4751  3
 18HU95003_047_153155 1194.10         227.6767  3
 18HU95003_047_153154 1474.74         257.2416  3
 18HU95003_047_153153 1780.82         271.3988  3
 18HU95003_047_153152 2064.93         274.2124  3
 18HU95003_047_153151 2367.60         273.3192  3
 18HU95003_047_153150 2658.73         273.9444  3
 18HU95003_047_153149 2954.96         274.5250  3
 18HU95003_047_153148 3247.37         275.1503  3
 18HU95003_047_153147 3535.31         277.0260  3
 18HU95003_047_153146 3840.04         276.9367  3
 18HU95003_047_153145 4121.33         275.9095  3
 18HU95003_047_153144 4417.11         274.2571  3
 18HU95003_047_153143 4635.81         274.3017  3
 18HU95003_047_153142 4825.06         271.6668  3
 18HU95003_047_153141 5108.99         267.6474  3
 18HU95003_047_153140 5279.01         265.8163  3
 18HU95003_047_153139 5369.42         263.8066  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 15, station CAST#2:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_058_153162 5371.46      34.8619    3
 18HU95003_058_153163 5147.21      34.8715    3
 18HU95003_058_153164 4880.50      34.8749    3
 18HU95003_058_153165 4681.21      34.8779    3
 18HU95003_058_153166 4591.25      34.8795    3
 18HU95003_058_153167 4411.23      34.8828    3
 18HU95003_058_153168 4081.70      34.8905    3
 18HU95003_058_153169 3822.36      34.8982    3
 18HU95003_058_153170 3550.22      34.9095    3
 18HU95003_058_153171 3269.42      34.9227    3
 18HU95003_058_153172 2957.78      34.9371    3
 18HU95003_058_153173 2662.48      34.9486    3
 18HU95003_058_153174 2362.04      34.9573    3
 18HU95003_058_153175 2074.67      34.9494    3
 18HU95003_058_153176 1782.54      34.9689    3
 18HU95003_058_153177 1498.74      35.0298    3
 18HU95003_058_153178 1180.67      35.0816    3
 18HU95003_058_153179  939.12      35.1434    3
 18HU95003_058_153180  767.10      35.3837    3
 18HU95003_058_153181  530.68      36.0281    3
 18HU95003_058_153182  299.63      36.4066    3
 18HU95003_058_153183   99.13      36.5256    3
 18HU95003_058_153184    8.53      36.5455    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 15, station CAST#2:

           sample_key   depth O2_Winkler_Molar qc
 18HU95003_058_153184    8.53         233.7955  3
 18HU95003_058_153183   99.13         231.8305  3
 18HU95003_058_153182  299.63         232.2320  3
 18HU95003_058_153181  530.68         194.0477  3
 18HU95003_058_153180  767.10         162.2944  3
 18HU95003_058_153179  939.12         184.9817  3
 18HU95003_058_153178 1180.67         235.0902  3
 18HU95003_058_153177 1498.74         257.4202  3
 18HU95003_058_153176 1782.54         271.6221  3
 18HU95003_058_153175 2074.67         276.1328  3
 18HU95003_058_153174 2362.04         272.5153  3
 18HU95003_058_153173 2662.48         272.3367  3
 18HU95003_058_153172 2957.78         274.2124  3
 18HU95003_058_153171 3269.42         277.2046  3
 18HU95003_058_153170 3550.22         274.3910  3
 18HU95003_058_153169 3822.36         277.0706  3
 18HU95003_058_153168 4081.70         274.9716  3
 18HU95003_058_153167 4411.23         273.6765  3
 18HU95003_058_153166 4591.25         271.1532  0
 18HU95003_058_153165 4681.21         267.9153  3
 18HU95003_058_153164 4880.50         269.2551  3
 18HU95003_058_153163 5147.21         266.8882  3
 18HU95003_058_153162 5371.46         261.1717  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 16, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_069_153185 5408.05      34.8688    3
 18HU95003_069_153186 5297.24      34.8705    3
 18HU95003_069_153187 4992.77      34.8730    3
 18HU95003_069_153188 4704.21      34.8755    3
 18HU95003_069_153189 4415.82      34.8779    3
 18HU95003_069_153190 4130.36      34.8808    3
 18HU95003_069_153191 3938.85      34.8833    3
 18HU95003_069_153192 3738.27      34.8879    3
 18HU95003_069_153193 3434.13      34.9022    3
 18HU95003_069_153194 3195.35      34.9156    3
 18HU95003_069_153195 2948.74      34.9295    3
 18HU95003_069_153196 2527.88      34.9515    3
 18HU95003_069_153197 2340.25      34.9545    3
 18HU95003_069_153198 1992.86      34.9410    3
 18HU95003_069_153199 1777.17      34.9925    3
 18HU95003_069_153200 1636.31      34.9803    3
 18HU95003_069_153201 1341.66      35.0167    3
 18HU95003_069_153202 1087.14      35.0970    3
 18HU95003_069_153203  989.80      35.0723    3
 18HU95003_069_153204  701.93      35.3936    3
 18HU95003_069_153205  394.15      36.2311    3
 18HU95003_069_153206  194.15      36.4264    3
 18HU95003_069_153207    7.50      36.4911    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 16, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU95003_069_153207    7.50         239.8246  3
 18HU95003_069_153206  194.15         232.5004  3
 18HU95003_069_153205  394.15         191.7700  3
 18HU95003_069_153204  701.93         159.4362  3
 18HU95003_069_153203  989.80         206.1506  3
 18HU95003_069_153202 1087.14         230.5349  3
 18HU95003_069_153201 1341.66         254.8300  3
 18HU95003_069_153200 1636.31         267.9600  3
 18HU95003_069_153199 1777.17         266.9775  3
 18HU95003_069_153198 1992.86         280.9561  3
 18HU95003_069_153197 2340.25         272.5153  3
 18HU95003_069_153196 2527.88         271.4435  3
 18HU95003_069_153195 2948.74         273.5425  0
 18HU95003_069_153194 3195.35         273.6765  3
 18HU95003_069_153193 3434.13         275.5969  3
 18HU95003_069_153192 3738.27         272.8279  3
 18HU95003_069_153191 3938.85         272.3367  3
 18HU95003_069_153190 4130.36         271.9347  3
 18HU95003_069_153189 4415.82         270.3716  3
 18HU95003_069_153188 4704.21         269.2998  3
 18HU95003_069_153187 4992.77         268.3173  3
 18HU95003_069_153186 5297.24         266.7095  3
 18HU95003_069_153185 5408.05         265.8610  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 17, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_080_153208 5393.69      34.8589    3
 18HU95003_080_153209 5196.63      34.8650    3
 18HU95003_080_153210 4900.00      34.8703    3
 18HU95003_080_153211 4614.12      34.8761    3
 18HU95003_080_153212 4327.55      34.8824    3
 18HU95003_080_153213 4026.08      34.8892    3
 18HU95003_080_153214 3744.19      34.8968    3
 18HU95003_080_153215 3455.89      34.9108    3
 18HU95003_080_153216 3145.33      34.9250    3
 18HU95003_080_153217 2850.83      34.9412    3
 18HU95003_080_153218 2568.49      34.9494    3
 18HU95003_080_153219 2288.05      34.9548    3
 18HU95003_080_153220 1977.29      34.9521    3
 18HU95003_080_153221 1682.20      34.9833    3
 18HU95003_080_153222 1397.89      35.1296    3
 18HU95003_080_153223 1200.53      35.2244    3
 18HU95003_080_153224 1008.13      35.1376    3
 18HU95003_080_153225  817.12      35.3426    3
 18HU95003_080_153226  693.69      35.6148    3
 18HU95003_080_153227  611.01      35.8608    3
 18HU95003_080_153228  410.88      36.3273    3
 18HU95003_080_153229  197.79      36.4450    3
 18HU95003_080_153230    7.24      36.4265    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 17, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU95003_080_153230    7.24         237.5916  3
 18HU95003_080_153229  197.79         227.9446  3
 18HU95003_080_153228  410.88         197.6205  3
 18HU95003_080_153227  611.01         196.1467  3
 18HU95003_080_153226  693.69         189.0904  3
 18HU95003_080_153225  817.12         178.0148  3
 18HU95003_080_153224 1008.13         192.6186  3
 18HU95003_080_153223 1200.53         212.4476  3
 18HU95003_080_153222 1397.89         208.3836  3
 18HU95003_080_153221 1682.20         267.6920  3
 18HU95003_080_153220 1977.29         271.8008  3
 18HU95003_080_153218 2568.49         272.9173  3
 18HU95003_080_153217 2850.83         271.5328  3
 18HU95003_080_153216 3145.33         273.8998  3
 18HU95003_080_153215 3455.89         275.8202  3
 18HU95003_080_153214 3744.19         275.7755  3
 18HU95003_080_153213 4026.08         274.3910  3
 18HU95003_080_153212 4327.55         272.7386  3
 18HU95003_080_153211 4614.12         269.5678  3
 18HU95003_080_153210 4900.00         267.5134  3
 18HU95003_080_153209 5196.63         264.1192  0
 18HU95003_080_153208 5393.69         261.9309  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 18, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_091_153231 5348.19      34.8632    3
 18HU95003_091_153232 5251.44      34.8633    3
 18HU95003_091_153233 5001.17      34.8655    3
 18HU95003_091_153234 4707.86      34.8734    3
 18HU95003_091_153235 4417.10      34.8816    3
 18HU95003_091_153236 4125.16      34.8910    3
 18HU95003_091_153237 3884.93      34.9001    3
 18HU95003_091_153238 3640.60      34.9110    3
 18HU95003_091_153239 3347.80      34.9245    3
 18HU95003_091_153240 2948.54      34.9441    3
 18HU95003_091_153241 2661.48      34.9512    3
 18HU95003_091_153242 2464.78      34.9530    3
 18HU95003_091_153243 2124.07      34.9407    3
 18HU95003_091_153244 1979.03      34.9455    3
 18HU95003_091_153245 1784.67      34.9642    3
 18HU95003_091_153246 1391.76      35.0288    3
 18HU95003_091_153247 1243.63      35.2281    3
 18HU95003_091_153248  891.29      35.2572    3
 18HU95003_091_153249  709.22      35.8192    3
 18HU95003_091_153250  572.78      36.1863    3
 18HU95003_091_153251  316.29      36.4994    3
 18HU95003_091_153252  145.30      36.5033    3
 18HU95003_091_153253    6.21      36.4757    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 18, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU95003_091_153253    6.21         247.6397  3
 18HU95003_091_153252  145.30         229.5529  3
 18HU95003_091_153251  316.29         229.5082  3
 18HU95003_091_153250  572.78         209.3661  3
 18HU95003_091_153249  709.22         202.1312  3
 18HU95003_091_153248  891.29         154.4343  3
 18HU95003_091_153247 1243.63         220.7544  3
 18HU95003_091_153246 1391.76         246.2999  3
 18HU95003_091_153245 1784.67         270.0590  3
 18HU95003_091_153244 1979.03         273.6765  3
 18HU95003_091_153243 2124.07         278.1871  3
 18HU95003_091_153242 2464.78         273.4085  3
 18HU95003_091_153241 2661.48         272.6940  3
 18HU95003_091_153240 2948.54         271.8901  3
 18HU95003_091_153239 3347.80         273.7211  3
 18HU95003_091_153238 3640.60         274.3910  3
 18HU95003_091_153237 3884.93         275.2396  3
 18HU95003_091_153236 4125.16         271.8454  3
 18HU95003_091_153235 4417.10         271.5775  3
 18HU95003_091_153234 4707.86         268.3173  3
 18HU95003_091_153233 5001.17         261.8862  3
 18HU95003_091_153232 5251.44         263.8066  3
 18HU95003_091_153231 5348.19         264.0969  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 19, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_102_153254 5321.77      34.8638    3
 18HU95003_102_153255 5136.00      34.8703    3
 18HU95003_102_153256 4897.19      34.8761    3
 18HU95003_102_153257 4592.08      34.8817    3
 18HU95003_102_153258 4318.35      34.8875    3
 18HU95003_102_153259 4028.75      34.8946    3
 18HU95003_102_153260 3733.32      34.9057    3
 18HU95003_102_153261 3437.96      34.9207    3
 18HU95003_102_153262 3147.78      34.9352    3
 18HU95003_102_153263 2847.46      34.9497    3
 18HU95003_102_153264 2568.25      34.9522    3
 18HU95003_102_153265 2269.94      34.9415    3
 18HU95003_102_153266 1969.15      34.9383    3
 18HU95003_102_153267 1680.42      34.9701    3
 18HU95003_102_153268 1375.97      35.0155    3
 18HU95003_102_153269 1191.21      35.1532    3
 18HU95003_102_153270  992.75      35.2530    3
 18HU95003_102_153271  892.63      35.3039    3
 18HU95003_102_153272  793.96      35.4603    3
 18HU95003_102_153273  593.38      36.0893    3
 18HU95003_102_153274  391.47      36.3351    3
 18HU95003_102_153275  189.70      36.4440    3
 18HU95003_102_153276   96.93      36.4477    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 19, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU95003_102_153276   96.93         231.9645  3
 18HU95003_102_153275  189.70         230.2674  3
 18HU95003_102_153274  391.47         202.8457  3
 18HU95003_102_153273  593.38         207.8476  3
 18HU95003_102_153272  793.96         179.8012  3
 18HU95003_102_153271  892.63         179.6225  3
 18HU95003_102_153270  992.75         184.5351  3
 18HU95003_102_153269 1191.21         215.6185  0
 18HU95003_102_153268 1375.97         245.1834  3
 18HU95003_102_153267 1680.42         270.0144  3
 18HU95003_102_153266 1969.15         277.1600  3
 18HU95003_102_153265 2269.94         277.2493  3
 18HU95003_102_153264 2568.25         273.5425  3
 18HU95003_102_153263 2847.46         271.7561  3
 18HU95003_102_153262 3147.78         272.0687  3
 18HU95003_102_153261 3437.96         269.5231  3
 18HU95003_102_153260 3733.32         274.9270  3
 18HU95003_102_153259 4028.75         274.2124  3
 18HU95003_102_153258 4318.35         273.5425  3
 18HU95003_102_153257 4592.08         272.4260  3
 18HU95003_102_153256 4897.19         269.9250  3
 18HU95003_102_153255 5136.00         267.3794  3
 18HU95003_102_153254 5321.77         263.6726  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 2, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_113_152925  515.84      35.0047    3
 18HU95003_113_152926  526.32      35.0076    3
 18HU95003_113_152927  530.58      35.0010    3
 18HU95003_113_152928  533.13      34.9974    3
 18HU95003_113_152929  534.13      34.9973    3
 18HU95003_113_152930  533.53      34.9972    3
 18HU95003_113_152931  533.34      34.9993    3
 18HU95003_113_152932  531.54      35.0004    3
 18HU95003_113_152933  530.49      35.0026    3
 18HU95003_113_152934  529.98      35.0067    3
 18HU95003_113_152935  529.28      35.0068    3
 18HU95003_113_152936  529.45      35.0058    3
 18HU95003_113_152937  529.82      35.0049    3
 18HU95003_113_152938  530.68      35.0051    3
 18HU95003_113_152939  532.15      35.0043    3
 18HU95003_113_152940  532.68      35.0019    3
 18HU95003_113_152941  532.64      35.0021    3
 18HU95003_113_152942  533.22      35.0010    3
 18HU95003_113_152943  532.87      34.9996    3
 18HU95003_113_152944  532.84      35.0005    3
 18HU95003_113_152945  532.81      35.0008    3
 18HU95003_113_152946  533.61      34.9992    3
 18HU95003_113_152947  533.75      34.9956    3
 18HU95003_113_152948  533.83      34.9950    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 2, station CAST#1:

           sample_key  depth O2_Winkler_Molar qc
 18HU95003_113_152925 515.84         194.0030  3
 18HU95003_113_152926 526.32         194.6283  3
 18HU95003_113_152935 529.28         199.1836  3
 18HU95003_113_152936 529.45         199.3622  3
 18HU95003_113_152937 529.82         202.1758  3
 18HU95003_113_152934 529.98         200.6127  3
 18HU95003_113_152933 530.49         200.5234  3
 18HU95003_113_152938 530.68         201.1040  3
 18HU95003_113_152932 531.54         204.8554  3
 18HU95003_113_152939 532.15         200.2108  3
 18HU95003_113_152941 532.64         200.1661  3
 18HU95003_113_152940 532.68         200.3448  3
 18HU95003_113_152945 532.81         200.6127  3
 18HU95003_113_152944 532.84         201.8632  3
 18HU95003_113_152943 532.87         200.9700  3
 18HU95003_113_152928 533.13         199.4516  3
 18HU95003_113_152942 533.22         200.7020  3
 18HU95003_113_152931 533.34         201.7292  3
 18HU95003_113_152930 533.53         201.5506  3
 18HU95003_113_152946 533.61         200.1661  3
 18HU95003_113_152947 533.75         201.0147  3
 18HU95003_113_152948 533.83         200.9253  3
 18HU95003_113_152929 534.13         200.3448  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 3, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_225_152949   67.85      33.0323    3
 18HU95003_225_152950   67.85      33.0323    3
 18HU95003_225_152951   42.81      32.9454    3
 18HU95003_225_152952   13.75      32.8939    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 3, station CAST#1:

           sample_key depth O2_Winkler_Molar qc
 18HU95003_225_152952 13.75         391.6682  3
 18HU95003_225_152951 42.81         369.7848  3
 18HU95003_225_152950 67.85         364.0237  3
 18HU95003_225_152949 67.85         362.6839  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 4, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_264_152953 1020.31      34.8677    3
 18HU95003_264_152954  798.56      34.8645    3
 18HU95003_264_152955  590.83      34.8537    3
 18HU95003_264_152956  399.34      34.7617    3
 18HU95003_264_152957  207.44      34.8114    3
 18HU95003_264_152958   40.26      32.9186    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 4, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU95003_264_152958   40.26         386.3090  3
 18HU95003_264_152957  207.44         207.0438  3
 18HU95003_264_152956  399.34         257.9115  3
 18HU95003_264_152955  590.83         288.8609  3
 18HU95003_264_152954  798.56         291.7638  3
 18HU95003_264_152953 1020.31         292.4337  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 45, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_279_153714 2050.26      34.8669    3
 18HU95003_279_153715 1924.15      34.8661    3
 18HU95003_279_153716 1771.65      34.8653    3
 18HU95003_279_153717 1648.27      34.8643    3
 18HU95003_279_153718 1577.42      34.8609    3
 18HU95003_279_153719 1487.51      34.8712    3
 18HU95003_279_153720 1384.74      34.8628    3
 18HU95003_279_153721 1275.24      34.8756    3
 18HU95003_279_153722 1215.76      34.8760    3
 18HU95003_279_153723  995.35      34.8750    3
 18HU95003_279_153724  945.90      34.8872    3
 18HU95003_279_153725  813.33      34.8682    3
 18HU95003_279_153726  599.78      34.9143    3
 18HU95003_279_153727  515.37      34.9147    3
 18HU95003_279_153728  413.02      34.9126    3
 18HU95003_279_153729  402.38      34.9120    3
 18HU95003_279_153730  260.72      34.6170    3
 18HU95003_279_153731  161.93      34.3753    3
 18HU95003_279_153732   68.70      33.6796    3
 18HU95003_279_153733    6.43      33.5396    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 45, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU95003_279_153733    6.43         343.1228  3
 18HU95003_279_153732   68.70         330.4840  3
 18HU95003_279_153730  260.72         302.7501  3
 18HU95003_279_153729  402.38         279.1697  3
 18HU95003_279_153728  413.02         263.8959  3
 18HU95003_279_153727  515.37         275.7532  0
 18HU95003_279_153726  599.78         278.6784  3
 18HU95003_279_153725  813.33         293.5502  3
 18HU95003_279_153724  945.90         289.2628  3
 18HU95003_279_153723  995.35         292.2997  3
 18HU95003_279_153722 1215.76         293.9075  3
 18HU95003_279_153721 1275.24         292.1657  3
 18HU95003_279_153720 1384.74         296.8104  3
 18HU95003_279_153719 1487.51         294.5327  3
 18HU95003_279_153718 1577.42         295.4706  3
 18HU95003_279_153717 1648.27         289.2182  2
 18HU95003_279_153716 1771.65         296.8550  3
 18HU95003_279_153715 1924.15         297.7929  3
 18HU95003_279_153714 2050.26         296.2744  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 46, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_280_153734  982.03      34.8577    3
 18HU95003_280_153735  905.71      34.8568    3
 18HU95003_280_153736  776.74      34.8542    3
 18HU95003_280_153737  670.40      34.8554    3
 18HU95003_280_153738  601.17      34.8530    3
 18HU95003_280_153739  498.12      34.8257    3
 18HU95003_280_153740  390.56      34.6815    3
 18HU95003_280_153741  307.10      34.4956    3
 18HU95003_280_153742  232.64      34.2508    3
 18HU95003_280_153743  126.90      33.6646    3
 18HU95003_280_153744   54.72      33.0264    3
 18HU95003_280_153745    6.59      32.8951    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 46, station CAST#1:

           sample_key  depth O2_Winkler_Molar qc
 18HU95003_280_153745   6.59         420.9652  3
 18HU95003_280_153744  54.72         370.3207  2
 18HU95003_280_153743 126.90         334.2354  3
 18HU95003_280_153742 232.64         309.5831  3
 18HU95003_280_153741 307.10         304.4919  3
 18HU95003_280_153740 390.56         292.6123  3
 18HU95003_280_153739 498.12         290.0667  3
 18HU95003_280_153738 601.17         293.7288  3
 18HU95003_280_153737 670.40         293.6842  0
 18HU95003_280_153736 776.74         296.6764  3
 18HU95003_280_153735 905.71         296.2298  3
 18HU95003_280_153734 982.03         296.7210  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 47, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_281_153746 1035.52      34.8554    3
 18HU95003_281_153747  945.28      34.8537    3
 18HU95003_281_153748  678.16      34.8381    3
 18HU95003_281_153749  499.10      34.8102    3
 18HU95003_281_153750  302.31      34.5561    3
 18HU95003_281_153751  193.23      33.6464    3
 18HU95003_281_153752   83.34      33.0448    3
 18HU95003_281_153753    4.42      32.8481    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 47, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU95003_281_153753    4.42         412.7031  3
 18HU95003_281_153752   83.34         305.7870  3
 18HU95003_281_153751  193.23         327.4918  3
 18HU95003_281_153750  302.31         283.8813  0
 18HU95003_281_153749  499.10         290.9599  3
 18HU95003_281_153748  678.16         294.3541  3
 18HU95003_281_153747  945.28         294.6667  3
 18HU95003_281_153746 1035.52         294.9793  3


-> QC repot:
      Filename Pressure Uniqueno Variable     Values                          Test.failed
 18HU95003_047  5210.71   153141     pres  5210.71    Regional Impossible Parameter Value
 18HU95003_047  5386.21   153140     pres  5386.21    Regional Impossible Parameter Value
 18HU95003_047  5479.59   153139     pres  5479.59    Regional Impossible Parameter Value



-> Flagged SALINITY, event 48, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_282_153754  490.66      34.7514    3
 18HU95003_282_153755  490.66      34.7514    3
 18HU95003_282_153756  412.50      34.6591    3
 18HU95003_282_153757  325.96      34.4242    3
 18HU95003_282_153758  207.72      33.8368    3
 18HU95003_282_153759   91.37      33.1438    3
 18HU95003_282_153760   14.88      32.8617    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 48, station CAST#1:

           sample_key  depth O2_Winkler_Molar qc
 18HU95003_282_153760  14.88         329.1889  3
 18HU95003_282_153759  91.37         345.8024  0
 18HU95003_282_153758 207.72         324.1869  3
 18HU95003_282_153757 325.96         271.8454  3
 18HU95003_282_153756 412.50         298.9987  3
 18HU95003_282_153755 490.66         296.4531  3
 18HU95003_282_153754 490.66         296.6317  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 49, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_283_153761  164.04      33.7847    3
 18HU95003_283_153762  114.18      33.3594    3
 18HU95003_283_153763   72.80      33.0333    3
 18HU95003_283_153764   13.77      32.8553    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 49, station CAST#1:

           sample_key  depth O2_Winkler_Molar qc
 18HU95003_283_153764  13.77         379.7663  0
 18HU95003_283_153763  72.80         365.4081  3
 18HU95003_283_153761 164.04         318.6938  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 5, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_284_152959 2307.38      34.9212    3
 18HU95003_284_152960 2197.78      34.9167    3
 18HU95003_284_152961 1964.23      34.8990    3
 18HU95003_284_152962 1785.65      34.8737    3
 18HU95003_284_152963 1579.63      34.8653    3
 18HU95003_284_152964 1379.00      34.8625    3
 18HU95003_284_152965 1184.08      34.8697    3
 18HU95003_284_152966  980.05      34.8894    3
 18HU95003_284_152967  790.49      34.8921    3
 18HU95003_284_152968  591.33      34.8484    3
 18HU95003_284_152969  393.33      34.6194    3
 18HU95003_284_152970  294.32      34.1169    3
 18HU95003_284_152971  193.15      33.5745    3
 18HU95003_284_152972   98.29      33.2339    3
 18HU95003_284_152973   51.35      32.9848    3
 18HU95003_284_152974   12.28      32.7713    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 5, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU95003_284_152974   12.28         411.7652  3
 18HU95003_284_152973   51.35         370.5440  3
 18HU95003_284_152972   98.29         362.3712  3
 18HU95003_284_152971  193.15         330.2160  3
 18HU95003_284_152970  294.32         308.6006  3
 18HU95003_284_152969  393.33         276.6240  3
 18HU95003_284_152968  591.33         282.2512  3
 18HU95003_284_152967  790.49         287.0745  3
 18HU95003_284_152966  980.05         288.6822  3
 18HU95003_284_152965 1184.08         294.2201  3
 18HU95003_284_152964 1379.00         297.3909  3
 18HU95003_284_152963 1579.63         296.8997  3
 18HU95003_284_152962 1785.65         295.6939  3
 18HU95003_284_152961 1964.23         289.1288  3
 18HU95003_284_152960 2197.78         284.4172  0
 18HU95003_284_152959 2307.38         303.2414  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 5, station CAST#1:

           sample_key   depth    value   method qc
 18HU95003_284_152974   12.28  0.40151 NO2NO3_0  1
 18HU95003_284_152973   51.35  6.24947 NO2NO3_0  1
 18HU95003_284_152972   98.29  5.46548 NO2NO3_0  7
 18HU95003_284_152971  193.15 10.38802 NO2NO3_0  1
 18HU95003_284_152970  294.32 11.90702 NO2NO3_0  1
 18HU95003_284_152969  393.33 17.03899 NO2NO3_0  1
 18HU95003_284_152968  591.33 17.48705 NO2NO3_0  7
 18HU95003_284_152967  790.49 17.34748 NO2NO3_0  1
 18HU95003_284_152966  980.05 17.64650 NO2NO3_0  1
 18HU95003_284_152965 1184.08 17.27805 NO2NO3_0  1
 18HU95003_284_152964 1379.00 17.21856 NO2NO3_0  7
 18HU95003_284_152963 1579.63 16.95854 NO2NO3_0  1
 18HU95003_284_152962 1785.65 17.38797 NO2NO3_0  1
 18HU95003_284_152961 1964.23 17.22806 NO2NO3_0  1
 18HU95003_284_152960 2197.78 17.38802 NO2NO3_0  1
 18HU95003_284_152959 2307.38  8.03351 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 5, station CAST#1:

           sample_key   depth   value method qc
 18HU95003_284_152974   12.28 0.57604  PO4_0  1
 18HU95003_284_152973   51.35 0.88203  PO4_0  7
 18HU95003_284_152972   98.29 0.85750  PO4_0  1
 18HU95003_284_152971  193.15 1.00345  PO4_0  1
 18HU95003_284_152970  294.32 1.03001  PO4_0  1
 18HU95003_284_152969  393.33 1.20046  PO4_0  7
 18HU95003_284_152968  591.33 1.20200  PO4_0  1
 18HU95003_284_152967  790.49 1.17752  PO4_0  1
 18HU95003_284_152966  980.05 1.17054  PO4_0  1
 18HU95003_284_152965 1184.08 1.17350  PO4_0  7
 18HU95003_284_152964 1379.00 1.19154  PO4_0  1
 18HU95003_284_152963 1579.63 1.16754  PO4_0  1
 18HU95003_284_152962 1785.65 1.18304  PO4_0  1
 18HU95003_284_152961 1964.23 1.19199  PO4_0  7
 18HU95003_284_152960 2197.78 1.15948  PO4_0  1
 18HU95003_284_152959 2307.38 0.86905  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 5, station CAST#1:

           sample_key   depth    value method qc
 18HU95003_284_152974   12.28  2.72155 SiO4_0  7
 18HU95003_284_152973   51.35  6.67901 SiO4_0  1
 18HU95003_284_152972   98.29  5.51405 SiO4_0  1
 18HU95003_284_152971  193.15 10.35399 SiO4_0  1
 18HU95003_284_152970  294.32 10.79448 SiO4_0  7
 18HU95003_284_152969  393.33 11.78249 SiO4_0  1
 18HU95003_284_152968  591.33 10.97050 SiO4_0  1
 18HU95003_284_152967  790.49 10.63447 SiO4_0  1
 18HU95003_284_152966  980.05 10.82855 SiO4_0  1
 18HU95003_284_152965 1184.08 11.04003 SiO4_0  1
 18HU95003_284_152964 1379.00 11.02150 SiO4_0  1
 18HU95003_284_152963 1579.63 10.95053 SiO4_0  1
 18HU95003_284_152962 1785.65 11.40897 SiO4_0  7
 18HU95003_284_152961 1964.23 12.46801 SiO4_0  1
 18HU95003_284_152960 2197.78 13.74102 SiO4_0  1
 18HU95003_284_152959 2307.38  7.63956 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 51, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_295_153765 3283.05      34.8916    3
 18HU95003_295_153766 3183.42      34.8955    3
 18HU95003_295_153767 3097.74      34.8985    3
 18HU95003_295_153768 2958.02      34.9071    3
 18HU95003_295_153769 2760.75      34.9148    3
 18HU95003_295_153770 2613.46      34.9168    3
 18HU95003_295_153771 2464.02      34.9191    3
 18HU95003_295_153772 2318.20      34.9143    3
 18HU95003_295_153773 2141.54      34.9086    3
 18HU95003_295_153774 1953.03      34.8914    3
 18HU95003_295_153775 1877.12      34.8855    3
 18HU95003_295_153776 1780.64      34.8685    3
 18HU95003_295_153777 1581.20      34.8706    3
 18HU95003_295_153778 1480.81      34.8671    3
 18HU95003_295_153779 1236.01      34.8809    3
 18HU95003_295_153780 1086.86      34.8804    3
 18HU95003_295_153781  982.95      34.9026    3
 18HU95003_295_153782  695.26      34.8530    3
 18HU95003_295_153783  494.64      34.7850    3
 18HU95003_295_153784  294.41      34.8135    3
 18HU95003_295_153785  193.07      34.8266    3
 18HU95003_295_153786   98.89      34.9197    3
 18HU95003_295_153787   17.82      34.8811    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 51, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU95003_295_153787   17.82         276.3114  3
 18HU95003_295_153786   98.89         227.7213  3
 18HU95003_295_153785  193.07         198.1564  3
 18HU95003_295_153784  294.41         210.0806  3
 18HU95003_295_153783  494.64         281.4920  3
 18HU95003_295_153782  695.26         292.4783  3
 18HU95003_295_153781  982.95         283.6357  3
 18HU95003_295_153780 1086.86         289.9327  3
 18HU95003_295_153779 1236.01         287.0298  2
 18HU95003_295_153778 1480.81         293.6395  3
 18HU95003_295_153777 1581.20         293.9521  3
 18HU95003_295_153776 1780.64         295.5152  3
 18HU95003_295_153775 1877.12         291.0492  3
 18HU95003_295_153774 1953.03         289.8881  3
 18HU95003_295_153773 2141.54         285.5114  3
 18HU95003_295_153772 2318.20         283.8143  3
 18HU95003_295_153771 2464.02         281.2687  0
 18HU95003_295_153770 2613.46         283.1444  3
 18HU95003_295_153769 2760.75         283.2337  3
 18HU95003_295_153768 2958.02         270.9969  3
 18HU95003_295_153767 3097.74         287.3871  3
 18HU95003_295_153766 3183.42         287.5211  3
 18HU95003_295_153765 3283.05         287.6551  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 51, station CAST#1:

           sample_key   depth    value   method qc
 18HU95003_295_153787   17.82  4.42196 NO2NO3_0  1
 18HU95003_295_153786   98.89 11.72349 NO2NO3_0  1
 18HU95003_295_153785  193.07 18.74649 NO2NO3_0  1
 18HU95003_295_153784  294.41 19.73254 NO2NO3_0  1
 18HU95003_295_153783  494.64 17.12400 NO2NO3_0  1
 18HU95003_295_153782  695.26 17.21700 NO2NO3_0  1
 18HU95003_295_153781  982.95 17.48653 NO2NO3_0  1
 18HU95003_295_153780 1086.86 17.42202 NO2NO3_0  7
 18HU95003_295_153779 1236.01 17.29399 NO2NO3_0  1
 18HU95003_295_153778 1480.81 17.39753 NO2NO3_0  7
 18HU95003_295_153777 1581.20 17.03801 NO2NO3_0  1
 18HU95003_295_153776 1780.64 17.24100 NO2NO3_0  1
 18HU95003_295_153775 1877.12 17.11298 NO2NO3_0  1
 18HU95003_295_153774 1953.03 17.12855 NO2NO3_0  7
 18HU95003_295_153773 2141.54 17.07748 NO2NO3_0  1
 18HU95003_295_153772 2318.20 17.03600 NO2NO3_0  1
 18HU95003_295_153771 2464.02 17.34855 NO2NO3_0  1
 18HU95003_295_153770 2613.46 16.89097 NO2NO3_0  7
 18HU95003_295_153769 2760.75 17.26848 NO2NO3_0  1
 18HU95003_295_153768 2958.02 10.44798 NO2NO3_0  1
 18HU95003_295_153767 3097.74 16.83852 NO2NO3_0  1
 18HU95003_295_153766 3183.42 16.61299 NO2NO3_0  1
 18HU95003_295_153765 3283.05 16.58452 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 51, station CAST#1:

           sample_key   depth   value method qc
 18HU95003_295_153787   17.82 0.49550  PO4_0  1
 18HU95003_295_153786   98.89 0.91255  PO4_0  1
 18HU95003_295_153785  193.07 1.31646  PO4_0  1
 18HU95003_295_153784  294.41 1.37851  PO4_0  1
 18HU95003_295_153783  494.64 1.17599  PO4_0  1
 18HU95003_295_153782  695.26 1.17902  PO4_0  1
 18HU95003_295_153781  982.95 1.18799  PO4_0  7
 18HU95003_295_153780 1086.86 1.18653  PO4_0  1
 18HU95003_295_153779 1236.01 1.18048  PO4_0  7
 18HU95003_295_153778 1480.81 1.16549  PO4_0  1
 18HU95003_295_153777 1581.20 1.15852  PO4_0  1
 18HU95003_295_153776 1780.64 1.15954  PO4_0  1
 18HU95003_295_153775 1877.12 1.18254  PO4_0  7
 18HU95003_295_153774 1953.03 1.16049  PO4_0  1
 18HU95003_295_153773 2141.54 1.19805  PO4_0  1
 18HU95003_295_153772 2318.20 1.17702  PO4_0  1
 18HU95003_295_153771 2464.02 1.15948  PO4_0  7
 18HU95003_295_153770 2613.46 1.12696  PO4_0  1
 18HU95003_295_153769 2760.75 1.14748  PO4_0  1
 18HU95003_295_153768 2958.02 0.79251  PO4_0  1
 18HU95003_295_153767 3097.74 1.12797  PO4_0  7
 18HU95003_295_153766 3183.42 1.11648  PO4_0  1
 18HU95003_295_153765 3283.05 1.14551  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 51, station CAST#1:

           sample_key   depth    value method qc
 18HU95003_295_153787   17.82  2.58799 SiO4_0  1
 18HU95003_295_153786   98.89  6.46796 SiO4_0  1
 18HU95003_295_153785  193.07 11.83100 SiO4_0  1
 18HU95003_295_153784  294.41 13.00402 SiO4_0  1
 18HU95003_295_153783  494.64 10.84555 SiO4_0  1
 18HU95003_295_153782  695.26 10.54348 SiO4_0  1
 18HU95003_295_153781  982.95 11.43896 SiO4_0  1
 18HU95003_295_153780 1086.86 11.31403 SiO4_0  7
 18HU95003_295_153779 1236.01 11.42852 SiO4_0  1
 18HU95003_295_153778 1480.81 11.50801 SiO4_0  1
 18HU95003_295_153777 1581.20 11.62355 SiO4_0  1
 18HU95003_295_153776 1780.64 11.77249 SiO4_0  7
 18HU95003_295_153775 1877.12 12.21705 SiO4_0  1
 18HU95003_295_153774 1953.03 12.50600 SiO4_0  1
 18HU95003_295_153773 2141.54 13.59403 SiO4_0  1
 18HU95003_295_153772 2318.20 13.85251 SiO4_0  7
 18HU95003_295_153771 2464.02 15.18604 SiO4_0  1
 18HU95003_295_153770 2613.46 14.95354 SiO4_0  1
 18HU95003_295_153769 2760.75 15.79999 SiO4_0  1
 18HU95003_295_153768 2958.02  6.87549 SiO4_0  7
 18HU95003_295_153767 3097.74 17.12905 SiO4_0  1
 18HU95003_295_153766 3183.42 17.54050 SiO4_0  1
 18HU95003_295_153765 3283.05 18.09248 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 6, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_304_152975 3045.79      34.9014    3
 18HU95003_304_152976 2961.22      34.9030    3
 18HU95003_304_152977 2858.29      34.9085    3
 18HU95003_304_152978 2666.18      34.9187    3
 18HU95003_304_152979 2462.68      34.9316    3
 18HU95003_304_152980 2257.77      34.9245    3
 18HU95003_304_152981 2015.88      34.9383    3
 18HU95003_304_152982 1772.72      34.9221    3
 18HU95003_304_152983 1622.58      34.9020    3
 18HU95003_304_152984 1470.61      34.9000    3
 18HU95003_304_152985 1273.99      34.9188    3
 18HU95003_304_152986 1204.01      34.9317    3
 18HU95003_304_152987 1103.48      34.8942    3
 18HU95003_304_152988  981.95      34.9353    3
 18HU95003_304_152989  886.61      34.9203    3
 18HU95003_304_152990  786.92      34.9407    3
 18HU95003_304_152991  690.81      34.9286    3
 18HU95003_304_152992  595.52      34.8706    3
 18HU95003_304_152993  500.25      34.8773    3
 18HU95003_304_152994  384.85      34.6423    3
 18HU95003_304_152995  274.67      34.7755    3
 18HU95003_304_152996  145.72      33.8564    3
 18HU95003_304_152997    9.57      33.1743    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 6, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU95003_304_152997    9.57         389.7478  3
 18HU95003_304_152996  145.72         286.5832  3
 18HU95003_304_152995  274.67         234.3310  3
 18HU95003_304_152994  384.85         293.6395  3
 18HU95003_304_152993  500.25         268.2280  3
 18HU95003_304_152992  595.52         282.5638  3
 18HU95003_304_152991  690.81         274.7483  3
 18HU95003_304_152990  786.92         273.5872  0
 18HU95003_304_152989  886.61         281.5813  3
 18HU95003_304_152988  981.95         278.0085  3
 18HU95003_304_152987 1103.48         288.9502  3
 18HU95003_304_152986 1204.01         279.7502  3
 18HU95003_304_152985 1273.99         283.6803  3
 18HU95003_304_152984 1470.61         288.2803  3
 18HU95003_304_152983 1622.58         288.1463  3
 18HU95003_304_152982 1772.72         283.1444  3
 18HU95003_304_152981 2015.88         278.9017  3
 18HU95003_304_152980 2257.77         282.7425  3
 18HU95003_304_152979 2462.68         279.2590  3
 18HU95003_304_152978 2666.18         281.0900  3
 18HU95003_304_152977 2858.29         284.4395  3
 18HU95003_304_152976 2961.22         284.2162  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 7, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_315_152998 3514.72      34.8892    3
 18HU95003_315_152999 3434.44      34.8915    3
 18HU95003_315_153000 3162.65      34.8975    3
 18HU95003_315_153001 2957.59      34.9037    3
 18HU95003_315_153002 2761.05      34.9122    3
 18HU95003_315_153003 2557.79      34.9200    3
 18HU95003_315_153004 2431.74      34.9283    3
 18HU95003_315_153005 2223.87      34.9396    3
 18HU95003_315_153006 2107.38      34.9394    3
 18HU95003_315_153007 1863.53      34.9150    3
 18HU95003_315_153008 1616.11      34.9027    3
 18HU95003_315_153009 1406.45      34.8799    3
 18HU95003_315_153010 1235.27      34.8951    3
 18HU95003_315_153011 1040.61      34.8832    3
 18HU95003_315_153012  918.80      34.8760    3
 18HU95003_315_153013  807.81      34.9408    3
 18HU95003_315_153014  697.96      34.9538    3
 18HU95003_315_153015  594.13      34.9319    3
 18HU95003_315_153016  494.11      34.9732    3
 18HU95003_315_153017  403.27      34.9271    3
 18HU95003_315_153018  298.79      34.5189    3
 18HU95003_315_153019  199.90      34.1493    3
 18HU95003_315_153020  101.48      33.6448    3
 18HU95003_315_153021    9.12      33.0938    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 7, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU95003_315_153021    9.12         416.3205  3
 18HU95003_315_153020  101.48         335.9772  3
 18HU95003_315_153019  199.90         294.6220  3
 18HU95003_315_153018  298.79         296.1851  3
 18HU95003_315_153017  403.27         240.3155  3
 18HU95003_315_153016  494.11         248.2203  3
 18HU95003_315_153015  594.13         262.4222  3
 18HU95003_315_153014  697.96         264.9231  3
 18HU95003_315_153013  807.81         271.6221  3
 18HU95003_315_153012  918.80         289.1735  3
 18HU95003_315_153011 1040.61         289.2182  3
 18HU95003_315_153010 1235.27         286.8512  3
 18HU95003_315_153009 1406.45         290.3793  3
 18HU95003_315_153008 1616.11         285.0648  3
 18HU95003_315_153004 2431.74         179.8905  3
 18HU95003_315_153003 2557.79         280.1968  3
 18HU95003_315_153002 2761.05         282.6755  0
 18HU95003_315_153001 2957.59         283.6803  3
 18HU95003_315_153000 3162.65         283.9036  3
 18HU95003_315_152999 3434.44         283.0551  3
 18HU95003_315_152998 3514.72         282.3405  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 8, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_326_153022 3899.81      34.8872    3
 18HU95003_326_153023 3837.55      34.8887    3
 18HU95003_326_153024 3737.62      34.8910    3
 18HU95003_326_153025 3533.93      34.8949    3
 18HU95003_326_153026 3340.44      34.8998    3
 18HU95003_326_153027 3128.87      34.9064    3
 18HU95003_326_153028 2910.08      34.9132    3
 18HU95003_326_153029 2674.79      34.9208    3
 18HU95003_326_153030 2473.09      34.9303    3
 18HU95003_326_153031 2263.60      34.9150    3
 18HU95003_326_153032 2065.58      34.8951    3
 18HU95003_326_153033 1871.56      34.8982    3
 18HU95003_326_153034 1671.38      34.8929    3
 18HU95003_326_153035 1479.76      34.8967    3
 18HU95003_326_153036 1278.40      34.9216    3
 18HU95003_326_153037 1076.33      34.9026    3
 18HU95003_326_153038  968.65      34.8688    3
 18HU95003_326_153039  896.47      34.9373    3
 18HU95003_326_153040  795.91      34.9692    3
 18HU95003_326_153041  614.57      34.9779    3
 18HU95003_326_153042  397.36      34.8805    3
 18HU95003_326_153043  199.58      34.8589    3
 18HU95003_326_153044   99.83      34.3484    3
 18HU95003_326_153045    8.47      33.1472    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 8, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU95003_326_153045    8.47         395.8216  3
 18HU95003_326_153044   99.83         249.0242  3
 18HU95003_326_153043  199.58         186.0089  3
 18HU95003_326_153042  397.36         238.6630  3
 18HU95003_326_153041  614.57         253.7581  3
 18HU95003_326_153040  795.91         263.8513  3
 18HU95003_326_153038  968.65         290.5133  3
 18HU95003_326_153037 1076.33         284.0823  3
 18HU95003_326_153036 1278.40         281.3580  3
 18HU95003_326_153035 1479.76         287.1191  3
 18HU95003_326_153034 1671.38         288.5929  3
 18HU95003_326_153033 1871.56         287.8337  3
 18HU95003_326_153032 2065.58         288.6376  3
 18HU95003_326_153031 2263.60         284.9755  3
 18HU95003_326_153030 2473.09         278.0532  3
 18HU95003_326_153029 2674.79         251.4358  2
 18HU95003_326_153028 2910.08         278.3658  3
 18HU95003_326_153027 3128.87         283.0328  0
 18HU95003_326_153026 3340.44         282.8318  3
 18HU95003_326_153025 3533.93         279.9289  3
 18HU95003_326_153024 3737.62         280.5541  3
 18HU95003_326_153023 3837.55         282.4745  3
 18HU95003_326_153022 3899.81         278.6337  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 8, station CAST#1:

           sample_key   depth    value   method qc
 18HU95003_326_153045    8.47  0.96799 NO2NO3_0  1
 18HU95003_326_153044   99.83 13.76950 NO2NO3_0  1
 18HU95003_326_153043  199.58 20.99954 NO2NO3_0  2
 18HU95003_326_153042  397.36 19.14704 NO2NO3_0  1
 18HU95003_326_153041  614.57 19.23749 NO2NO3_0  1
 18HU95003_326_153040  795.91 18.25656 NO2NO3_0  2
 18HU95003_326_153038  968.65 17.59852 NO2NO3_0  2
 18HU95003_326_153037 1076.33 17.96347 NO2NO3_0  2
 18HU95003_326_153036 1278.40 18.19199 NO2NO3_0  1
 18HU95003_326_153035 1479.76 17.55354 NO2NO3_0  1
 18HU95003_326_153034 1671.38 17.57750 NO2NO3_0  1
 18HU95003_326_153033 1871.56 17.81547 NO2NO3_0  1
 18HU95003_326_153032 2065.58 17.50151 NO2NO3_0  1
 18HU95003_326_153031 2263.60 17.93747 NO2NO3_0  1
 18HU95003_326_153030 2473.09 17.97297 NO2NO3_0  1
 18HU95003_326_153029 2674.79 17.73555 NO2NO3_0  1
 18HU95003_326_153028 2910.08 17.70303 NO2NO3_0  1
 18HU95003_326_153027 3128.87 17.37804 NO2NO3_0  1
 18HU95003_326_153026 3340.44 17.86197 NO2NO3_0  1
 18HU95003_326_153025 3533.93 17.59548 NO2NO3_0  1
 18HU95003_326_153024 3737.62 18.30001 NO2NO3_0  1
 18HU95003_326_153023 3837.55 18.42606 NO2NO3_0  1
 18HU95003_326_153022 3899.81 18.46348 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 8, station CAST#1:

           sample_key   depth   value method qc
 18HU95003_326_153045    8.47 0.51104  PO4_0  2
 18HU95003_326_153044   99.83 1.02896  PO4_0  1
 18HU95003_326_153043  199.58 1.39097  PO4_0  1
 18HU95003_326_153042  397.36 1.32195  PO4_0  1
 18HU95003_326_153041  614.57 1.25146  PO4_0  2
 18HU95003_326_153040  795.91 1.22396  PO4_0  2
 18HU95003_326_153038  968.65 1.15995  PO4_0  2
 18HU95003_326_153037 1076.33 1.17352  PO4_0  1
 18HU95003_326_153036 1278.40 1.17703  PO4_0  2
 18HU95003_326_153035 1479.76 1.17455  PO4_0  1
 18HU95003_326_153034 1671.38 1.13751  PO4_0  1
 18HU95003_326_153033 1871.56 1.22348  PO4_0  1
 18HU95003_326_153032 2065.58 1.16398  PO4_0  1
 18HU95003_326_153031 2263.60 1.13404  PO4_0  1
 18HU95003_326_153030 2473.09 1.17447  PO4_0  1
 18HU95003_326_153029 2674.79 1.13845  PO4_0  1
 18HU95003_326_153028 2910.08 1.14450  PO4_0  1
 18HU95003_326_153027 3128.87 1.13649  PO4_0  1
 18HU95003_326_153026 3340.44 1.15947  PO4_0  1
 18HU95003_326_153025 3533.93 1.24246  PO4_0  1
 18HU95003_326_153024 3737.62 1.17803  PO4_0  1
 18HU95003_326_153023 3837.55 1.20747  PO4_0  1
 18HU95003_326_153022 3899.81 1.25302  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 8, station CAST#1:

           sample_key   depth    value method qc
 18HU95003_326_153045    8.47  2.14898 SiO4_0  1
 18HU95003_326_153044   99.83  9.55297 SiO4_0  2
 18HU95003_326_153043  199.58 13.25601 SiO4_0  1
 18HU95003_326_153042  397.36 12.50651 SiO4_0  2
 18HU95003_326_153041  614.57 12.14803 SiO4_0  2
 18HU95003_326_153040  795.91 11.86654 SiO4_0  2
 18HU95003_326_153038  968.65 10.83249 SiO4_0  1
 18HU95003_326_153037 1076.33 11.77300 SiO4_0  2
 18HU95003_326_153036 1278.40 12.29556 SiO4_0  2
 18HU95003_326_153035 1479.76 12.13098 SiO4_0  2
 18HU95003_326_153034 1671.38 12.31848 SiO4_0  1
 18HU95003_326_153033 1871.56 12.79054 SiO4_0  1
 18HU95003_326_153032 2065.58 12.71706 SiO4_0  1
 18HU95003_326_153031 2263.60 14.02549 SiO4_0  1
 18HU95003_326_153030 2473.09 16.37100 SiO4_0  1
 18HU95003_326_153029 2674.79 16.22356 SiO4_0  1
 18HU95003_326_153028 2910.08 17.06348 SiO4_0  1
 18HU95003_326_153027 3128.87 17.96947 SiO4_0  1
 18HU95003_326_153026 3340.44 20.93401 SiO4_0  1
 18HU95003_326_153025 3533.93 21.95706 SiO4_0  1
 18HU95003_326_153024 3737.62 23.94004 SiO4_0  1
 18HU95003_326_153023 3837.55 25.98356 SiO4_0  1
 18HU95003_326_153022 3899.81 26.07001 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 9, station CAST#1:

           sample_key depth.x Salinity_CTD qc.x
 18HU95003_339_153046 3997.90      34.8808    3
 18HU95003_339_153047 3825.08      34.8883    3
 18HU95003_339_153048 3708.85      34.8924    3
 18HU95003_339_153049 3567.27      34.8934    3
 18HU95003_339_153050 3364.95      34.8967    3
 18HU95003_339_153051 3129.37      34.9044    3
 18HU95003_339_153052 2972.10      34.9099    3
 18HU95003_339_153053 2762.96      34.9180    3
 18HU95003_339_153054 2587.25      34.9270    3
 18HU95003_339_153055 2313.54      34.9269    3
 18HU95003_339_153056 2177.76      34.9150    3
 18HU95003_339_153057 2005.93      34.9079    3
 18HU95003_339_153058 1813.72      34.8905    3
 18HU95003_339_153059 1597.33      34.8838    3
 18HU95003_339_153060 1426.60      34.8765    3
 18HU95003_339_153061 1221.75      34.9096    3
 18HU95003_339_153062  983.77      34.9230    3
 18HU95003_339_153063  806.50      34.8754    3
 18HU95003_339_153064  632.86      34.8701    3
 18HU95003_339_153065  432.38      35.0188    3
 18HU95003_339_153066  291.19      34.6843    3
 18HU95003_339_153067  204.31      34.8177    3
 18HU95003_339_153068  104.61      34.6769    3
 18HU95003_339_153069    7.95      33.0004    3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 9, station CAST#1:

           sample_key   depth O2_Winkler_Molar qc
 18HU95003_339_153068  104.61         225.2650  3
 18HU95003_339_153067  204.31         193.7351  3
 18HU95003_339_153066  291.19         230.4456  3
 18HU95003_339_153065  432.38         222.0495  3
 18HU95003_339_153064  632.86         280.4201  3
 18HU95003_339_153063  806.50         287.7890  3
 18HU95003_339_153062  983.77         277.4279  3
 18HU95003_339_153061 1221.75         280.4648  3
 18HU95003_339_153059 1597.33         290.1560  3
 18HU95003_339_153058 1813.72         289.3521  3
 18HU95003_339_153057 2005.93         286.1813  3
 18HU95003_339_153056 2177.76         283.4124  3
 18HU95003_339_153055 2313.54         279.3483  3
 18HU95003_339_153054 2587.25         278.1871  3
 18HU95003_339_153053 2762.96         281.4027  3
 18HU95003_339_153052 2972.10         284.8415  3
 18HU95003_339_153051 3129.37         283.6803  3
 18HU95003_339_153050 3364.95         281.1794  3
 18HU95003_339_153049 3567.27         283.2337  3
 18HU95003_339_153048 3708.85         283.6357  3
 18HU95003_339_153047 3825.08         282.4745  3
 18HU95003_339_153046 3997.90         274.7483  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 9, station CAST#1:

           sample_key   depth    value   method qc
 18HU95003_339_153068  104.61 13.08598 NO2NO3_0  1
 18HU95003_339_153067  204.31 20.40801 NO2NO3_0  1
 18HU95003_339_153066  291.19 19.34454 NO2NO3_0  1
 18HU95003_339_153064  632.86 17.80751 NO2NO3_0  1
 18HU95003_339_153063  806.50 17.50597 NO2NO3_0  1
 18HU95003_339_153062  983.77 17.93204 NO2NO3_0  1
 18HU95003_339_153061 1221.75 18.14402 NO2NO3_0  1
 18HU95003_339_153059 1597.33 17.37651 NO2NO3_0  1
 18HU95003_339_153058 1813.72 17.38552 NO2NO3_0  1
 18HU95003_339_153057 2005.93 17.54005 NO2NO3_0  1
 18HU95003_339_153056 2177.76 17.65155 NO2NO3_0  1
 18HU95003_339_153055 2313.54 18.01550 NO2NO3_0  1
 18HU95003_339_153054 2587.25 17.62104 NO2NO3_0  1
 18HU95003_339_153053 2762.96 17.57701 NO2NO3_0  1
 18HU95003_339_153052 2972.10 17.20255 NO2NO3_0  1
 18HU95003_339_153051 3129.37 17.45003 NO2NO3_0  1
 18HU95003_339_153050 3364.95 17.24998 NO2NO3_0  1
 18HU95003_339_153049 3567.27 17.57156 NO2NO3_0  1
 18HU95003_339_153048 3708.85 17.69455 NO2NO3_0  1
 18HU95003_339_153047 3825.08 17.75953 NO2NO3_0  2
 18HU95003_339_153046 3997.90 19.32554 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18HU95016"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18HU95016 FLAG Report:,  2019-03-15 11:54:58
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18HU96006"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18HU96006 FLAG Report:,  2019-03-15 11:55:29
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18HU98051"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18HU98051 FLAG Report:,  2019-03-15 11:55:59
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged PHOSPHATE, event IML1998051601, station 601:

 sample_key depth value      method qc
             5.85  0.85 PO4_Tech_SF  7
            15.67  0.85 PO4_Tech_SF  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1998051851, station 851:

 sample_key  depth value      method qc
              5.45  0.52 PO4_Tech_SF  1
             15.37  0.65 PO4_Tech_SF  1
             25.19  1.36 PO4_Tech_SF  2
             49.68  1.06 PO4_Tech_SF  1
             97.06  0.91 PO4_Tech_SF  1
            147.80  1.08 PO4_Tech_SF  1
            199.03  1.20 PO4_Tech_SF  1
            233.99  1.29 PO4_Tech_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18HU99022"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18HU99022 FLAG Report:,  2019-03-15 11:56:19
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18HU99053"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18HU99053 FLAG Report:,  2019-03-15 11:56:48
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged OXYGEN, event IML199905321, station 21:

 sample_key  depth O2_CTD_mLL qc
              3.17   291.0939  0
              4.76   291.1832  0
             15.17   292.0764  0
             24.89   291.1385  0
             49.88   273.3639  0
             98.95   255.0533  0
            149.49   232.9019  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event IML199905331, station 31:

 sample_key  depth O2_CTD_mLL qc
              2.08   302.6608  0
              5.55   303.1074  0
             14.78   302.8841  0
             49.38   306.6356  0
             97.96   278.3211  0
            148.01   263.3154  0
            198.14   227.9446  0
            247.97   192.7972  0
            297.98   177.1216  0
            347.39   169.3954  0
            370.76   166.6265  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event IML199905351, station 51:

 sample_key  depth O2_CTD_mLL qc
              2.48   313.8258  0
              5.35   313.9598  0
             15.07   313.5579  0
             24.99   311.3695  0
             50.07   289.8881  0
            100.73   277.5619  0
            149.59   260.0105  0
            198.64   227.5874  0
            247.47   199.0050  0
            296.89   184.8031  0
            347.58   178.3720  0
            396.19   176.1390  0
            446.86   179.4885  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML199905351, station 51:

 sample_key  depth value         method qc
              2.48  4.18 NO2NO3_Tech_SF  1
              5.35  3.10 NO2NO3_Tech_SF  1
             15.07  3.46 NO2NO3_Tech_SF  1
             24.99  4.61 NO2NO3_Tech_SF  1
             50.07  8.61 NO2NO3_Tech_SF  1
            100.73  8.60 NO2NO3_Tech_SF  1
            149.59 12.82 NO2NO3_Tech_SF  1
            198.64 13.00 NO2NO3_Tech_SF  1
            247.47 22.08 NO2NO3_Tech_SF  1
            296.89 24.13 NO2NO3_Tech_SF  2
            347.58 22.56 NO2NO3_Tech_SF  1
            396.19 22.52 NO2NO3_Tech_SF  1
            446.86 19.88 NO2NO3_Tech_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML199905361, station 61:

 sample_key  depth value         method qc
              2.78 20.47 NO2NO3_Tech_SF  2
              5.65  2.46 NO2NO3_Tech_SF  7
             15.57  2.46 NO2NO3_Tech_SF  1
             25.68  2.22 NO2NO3_Tech_SF  1
             50.07  2.99 NO2NO3_Tech_SF  1
            100.13  7.00 NO2NO3_Tech_SF  1
            148.10 11.69 NO2NO3_Tech_SF  1
            199.03 19.34 NO2NO3_Tech_SF  1
            249.25 16.95 NO2NO3_Tech_SF  1
            295.70 23.35 NO2NO3_Tech_SF  1
            347.98 22.15 NO2NO3_Tech_SF  1
            396.98 19.54 NO2NO3_Tech_SF  1
            444.58 22.07 NO2NO3_Tech_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML199905361, station 61:

 sample_key  depth value       method qc
              2.78 16.54 SiO4_Tech_SF  2
              5.65  2.59 SiO4_Tech_SF  1
             15.57  3.03 SiO4_Tech_SF  1
             25.68  2.85 SiO4_Tech_SF  1
             50.07  4.14 SiO4_Tech_SF  1
            100.13  4.84 SiO4_Tech_SF  1
            148.10  9.04 SiO4_Tech_SF  1
            199.03 10.65 SiO4_Tech_SF  1
            249.25 15.82 SiO4_Tech_SF  1
            295.70 17.87 SiO4_Tech_SF  1
            347.98 20.52 SiO4_Tech_SF  1
            396.98 25.32 SiO4_Tech_SF  1
            444.58 28.71 SiO4_Tech_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML199905381, station 81:

 sample_key  depth value      method qc
              2.18  0.03 PO4_Tech_SF  2
              5.75  0.50 PO4_Tech_SF  1
             15.67  0.50 PO4_Tech_SF  1
             25.48  0.37 PO4_Tech_SF  1
             49.77  0.37 PO4_Tech_SF  1
             99.83  0.38 PO4_Tech_SF  1
            147.90  0.66 PO4_Tech_SF  2
            199.03  1.00 PO4_Tech_SF  1
            228.94  1.20 PO4_Tech_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18MF01015"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18MF01015 FLAG Report:,  2019-03-15 11:57:28
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged PHOSPHATE, event IML2001015421, station 421:

 sample_key  depth value     method qc
              2.48 0.150 PO4_Alp_SF  2
              5.45 0.190 PO4_Alp_SF  1
             14.77 0.235 PO4_Alp_SF  1
             25.29 0.250 PO4_Alp_SF  1
             49.77 0.370 PO4_Alp_SF  1
            100.63 0.800 PO4_Alp_SF  1
            199.82 1.290 PO4_Alp_SF  1
            250.83 1.440 PO4_Alp_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18MF02023"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18MF02023 FLAG Report:,  2019-03-15 11:58:18
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18MF02066"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18MF02066 FLAG Report:,  2019-03-15 11:59:43
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged OXYGEN, event IML2002066351, station 351:

 sample_key  depth O2_CTD_mLL qc
              1.79   319.3637  0
              5.55   319.5423  0
             14.78   319.7656  0
             25.58   317.4879  0
             47.79   314.5404  0
            101.03   290.3347  0
            197.94   168.1896  0
            301.35   148.6731  0
            399.45   166.9391  0
            451.51   166.4032  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event IML2002066441, station 441:

 sample_key depth O2_CTD_mLL qc
             1.98   318.7831  0
             4.86   317.9792  0
            14.87   317.7559  0
            24.79   316.4161  0
            47.20   245.9426  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event IML2002066471, station 471:

 sample_key depth O2_CTD_mLL qc
             1.59   314.8083  0
             4.96   314.7637  0
            15.07   314.7190  0
            25.38   313.6025  0
            50.47   256.0358  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event IML2002066481, station 481:

 sample_key depth O2_CTD_mLL qc
             1.78   317.1307  0
             4.96   317.1753  0
            15.07   317.1307  0
            25.58   315.8355  0
            50.27   313.5132  0
            73.47   217.0923  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18MF12001"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18MF12001 FLAG Report:,  2019-03-15 12:00:44
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18MT71031"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18MT71031 FLAG Report:,  2019-03-15 12:02:04
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18MT71036"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18MT71036 FLAG Report:,  2019-03-15 12:02:41
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged PHOSPHATE, event IML1971036F1721, station F1721:

 sample_key depth value     method qc
                0  1.06 PO4_Tech_F  1
                4  1.13 PO4_Tech_F  1
                7  1.03 PO4_Tech_F  1
               11  1.19 PO4_Tech_F  1
               18  1.06 PO4_Tech_F  7
               36  1.08 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18MT71044"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18MT71044 FLAG Report:,  2019-03-15 12:03:01
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NA95908"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NA95908 FLAG Report:,  2019-03-15 12:03:26
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 1, station CAST#1:

           sample_key depth value   method qc
 18NA95908_002_152244     5  0.00 NO2NO3_0  1
 18NA95908_002_152203     5  0.28 NO2NO3_0  7
 18NA95908_002_152202    25  0.00 NO2NO3_0  1
 18NA95908_002_152201    44  0.00 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 1, station CAST#1:

           sample_key depth   value method qc
 18NA95908_002_152244     5  0.2905  PO4_0  7
 18NA95908_002_152203     5  0.3855  PO4_0  1
 18NA95908_002_152202    25 18.8250  PO4_0  4
 18NA95908_002_152201    44 24.3050  PO4_0  4


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 1, station CAST#1:

           sample_key depth   value method qc
 18NA95908_002_152244     5   6.175 SiO4_0  7
 18NA95908_002_152203     5   5.755 SiO4_0  7
 18NA95908_002_152202    25  67.930 SiO4_0  1
 18NA95908_002_152201    44 112.770 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 11, station CAST#1:

           sample_key depth value   method qc
 18NA95908_014_152255     7 0.010 NO2NO3_0  1
 18NA95908_014_152225     7 0.005 NO2NO3_0  7
 18NA95908_014_152256    25 2.030 NO2NO3_0  1
 18NA95908_014_152224    25 1.925 NO2NO3_0  1
 18NA95908_014_152223    75 5.210 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 11, station CAST#1:

           sample_key depth  value method qc
 18NA95908_014_152255     7 0.0785  PO4_0  7
 18NA95908_014_152225     7 0.1095  PO4_0  1
 18NA95908_014_152256    25 0.4220  PO4_0  1
 18NA95908_014_152224    25 0.4295  PO4_0  1
 18NA95908_014_152223    75 0.7085  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 11, station CAST#1:

           sample_key depth value method qc
 18NA95908_014_152255     7 2.405 SiO4_0  1
 18NA95908_014_152225     7 1.965 SiO4_0  7
 18NA95908_014_152256    25 5.255 SiO4_0  7
 18NA95908_014_152224    25 4.760 SiO4_0  1
 18NA95908_014_152223    75 7.395 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 12, station CAST#1:

           sample_key depth value   method qc
 18NA95908_025_152227     1  0.00 NO2NO3_0  1
 18NA95908_025_152258     7  0.06 NO2NO3_0  7
 18NA95908_025_152226     7  0.41 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 12, station CAST#1:

           sample_key depth value method qc
 18NA95908_025_152227     1 2.530 SiO4_0  7
 18NA95908_025_152258     7 2.930 SiO4_0  1
 18NA95908_025_152226     7 2.515 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 13, station CAST#1:

           sample_key depth value   method qc
 18NA95908_036_152229     1  0.00 NO2NO3_0  7
 18NA95908_036_152260     5  0.02 NO2NO3_0  7
 18NA95908_036_152228     5  0.00 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 13, station CAST#1:

           sample_key depth  value method qc
 18NA95908_036_152229     1 0.1415  PO4_0  7
 18NA95908_036_152260     5 0.1495  PO4_0  1
 18NA95908_036_152228     5 0.1770  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 13, station CAST#1:

           sample_key depth value method qc
 18NA95908_036_152229     1 3.290 SiO4_0  1
 18NA95908_036_152260     5 2.895 SiO4_0  7
 18NA95908_036_152228     5 2.330 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 14, station CAST#1:

           sample_key depth value method qc
 18NA95908_047_152259     3 2.775 SiO4_0  7
 18NA95908_047_152230     3 2.400 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 15, station CAST#1:

           sample_key depth value   method qc
 18NA95908_058_152232     5 0.000 NO2NO3_0  7
 18NA95908_058_152231    20 0.055 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 15, station CAST#1:

           sample_key depth value method qc
 18NA95908_058_152232     5  1.88 SiO4_0  1
 18NA95908_058_152231    20  3.67 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 16, station CAST#1:

           sample_key depth value   method qc
 18NA95908_069_152234     5 0.005 NO2NO3_0  1
 18NA95908_069_152233    20 0.000 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 4, station CAST#1:

           sample_key depth value method qc
 18NA95908_264_152210     5  4.66 SiO4_0  7
 18NA95908_264_152209    13  8.68 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 5, station CAST#1:

           sample_key depth value   method qc
 18NA95908_284_152248     5  0.03 NO2NO3_0  7
 18NA95908_284_152212     5  0.18 NO2NO3_0  1
 18NA95908_284_152211     9  0.11 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 5, station CAST#1:

           sample_key depth value method qc
 18NA95908_284_152248     5 7.245 SiO4_0  7
 18NA95908_284_152212     5 7.255 SiO4_0  1
 18NA95908_284_152211     9 6.300 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 6, station CAST#1:

           sample_key depth  value method qc
 18NA95908_304_152214     5 0.1475  PO4_0  7
 18NA95908_304_152213     9 0.1960  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 6, station CAST#1:

           sample_key depth value method qc
 18NA95908_304_152214     5 5.800 SiO4_0  7
 18NA95908_304_152213     9 3.635 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 8, station CAST#1:

           sample_key depth value   method qc
 18NA95908_326_152218     5 0.220 NO2NO3_0  7
 18NA95908_326_152251     9 0.000 NO2NO3_0  1
 18NA95908_326_152217     9 0.055 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 8, station CAST#1:

           sample_key depth  value method qc
 18NA95908_326_152218     5 0.1725  PO4_0  1
 18NA95908_326_152251     9 0.2365  PO4_0  7
 18NA95908_326_152217     9 0.2490  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 8, station CAST#1:

           sample_key depth value method qc
 18NA95908_326_152218     5 3.805 SiO4_0  7
 18NA95908_326_152251     9 4.230 SiO4_0  7
 18NA95908_326_152217     9 4.290 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 9, station CAST#1:

           sample_key depth  value method qc
 18NA95908_339_152254     5 0.0465  PO4_0  1
 18NA95908_339_152220     5 0.1660  PO4_0  1
 18NA95908_339_152219     9 0.1520  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 9, station CAST#1:

           sample_key depth value method qc
 18NA95908_339_152254     5  4.11 SiO4_0  1
 18NA95908_339_152220     5  4.24 SiO4_0  7
 18NA95908_339_152219     9  2.97 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NA96002"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NA96002 FLAG Report:,  2019-03-15 12:04:23
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 23, station CAST#1:

           sample_key depth value   method qc
 18NA96002_149_147465     1 0.080 NO2NO3_0  1
 18NA96002_149_147464     7 0.075 NO2NO3_0  1
 18NA96002_149_147463    21 0.215 NO2NO3_0  7
 18NA96002_149_147462    46 0.415 NO2NO3_0  1
 18NA96002_149_147461    88 0.765 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 23, station CAST#1:

           sample_key depth  value method qc
 18NA96002_149_147465     1 0.1495  PO4_0  1
 18NA96002_149_147464     7 0.1895  PO4_0  7
 18NA96002_149_147463    21 0.2615  PO4_0  1
 18NA96002_149_147462    46 0.3130  PO4_0  1
 18NA96002_149_147461    88 0.5580  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 23, station CAST#1:

           sample_key depth value method qc
 18NA96002_149_147465     1 1.770 SiO4_0  7
 18NA96002_149_147464     7 0.805 SiO4_0  1
 18NA96002_149_147463    21 0.845 SiO4_0  1
 18NA96002_149_147462    46 1.085 SiO4_0  7
 18NA96002_149_147461    88 0.815 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 46, station CAST#1:

           sample_key depth  value   method qc
 18NA96002_280_147623     1  0.000 NO2NO3_0  1
 18NA96002_280_147622     5  0.010 NO2NO3_0  1
 18NA96002_280_147621    15  0.190 NO2NO3_0  1
 18NA96002_280_147620   222 14.485 NO2NO3_0  4


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 55, station CAST#1:

           sample_key depth value   method qc
 18NA96002_299_147650     1 0.090 NO2NO3_0  1
 18NA96002_299_147649     5 0.100 NO2NO3_0  1
 18NA96002_299_147648    15 0.130 NO2NO3_0  1
 18NA96002_299_147647    50 0.295 NO2NO3_0  7
 18NA96002_299_147646    70 0.795 NO2NO3_0  1
 18NA96002_299_147645   112 1.920 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 55, station CAST#1:

           sample_key depth  value method qc
 18NA96002_299_147650     1 0.1615  PO4_0  1
 18NA96002_299_147649     5 0.1495  PO4_0  1
 18NA96002_299_147648    15 0.1805  PO4_0  7
 18NA96002_299_147647    50 0.3455  PO4_0  1
 18NA96002_299_147646    70 0.3420  PO4_0  1
 18NA96002_299_147645   112 0.4830  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 58, station CAST#1:

           sample_key depth  value method qc
 18NA96002_302_147661     1 0.1495  PO4_0  1
 18NA96002_302_147660     5 0.1610  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NA96013"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NA96013 FLAG Report:,  2019-03-15 12:04:56
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged PHOSPHATE, event 16, station CAST#1:

           sample_key depth  value method qc
 18NA96013_069_158749     1 0.2005  PO4_0  7
 18NA96013_069_158748     4 0.1115  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 17, station CAST#1:

           sample_key depth value method qc
 18NA96013_080_158751     1  1.19 SiO4_0  1
 18NA96013_080_158750     4  1.14 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 34, station CAST#1:

           sample_key depth value   method qc
 18NA96013_244_158799     1  0.31 NO2NO3_0  1
 18NA96013_244_158798     5  0.34 NO2NO3_0  7
 18NA96013_244_158797    18  0.29 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 47, station CAST#1:

           sample_key depth value method qc
 18NA96013_281_158836     1 2.645 SiO4_0  1
 18NA96013_281_158835     5 2.335 SiO4_0  7
 18NA96013_281_158834    20 2.955 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 48, station CAST#1:

           sample_key depth  value method qc
 18NA96013_282_158840     1 0.0530  PO4_0  1
 18NA96013_282_158839     5 0.0625  PO4_0  4
 18NA96013_282_158838    40 0.3345  PO4_0  1
 18NA96013_282_158837    73 0.4465  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NA96022"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NA96022 FLAG Report:,  2019-03-15 12:05:19
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged SILICATE, event 13, station CAST#1:

           sample_key depth  value method qc
 18NA96022_036_175709     1  3.200 SiO4_0  1
 18NA96022_036_175708     5  3.645 SiO4_0  1
 18NA96022_036_175707    15  3.240 SiO4_0  2
 18NA96022_036_175706    50  7.140 SiO4_0  2
 18NA96022_036_175705   100 16.670 SiO4_0  2
 18NA96022_036_175704   150 27.530 SiO4_0  1
 18NA96022_036_175703   247 27.085 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 22, station CAST#1:

           sample_key depth value method qc
 18NA96022_138_175737     1 0.302  PO4_0  1
 18NA96022_138_175736     7 0.291  PO4_0  4


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 22, station CAST#1:

           sample_key depth value method qc
 18NA96022_138_175737     1 6.845 SiO4_0  4
 18NA96022_138_175736     7 7.670 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 23, station CAST#1:

           sample_key depth value   method qc
 18NA96022_149_175739     5  0.47 NO2NO3_0  1
 18NA96022_149_175738     9  1.20 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 23, station CAST#1:

           sample_key depth  value method qc
 18NA96022_149_175739     5 0.2985  PO4_0  7
 18NA96022_149_175738     9 0.3590  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 23, station CAST#1:

           sample_key depth value method qc
 18NA96022_149_175739     5  7.50 SiO4_0  1
 18NA96022_149_175738     9  5.76 SiO4_0  4


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 24, station CAST#1:

           sample_key depth value method qc
 18NA96022_160_175741     3 7.515 SiO4_0  1
 18NA96022_160_175740     6 6.415 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 43, station CAST#1:

           sample_key depth  value method qc
 18NA96022_277_175793     1 0.1515  PO4_0  1
 18NA96022_277_175792     5 0.1740  PO4_0  7
 18NA96022_277_175791    15 0.1775  PO4_0  1
 18NA96022_277_175790    56 0.8310  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 43, station CAST#1:

           sample_key depth  value method qc
 18NA96022_277_175793     1  3.150 SiO4_0  7
 18NA96022_277_175792     5  3.225 SiO4_0  1
 18NA96022_277_175791    15  3.355 SiO4_0  1
 18NA96022_277_175790    56 12.010 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 51, station CAST#1:

           sample_key depth value   method qc
 18NA96022_295_175824     1 0.350 NO2NO3_0  1
 18NA96022_295_175823     5 0.310 NO2NO3_0  1
 18NA96022_295_175822    40 3.430 NO2NO3_0  1
 18NA96022_295_175821    68 4.115 NO2NO3_0  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NA97015"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NA97015 FLAG Report:,  2019-03-15 12:05:55
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 13, station CAST#1:

           sample_key depth value   method qc
 18NA97015_036_147688     4     0 NO2NO3_0  7
 18NA97015_036_147687     8     0 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 21, station CAST#1:

           sample_key depth value   method qc
 18NA97015_127_147690     1     0 NO2NO3_0  1
 18NA97015_127_147689     7     0 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 21, station CAST#1:

           sample_key depth  value method qc
 18NA97015_127_147690     1 0.1565  PO4_0  7
 18NA97015_127_147689     7 0.1525  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 23, station CAST#1:

           sample_key depth value   method qc
 18NA97015_149_147694     1     0 NO2NO3_0  7
 18NA97015_149_147693     4     0 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 24, station CAST#1:

           sample_key depth value method qc
 18NA97015_160_147696     1 0.077  PO4_0  1
 18NA97015_160_147695     7 0.264  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 24, station CAST#1:

           sample_key depth value method qc
 18NA97015_160_147696     1 3.555 SiO4_0  7
 18NA97015_160_147695     7 2.675 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 26, station CAST#1:

           sample_key depth value   method qc
 18NA97015_182_147698     0     0 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 27, station CAST#1:

           sample_key depth value method qc
 18NA97015_193_180603     0 0.018  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 35, station CAST#1:

           sample_key depth value method qc
 18NA97015_247_180621     1  0.00 SiO4_0  7
 18NA97015_247_180620     5  0.04 SiO4_0  1
 18NA97015_247_180619    10  0.00 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 6, station CAST#1:

           sample_key depth value   method qc
 18NA97015_304_147683     1 0.000 NO2NO3_0  1
 18NA97015_304_147682     4 0.000 NO2NO3_0  1
 18NA97015_304_147681    10 0.695 NO2NO3_0  7
 18NA97015_304_147680    15 4.385 NO2NO3_0  1
 18NA97015_304_147679    20 1.810 NO2NO3_0  1
 18NA97015_304_147678    35 0.000 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 6, station CAST#1:

           sample_key depth  value method qc
 18NA97015_304_147683     1  0.117  PO4_0  1
 18NA97015_304_147682     4  0.169  PO4_0  7
 18NA97015_304_147681    10  0.450  PO4_0  1
 18NA97015_304_147680    15  1.162  PO4_0  1
 18NA97015_304_147679    20  5.430  PO4_0  1
 18NA97015_304_147678    35 12.217  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 6, station CAST#1:

           sample_key depth  value method qc
 18NA97015_304_147683     1  4.955 SiO4_0  7
 18NA97015_304_147682     4  4.180 SiO4_0  1
 18NA97015_304_147681    10  1.620 SiO4_0  1
 18NA97015_304_147680    15  2.045 SiO4_0  1
 18NA97015_304_147679    20 29.235 SiO4_0  1
 18NA97015_304_147678    35 36.870 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 8, station CAST#1:

           sample_key depth  value method qc
 18NA97015_326_147686     1 0.0300  PO4_0  1
 18NA97015_326_147685     8 2.6755  PO4_0  4
 18NA97015_326_147684    15 2.9080  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 8, station CAST#1:

           sample_key depth  value method qc
 18NA97015_326_147686     1  8.755 SiO4_0  4
 18NA97015_326_147685     8 34.550 SiO4_0  1
 18NA97015_326_147684    15 35.155 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NA97052"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NA97052 FLAG Report:,  2019-03-15 12:06:34
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 1, station CAST#1:

           sample_key depth  value   method qc
 18NA97052_002_180704     1  0.000 NO2NO3_0  1
 18NA97052_002_180703     5  0.000 NO2NO3_0  1
 18NA97052_002_180702    15  6.360 NO2NO3_0  1
 18NA97052_002_180701    25 11.645 NO2NO3_0  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 1, station CAST#1:

           sample_key depth  value method qc
 18NA97052_002_180704     1 0.1175  PO4_0  1
 18NA97052_002_180703     5 0.1215  PO4_0  1
 18NA97052_002_180702    15 1.6325  PO4_0  1
 18NA97052_002_180701    25 2.2655  PO4_0  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 1, station CAST#1:

           sample_key depth  value method qc
 18NA97052_002_180704     1  2.510 SiO4_0  1
 18NA97052_002_180703     5  2.320 SiO4_0  1
 18NA97052_002_180702    15 14.355 SiO4_0  2
 18NA97052_002_180701    25 19.570 SiO4_0  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 2, station CAST#1:

           sample_key depth value method qc
 18NA97052_113_180707     1  2.66 SiO4_0  2
 18NA97052_113_180706     5  2.65 SiO4_0  1
 18NA97052_113_180705    10  7.57 SiO4_0  1


-> QC repot:
      Filename Pressure Uniqueno Variable   Values
 18NA97052_002    15.00   180702     slca  14.36  
 18NA97052_002    25.00   180701     slca  19.57  
                                                        Test.failed
  Out of Nutrient Climatology in box(es) 6 (Min=0.00 Max=9.44 n=94)
  Out of Nutrient Climatology in box(es) 6 (Min=0.00 Max=9.44 n=94)



-> Flagged NITRATE, event 23, station CAST#1:

           sample_key depth  value   method qc
 18NA97052_149_180745     1  0.035 NO2NO3_0  1
 18NA97052_149_180744     5  0.010 NO2NO3_0  1
 18NA97052_149_180743    10  1.240 NO2NO3_0  1
 18NA97052_149_180742    15 24.580 NO2NO3_0  7
 18NA97052_149_180741    20  5.500 NO2NO3_0  1
 18NA97052_149_180739    25  0.350 NO2NO3_0  1
 18NA97052_149_180738    43  0.170 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 23, station CAST#1:

           sample_key depth   value method qc
 18NA97052_149_180745     1  0.4350  PO4_0  1
 18NA97052_149_180744     5  0.4375  PO4_0  1
 18NA97052_149_180743    10  0.8640  PO4_0  7
 18NA97052_149_180742    15  3.2840  PO4_0  1
 18NA97052_149_180741    20  4.4795  PO4_0  4
 18NA97052_149_180739    25 10.0000  PO4_0  1
 18NA97052_149_180738    43 14.0000  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 23, station CAST#1:

           sample_key depth  value method qc
 18NA97052_149_180745     1  6.775 SiO4_0  1
 18NA97052_149_180744     5  6.715 SiO4_0  7
 18NA97052_149_180743    10  8.070 SiO4_0  1
 18NA97052_149_180742    15 15.045 SiO4_0  4
 18NA97052_149_180741    20 29.085 SiO4_0  1
 18NA97052_149_180739    25 55.000 SiO4_0  1
 18NA97052_149_180738    43 85.000 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 4, station CAST#1:

           sample_key depth  value method qc
 18NA97052_264_180713     1 0.1290  PO4_0  1
 18NA97052_264_180712     5 0.1440  PO4_0  1
 18NA97052_264_180711    15 0.2555  PO4_0  1
 18NA97052_264_180710    24 0.6405  PO4_0  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE13022"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE13022 FLAG Report:,  2019-03-15 12:07:07
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 133, station 133:

           sample_key depth value        method qc
 18NE13022_040_388521     4     0 NO2NO3_Tech_F  7
 18NE13022_040_388520    25     0 NO2NO3_Tech_F  7
 18NE13022_040_388519    52     0 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 225, station 225:

           sample_key depth  value        method qc
 18NE13022_144_388875     2  0.435 NO2NO3_Tech_F  7
 18NE13022_144_388874     4  2.935 NO2NO3_Tech_F  7
 18NE13022_144_388873    26  4.505 NO2NO3_Tech_F  1
 18NE13022_144_388872    51 22.190 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE14018"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE14018 FLAG Report:,  2019-03-15 12:07:28
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 115, station 115:

           sample_key depth value        method qc
 18NE14018_020_398386     5     0 NO2NO3_Tech_F  7
 18NE14018_020_398385    34     0 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event 128, station 128:

           sample_key depth Chl_a_Holm-Hansen_F qc
 18NE14018_034_398412  5.83             0.24695  7
 18NE14018_034_398411 53.31             0.24695  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 133, station 133:

           sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
 18NE14018_040_398421   37.25      32.3916    1   37.25          32.0554    7
 18NE14018_040_398422    5.42      31.8573    1      NA               NA <NA>


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 137, station 137:

           sample_key depth value      method qc
 18NE14018_044_398428  5.42 0.000 SiO4_Tech_F  1
 18NE14018_044_398427 49.27 0.505 SiO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 142, station HL_02:

           sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
 18NE14018_050_398437  141.27      34.4168    1  141.27          34.3964    1
 18NE14018_050_398438  101.08      33.4975    1      NA               NA <NA>
 18NE14018_050_398439   75.83      32.8657    1      NA               NA <NA>
 18NE14018_050_398440   50.84      32.2698    1      NA               NA <NA>
 18NE14018_050_398441   40.89      32.0428    1   40.89          31.8085    7
 18NE14018_050_398442   30.50      31.9026    1      NA               NA <NA>
 18NE14018_050_398443   20.46      32.2331    1      NA               NA <NA>
 18NE14018_050_398444   10.46      31.3574    1      NA               NA <NA>
 18NE14018_050_398445    5.27      31.2498    1      NA               NA <NA>
 18NE14018_050_398446    2.30      31.0802    1    2.30          31.1020    1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 142, station HL_02:

           sample_key  depth  value        method qc
 18NE14018_050_398446   2.30  0.000 NO2NO3_Tech_F  1
 18NE14018_050_398445   5.27  0.000 NO2NO3_Tech_F  1
 18NE14018_050_398444  10.46  0.000 NO2NO3_Tech_F  1
 18NE14018_050_398443  20.46  0.000 NO2NO3_Tech_F  1
 18NE14018_050_398442  30.50  0.885 NO2NO3_Tech_F  1
 18NE14018_050_398441  40.89  1.400 NO2NO3_Tech_F  1
 18NE14018_050_398440  50.84  3.330 NO2NO3_Tech_F  1
 18NE14018_050_398439  75.83  2.820 NO2NO3_Tech_F  1
 18NE14018_050_398438 101.08  7.855 NO2NO3_Tech_F  2
 18NE14018_050_398437 141.27 16.875 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 142, station HL_02:

           sample_key  depth  value      method qc
 18NE14018_050_398446   2.30  0.535 SiO4_Tech_F  1
 18NE14018_050_398445   5.27  0.355 SiO4_Tech_F  1
 18NE14018_050_398444  10.46  0.400 SiO4_Tech_F  1
 18NE14018_050_398443  20.46  0.360 SiO4_Tech_F  1
 18NE14018_050_398442  30.50  1.835 SiO4_Tech_F  1
 18NE14018_050_398441  40.89  1.285 SiO4_Tech_F  1
 18NE14018_050_398440  50.84  2.835 SiO4_Tech_F  1
 18NE14018_050_398439  75.83  3.435 SiO4_Tech_F  1
 18NE14018_050_398438 101.08  7.735 SiO4_Tech_F  2
 18NE14018_050_398437 141.27 15.285 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 146, station 146:

           sample_key  depth value      method qc
 18NE14018_054_398458   4.39 0.310 SiO4_Tech_F  1
 18NE14018_054_398457  24.57 0.315 SiO4_Tech_F  1
 18NE14018_054_398456  50.13 2.985 SiO4_Tech_F  1
 18NE14018_054_398455 106.03 6.680 SiO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 159, station 159:

           sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
 18NE14018_068_398499   94.68      29.1042    1   94.68          32.4014    7
 18NE14018_068_398500   50.13      30.5220    1      NA               NA <NA>
 18NE14018_068_398501   24.54      29.4792    1      NA               NA <NA>
 18NE14018_068_398502    5.50       7.2882    1      NA               NA <NA>


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 171, station 171:

           sample_key depth  value      method qc
 18NE14018_082_398538     5  0.410 SiO4_Tech_F  1
 18NE14018_082_398537    25  7.005 SiO4_Tech_F  2
 18NE14018_082_398536    51  9.340 SiO4_Tech_F  1
 18NE14018_082_398535    83 11.935 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 180, station 180:

           sample_key  depth value        method qc
 18NE14018_092_398566   5.31  0.00 NO2NO3_Tech_F  1
 18NE14018_092_398565  25.46  0.00 NO2NO3_Tech_F  1
 18NE14018_092_398564  50.26  2.25 NO2NO3_Tech_F  1
 18NE14018_092_398563 336.93 22.43 NO2NO3_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 181, station 181:

           sample_key  depth  value     method qc
 18NE14018_093_398570   5.13 0.0545 PO4_Tech_F  2
 18NE14018_093_398569  25.37 0.4195 PO4_Tech_F  1
 18NE14018_093_398568  49.91 0.7020 PO4_Tech_F  1
 18NE14018_093_398567 443.10 1.7075 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 181, station 181:

           sample_key  depth  value      method qc
 18NE14018_093_398570   5.13  0.140 SiO4_Tech_F  2
 18NE14018_093_398569  25.37  0.335 SiO4_Tech_F  1
 18NE14018_093_398568  49.91  1.345 SiO4_Tech_F  2
 18NE14018_093_398567 443.10 30.585 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 182, station 182:

           sample_key  depth value     method qc
 18NE14018_094_398574   4.74 0.081 PO4_Tech_F  2
 18NE14018_094_398573  25.35 0.617 PO4_Tech_F  1
 18NE14018_094_398572  49.86 0.615 PO4_Tech_F  1
 18NE14018_094_398571 394.75 1.695 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 182, station 182:

           sample_key  depth  value      method qc
 18NE14018_094_398574   4.74  0.230 SiO4_Tech_F  2
 18NE14018_094_398573  25.35  3.470 SiO4_Tech_F  1
 18NE14018_094_398572  49.86  0.505 SiO4_Tech_F  2
 18NE14018_094_398571 394.75 29.535 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 189, station 189:

           sample_key  depth value      method qc
 18NE14018_101_398598   4.20  0.24 SiO4_Tech_F  2
 18NE14018_101_398597  25.10  1.18 SiO4_Tech_F  1
 18NE14018_101_398596  50.41  0.16 SiO4_Tech_F  2
 18NE14018_101_398595 342.33 30.16 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 196, station 196:

           sample_key  depth value      method qc
 18NE14018_109_398626   4.70  0.38 SiO4_Tech_F  1
 18NE14018_109_398625  24.80  0.19 SiO4_Tech_F  1
 18NE14018_109_398624  49.86  0.00 SiO4_Tech_F  2
 18NE14018_109_398623 258.57 14.05 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 201, station 201:

           sample_key  depth  value      method qc
 18NE14018_118_398644   4.34  0.155 SiO4_Tech_F  2
 18NE14018_118_398643  25.52  0.155 SiO4_Tech_F  1
 18NE14018_118_398642  50.91  1.325 SiO4_Tech_F  2
 18NE14018_118_398641 419.49 18.250 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 204, station 204:

           sample_key  depth value      method qc
 18NE14018_121_398651   5.52 0.150 SiO4_Tech_F  1
 18NE14018_121_398650  25.03 0.175 SiO4_Tech_F  1
 18NE14018_121_398649  50.02 0.370 SiO4_Tech_F  2
 18NE14018_121_398648 118.67 5.885 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 225, station 225:

           sample_key  depth  value     method qc
 18NE14018_144_398726   4.39 0.0735 PO4_Tech_F  2
 18NE14018_144_398725  25.28 0.2475 PO4_Tech_F  1
 18NE14018_144_398724  50.71 0.6445 PO4_Tech_F  1
 18NE14018_144_398723 148.08 1.3540 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 76, station 76:

           sample_key  depth  value     method qc
 18NE14018_322_398291   5.69 0.0625 PO4_Tech_F  2
 18NE14018_322_398290  25.66 0.0745 PO4_Tech_F  2
 18NE14018_322_398289  51.08 0.6515 PO4_Tech_F  1
 18NE14018_322_398288 120.44 1.0900 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 9, station 9:

           sample_key depth value        method qc
 18NE14018_339_398052  5.20 0.000 NO2NO3_Tech_F  1
 18NE14018_339_398051 25.23 0.000 NO2NO3_Tech_F  1
 18NE14018_339_398050 50.53 0.000 NO2NO3_Tech_F  2
 18NE14018_339_398049 60.40 4.025 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE14101"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE14101 FLAG Report:,  2019-03-15 12:08:45
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 15, station 15:

           sample_key depth value        method qc
 18NE14101_058_397874  4.99 8.840 NO2NO3_Tech_F  1
 18NE14101_058_397873 25.14 8.840 NO2NO3_Tech_F  2
 18NE14101_058_397872 50.69 8.830 NO2NO3_Tech_F  1
 18NE14101_058_397871 79.66 8.905 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 15, station 15:

           sample_key depth  value     method qc
 18NE14101_058_397874  4.99 0.9545 PO4_Tech_F  1
 18NE14101_058_397873 25.14 0.8805 PO4_Tech_F  2
 18NE14101_058_397872 50.69 0.8835 PO4_Tech_F  1
 18NE14101_058_397871 79.66 0.8870 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 17, station 17:

           sample_key depth value        method qc
 18NE14101_080_397878  4.49 8.190 NO2NO3_Tech_F  1
 18NE14101_080_397877 25.19 8.160 NO2NO3_Tech_F  2
 18NE14101_080_397876 50.42 8.315 NO2NO3_Tech_F  1
 18NE14101_080_397875 68.19 8.465 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 17, station 17:

           sample_key depth  value     method qc
 18NE14101_080_397878  4.49 0.8660 PO4_Tech_F  1
 18NE14101_080_397877 25.19 0.8625 PO4_Tech_F  2
 18NE14101_080_397876 50.42 0.8515 PO4_Tech_F  1
 18NE14101_080_397875 68.19 0.8690 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 19, station 19:

           sample_key  depth  value        method qc
 18NE14101_102_397887   5.13  5.415 NO2NO3_Tech_F  1
 18NE14101_102_397886  25.75  7.495 NO2NO3_Tech_F  2
 18NE14101_102_397885  50.25  9.185 NO2NO3_Tech_F  1
 18NE14101_102_397884 214.80 15.845 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 19, station 19:

           sample_key  depth  value     method qc
 18NE14101_102_397887   5.13 0.7325 PO4_Tech_F  1
 18NE14101_102_397886  25.75 0.7960 PO4_Tech_F  2
 18NE14101_102_397885  50.25 0.8675 PO4_Tech_F  1
 18NE14101_102_397884 214.80 1.1770 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 20, station 20:

           sample_key depth value        method qc
 18NE14101_114_397890  5.08 8.385 NO2NO3_Tech_F  1
 18NE14101_114_397889 25.40 7.965 NO2NO3_Tech_F  2
 18NE14101_114_397888 50.72 8.475 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 20, station 20:

           sample_key depth  value     method qc
 18NE14101_114_397890  5.08 0.8915 PO4_Tech_F  1
 18NE14101_114_397889 25.40 0.9215 PO4_Tech_F  2
 18NE14101_114_397888 50.72 0.9195 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 21, station 21:

           sample_key depth value        method qc
 18NE14101_127_397894  4.99 8.410 NO2NO3_Tech_F  1
 18NE14101_127_397893 24.41 8.230 NO2NO3_Tech_F  2
 18NE14101_127_397892 50.45 8.195 NO2NO3_Tech_F  1
 18NE14101_127_397891 59.16 8.620 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 21, station 21:

           sample_key depth  value     method qc
 18NE14101_127_397894  4.99 0.9950 PO4_Tech_F  1
 18NE14101_127_397893 24.41 1.0460 PO4_Tech_F  2
 18NE14101_127_397892 50.45 1.0360 PO4_Tech_F  1
 18NE14101_127_397891 59.16 0.9925 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 22, station 22:

           sample_key depth value        method qc
 18NE14101_138_397898  5.76 7.855 NO2NO3_Tech_F  1
 18NE14101_138_397897 25.24 7.790 NO2NO3_Tech_F  2
 18NE14101_138_397896 50.39 7.990 NO2NO3_Tech_F  1
 18NE14101_138_397895 86.00 7.960 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 22, station 22:

           sample_key depth  value     method qc
 18NE14101_138_397898  5.76 0.8720 PO4_Tech_F  1
 18NE14101_138_397897 25.24 0.8765 PO4_Tech_F  2
 18NE14101_138_397896 50.39 0.9245 PO4_Tech_F  1
 18NE14101_138_397895 86.00 0.9185 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 23, station 23:

           sample_key depth value        method qc
 18NE14101_149_397901  5.55 9.105 NO2NO3_Tech_F  1
 18NE14101_149_397900 25.18 8.025 NO2NO3_Tech_F  2
 18NE14101_149_397899 53.25 8.105 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 23, station 23:

           sample_key depth  value     method qc
 18NE14101_149_397901  5.55 0.9410 PO4_Tech_F  1
 18NE14101_149_397900 25.18 0.9095 PO4_Tech_F  2
 18NE14101_149_397899 53.25 0.9285 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 24, station 24:

           sample_key  depth value        method qc
 18NE14101_160_397905   3.42 8.630 NO2NO3_Tech_F  1
 18NE14101_160_397904  25.12 8.810 NO2NO3_Tech_F  2
 18NE14101_160_397903  50.75 8.225 NO2NO3_Tech_F  1
 18NE14101_160_397902 105.98 9.565 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 24, station 24:

           sample_key  depth  value     method qc
 18NE14101_160_397905   3.42 0.8830 PO4_Tech_F  1
 18NE14101_160_397904  25.12 0.9000 PO4_Tech_F  2
 18NE14101_160_397903  50.75 0.8725 PO4_Tech_F  1
 18NE14101_160_397902 105.98 0.9740 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 25, station 25:

           sample_key  depth value        method qc
 18NE14101_171_397913   4.49 8.835 NO2NO3_Tech_F  1
 18NE14101_171_397912  24.74 8.530 NO2NO3_Tech_F  2
 18NE14101_171_397911  50.73 8.860 NO2NO3_Tech_F  1
 18NE14101_171_397910 138.90 8.995 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 25, station 25:

           sample_key  depth  value     method qc
 18NE14101_171_397913   4.49 0.8805 PO4_Tech_F  1
 18NE14101_171_397912  24.74 0.8755 PO4_Tech_F  2
 18NE14101_171_397911  50.73 0.8940 PO4_Tech_F  1
 18NE14101_171_397910 138.90 0.8810 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 26, station 26:

           sample_key  depth value        method qc
 18NE14101_182_397917   5.16 8.695 NO2NO3_Tech_F  1
 18NE14101_182_397916  24.52 8.670 NO2NO3_Tech_F  2
 18NE14101_182_397915  49.51 8.870 NO2NO3_Tech_F  1
 18NE14101_182_397914 103.86 9.570 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 26, station 26:

           sample_key  depth  value     method qc
 18NE14101_182_397917   5.16 0.8620 PO4_Tech_F  1
 18NE14101_182_397916  24.52 0.8610 PO4_Tech_F  2
 18NE14101_182_397915  49.51 0.8560 PO4_Tech_F  1
 18NE14101_182_397914 103.86 0.9195 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 27, station 27:

           sample_key depth value        method qc
 18NE14101_193_397920  5.57 7.870 NO2NO3_Tech_F  1
 18NE14101_193_397919 25.28 7.695 NO2NO3_Tech_F  2
 18NE14101_193_397918 55.35 8.695 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 27, station 27:

           sample_key depth  value     method qc
 18NE14101_193_397920  5.57 0.8265 PO4_Tech_F  1
 18NE14101_193_397919 25.28 0.7930 PO4_Tech_F  2
 18NE14101_193_397918 55.35 0.8805 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 28, station 28:

           sample_key  depth value        method qc
 18NE14101_204_397924   4.03 8.810 NO2NO3_Tech_F  1
 18NE14101_204_397923  25.30 8.770 NO2NO3_Tech_F  2
 18NE14101_204_397922  50.38 8.895 NO2NO3_Tech_F  1
 18NE14101_204_397921 112.36 8.575 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 28, station 28:

           sample_key  depth  value     method qc
 18NE14101_204_397924   4.03 0.8920 PO4_Tech_F  1
 18NE14101_204_397923  25.30 0.8805 PO4_Tech_F  2
 18NE14101_204_397922  50.38 0.8750 PO4_Tech_F  1
 18NE14101_204_397921 112.36 0.8525 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 29, station 29:

           sample_key depth value        method qc
 18NE14101_215_397928  6.72 8.530 NO2NO3_Tech_F  1
 18NE14101_215_397927 24.89 8.525 NO2NO3_Tech_F  2
 18NE14101_215_397926 49.77 8.465 NO2NO3_Tech_F  1
 18NE14101_215_397925 84.17 8.340 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 29, station 29:

           sample_key depth value     method qc
 18NE14101_215_397928  6.72 0.868 PO4_Tech_F  1
 18NE14101_215_397927 24.89 0.874 PO4_Tech_F  2
 18NE14101_215_397926 49.77 0.879 PO4_Tech_F  1
 18NE14101_215_397925 84.17 0.868 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 30, station 30:

           sample_key depth value        method qc
 18NE14101_226_397932  6.31 8.565 NO2NO3_Tech_F  1
 18NE14101_226_397931 24.59 8.590 NO2NO3_Tech_F  2
 18NE14101_226_397930 50.77 8.565 NO2NO3_Tech_F  1
 18NE14101_226_397929 67.16 8.690 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 30, station 30:

           sample_key depth  value     method qc
 18NE14101_226_397932  6.31 0.8585 PO4_Tech_F  1
 18NE14101_226_397931 24.59 0.8615 PO4_Tech_F  2
 18NE14101_226_397930 50.77 0.8485 PO4_Tech_F  1
 18NE14101_226_397929 67.16 0.8570 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 31, station 31:

           sample_key depth value        method qc
 18NE14101_237_397936  5.31 8.800 NO2NO3_Tech_F  1
 18NE14101_237_397935 25.23 8.895 NO2NO3_Tech_F  2
 18NE14101_237_397934 50.32 8.915 NO2NO3_Tech_F  1
 18NE14101_237_397933 83.98 8.870 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 31, station 31:

           sample_key depth  value     method qc
 18NE14101_237_397936  5.31 0.8685 PO4_Tech_F  1
 18NE14101_237_397935 25.23 0.8685 PO4_Tech_F  2
 18NE14101_237_397934 50.32 0.8610 PO4_Tech_F  1
 18NE14101_237_397933 83.98 0.8690 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 32, station 32:

           sample_key depth value        method qc
 18NE14101_239_397940  4.69 8.970 NO2NO3_Tech_F  1
 18NE14101_239_397939 25.02 8.960 NO2NO3_Tech_F  2
 18NE14101_239_397938 50.09 9.095 NO2NO3_Tech_F  1
 18NE14101_239_397937 92.86 8.955 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 32, station 32:

           sample_key depth  value     method qc
 18NE14101_239_397940  4.69 0.8815 PO4_Tech_F  1
 18NE14101_239_397939 25.02 0.8730 PO4_Tech_F  2
 18NE14101_239_397938 50.09 0.8775 PO4_Tech_F  1
 18NE14101_239_397937 92.86 0.8645 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 33, station 33:

           sample_key  depth value        method qc
 18NE14101_243_397944   5.82 8.855 NO2NO3_Tech_F  1
 18NE14101_243_397943  24.69 9.005 NO2NO3_Tech_F  2
 18NE14101_243_397942  49.73 9.010 NO2NO3_Tech_F  1
 18NE14101_243_397941 107.81 9.135 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 33, station 33:

           sample_key  depth  value     method qc
 18NE14101_243_397944   5.82 0.8745 PO4_Tech_F  1
 18NE14101_243_397943  24.69 0.8690 PO4_Tech_F  2
 18NE14101_243_397942  49.73 0.8405 PO4_Tech_F  1
 18NE14101_243_397941 107.81 0.8765 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 34, station 34:

           sample_key  depth value        method qc
 18NE14101_244_397948   6.21  8.72 NO2NO3_Tech_F  1
 18NE14101_244_397947  25.99  8.65 NO2NO3_Tech_F  2
 18NE14101_244_397946  49.08  8.79 NO2NO3_Tech_F  1
 18NE14101_244_397945 105.50  8.90 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 34, station 34:

           sample_key  depth  value     method qc
 18NE14101_244_397948   6.21 0.8950 PO4_Tech_F  1
 18NE14101_244_397947  25.99 0.8910 PO4_Tech_F  2
 18NE14101_244_397946  49.08 0.8935 PO4_Tech_F  1
 18NE14101_244_397945 105.50 0.8760 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 35, station 35:

           sample_key  depth  value        method qc
 18NE14101_247_397952   4.70  8.955 NO2NO3_Tech_F  1
 18NE14101_247_397951  25.03  9.150 NO2NO3_Tech_F  2
 18NE14101_247_397950  50.41  9.890 NO2NO3_Tech_F  1
 18NE14101_247_397949 171.25 13.640 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 35, station 35:

           sample_key  depth  value     method qc
 18NE14101_247_397952   4.70 0.8495 PO4_Tech_F  1
 18NE14101_247_397951  25.03 0.8575 PO4_Tech_F  2
 18NE14101_247_397950  50.41 0.8970 PO4_Tech_F  1
 18NE14101_247_397949 171.25 1.0925 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 925, station 925:

           sample_key depth value        method qc
 18NE14101_368_397909  5.79 8.720 NO2NO3_Tech_F  1
 18NE14101_368_397908 25.12 8.570 NO2NO3_Tech_F  2
 18NE14101_368_397907 50.19 8.680 NO2NO3_Tech_F  1
 18NE14101_368_397906 72.90 8.845 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 925, station 925:

           sample_key depth  value     method qc
 18NE14101_368_397909  5.79 0.8810 PO4_Tech_F  1
 18NE14101_368_397908 25.12 0.8835 PO4_Tech_F  2
 18NE14101_368_397907 50.19 0.8935 PO4_Tech_F  1
 18NE14101_368_397906 72.90 0.8945 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE15015"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE15015 FLAG Report:,  2019-03-15 12:10:35
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE15017"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE15017 FLAG Report:,  2019-03-15 12:11:24
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged SALINITY, event 105, station 93:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               5.12      31.7637    0   180.6          33.3502    7
              25.35      31.7659    0   180.6          33.3502    7
              50.35      32.0154    0   180.6          33.3502    7
             180.60      33.0928    0   180.6          33.3502    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 112, station 99:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               5.19      32.0923    0  209.62          33.2466    7
              25.74      32.3316    0  209.62          33.2466    7
              50.59      33.2170    0  209.62          33.2466    7
             209.62      34.9118    0  209.62          33.2466    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 112, station 99:

 sample_key  depth O2_CTD_mLL qc
              5.19     6.1669  0
             25.74     6.6922  0
             50.59     5.8559  0
            209.62     4.2444  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 117, station 104:

 sample_key  depth value      method qc
              5.28 0.565 SiO4_Tech_F  2
             25.94 0.975 SiO4_Tech_F  1
             50.14 4.990 SiO4_Tech_F  1
            119.21 8.255 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 118, station 105:

 sample_key  depth value      method qc
              4.74 0.480 SiO4_Tech_F  2
             25.00 0.760 SiO4_Tech_F  1
             50.77 3.940 SiO4_Tech_F  1
            117.18 7.475 SiO4_Tech_F  1


-> QC repot:
      Filename Pressure Uniqueno Variable Values
 18NE15017_118    50.56   402286     slca   1.13
                                                        Test.failed
  Out of Nutrient Climatology in box(es) 8 (Min=1.39 Max=9.12 n=32)



-> Flagged SILICATE, event 128, station 115:

 sample_key  depth value      method qc
              4.37 0.345 SiO4_Tech_F  2
             25.60 0.615 SiO4_Tech_F  1
             50.30 5.665 SiO4_Tech_F  1
            115.46 8.200 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 132, station 118:

 sample_key  depth value      method qc
              4.55 0.285 SiO4_Tech_F  2
             24.64 0.655 SiO4_Tech_F  1
             50.52 2.285 SiO4_Tech_F  1
            123.86 8.730 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 135, station 120:

 sample_key  depth value      method qc
              4.79 0.215 SiO4_Tech_F  2
             24.96 0.590 SiO4_Tech_F  1
             50.14 3.685 SiO4_Tech_F  1
            215.59 9.865 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 138, station HL_02:

 sample_key  depth  value     method qc
              2.42 0.1645 PO4_Tech_F  1
              5.32 0.1730 PO4_Tech_F  1
             10.28 0.1780 PO4_Tech_F  1
             19.91 0.2670 PO4_Tech_F  1
             31.24 0.2915 PO4_Tech_F  2
             39.99 0.4955 PO4_Tech_F  1
             50.78 0.7120 PO4_Tech_F  1
             75.44 1.1540 PO4_Tech_F  1
            100.88 1.3295 PO4_Tech_F  1
            161.35 1.3695 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 155, station 139:

 sample_key depth value        method qc
             4.56     0 NO2NO3_Tech_F  7
            27.70     0 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 159, station 143:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               5.26      30.7012    0   24.62          34.6599    7
               5.26      30.7012    0  208.27          34.7113    1
              24.62      32.0764    0   24.62          34.6599    7
              24.62      32.0764    0  208.27          34.7113    1
              49.61      32.6505    0   24.62          34.6599    7
              49.61      32.6505    0  208.27          34.7113    1
             101.36      33.9460    0   24.62          34.6599    7
             101.36      33.9460    0  208.27          34.7113    1
             208.27      34.7263    0   24.62          34.6599    7
             208.27      34.7263    0  208.27          34.7113    1


-> QC repot:
      Filename    Pressure Uniqueno Variable Values
 18NE15017_159  45 to 55 m      NaN     psal  32.79
                                                           Test.failed
  Out of TS Climatology by more than 3*std in box(es) 9 (32.46  0.33)



-> Flagged NITRATE, event 185, station 168:

 sample_key depth value        method qc
             4.97     0 NO2NO3_Tech_F  7
            25.00     0 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 191, station 174:

 sample_key  depth  value        method qc
              5.55  0.000 NO2NO3_Tech_F  1
             24.88  0.155 NO2NO3_Tech_F  1
             50.61  3.495 NO2NO3_Tech_F  1
            101.69 12.535 NO2NO3_Tech_F  1
            325.72 22.840 NO2NO3_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 200, station 181:

 sample_key  depth  value      method qc
              4.43  0.350 SiO4_Tech_F  1
             24.41  0.485 SiO4_Tech_F  1
             52.96  1.370 SiO4_Tech_F  2
            102.50  5.715 SiO4_Tech_F  1
            421.09 27.240 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 201, station 182:

 sample_key  depth  value      method qc
              4.19  0.455 SiO4_Tech_F  1
             26.01  0.875 SiO4_Tech_F  1
             50.56  1.130 SiO4_Tech_F  2
            101.58  4.995 SiO4_Tech_F  1
            485.38 19.665 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 204, station 184:

 sample_key  depth  value      method qc
              4.18  0.325 SiO4_Tech_F  1
             24.68  0.385 SiO4_Tech_F  1
             50.63  0.570 SiO4_Tech_F  2
            333.22 28.710 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 212, station 192:

 sample_key  depth  value      method qc
              5.40  0.305 SiO4_Tech_F  1
             24.84  0.865 SiO4_Tech_F  1
             51.44  0.920 SiO4_Tech_F  2
            101.67  6.445 SiO4_Tech_F  1
            341.13 21.350 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 215, station 195:

 sample_key depth value        method qc
             4.75     0 NO2NO3_Tech_F  7
            25.40     0 NO2NO3_Tech_F  7
            40.14     0 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 218, station 198:

 sample_key depth  value     method qc
             5.34 0.0640 PO4_Tech_F  1
            24.88 0.0975 PO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 222, station 202:

 sample_key depth value        method qc
             5.01     0 NO2NO3_Tech_F  7
            24.44     0 NO2NO3_Tech_F  7
            31.74     0 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 223, station 203:

 sample_key depth value        method qc
             4.58     0 NO2NO3_Tech_F  7
            25.49     0 NO2NO3_Tech_F  7
            37.39     0 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 228, station 208:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               2.43      31.7023    0   69.16          32.6575    7
              24.66      31.9155    0   69.16          32.6575    7
              49.35      32.5926    0   69.16          32.6575    7
              69.16      32.9264    0   69.16          32.6575    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 244, station 224:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               5.82      31.0636    0   63.64          31.8856    7
              24.65      31.9918    0   63.64          31.8856    7
              63.64      32.6099    0   63.64          31.8856    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 244, station 224:

 sample_key depth value        method qc
             5.82     0 NO2NO3_Tech_F  7
            24.65     0 NO2NO3_Tech_F  7
            63.64     0 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 258, station HL_02:

 sample_key  depth  value     method qc
              2.11 0.1140 PO4_Tech_F  1
              4.77 0.1095 PO4_Tech_F  1
             10.17 0.1110 PO4_Tech_F  2
             19.67 0.2310 PO4_Tech_F  1
             29.92 0.3275 PO4_Tech_F  1
             40.21 0.6425 PO4_Tech_F  1
             50.34 0.9390 PO4_Tech_F  1
             75.17 1.0700 PO4_Tech_F  1
            100.56 1.2015 PO4_Tech_F  1
            157.77 1.4100 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 71, station 57:

 sample_key  depth O2_CTD_mLL qc
              4.67     6.4129  0
             24.74     7.2890  0
             50.19     6.2061  0
            106.62     4.3998  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 96, station 84:

 sample_key depth O2_CTD_mLL qc
             4.78     5.8708  0
            25.08     5.8974  0
            52.14     6.5108  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE16016"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE16016 FLAG Report:,  2019-03-15 12:13:24
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged PHOSPHATE, event 139, station 128:

 sample_key  depth  value     method qc
              5.18 0.1875 PO4_Tech_F  1
             25.10 0.5455 PO4_Tech_F  1
             50.30 0.6335 PO4_Tech_F  1
            100.52 0.9370 PO4_Tech_F  1
            290.95 1.7685 PO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 143, station 133:

 sample_key  depth O2_CTD_mLL qc
              4.98     5.7790  0
             25.58     7.5036  0
             49.98     7.4467  0
            142.88     4.6939  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 144, station 134:

 sample_key  depth  value     method qc
              5.47 0.2675 PO4_Tech_F  1
             26.00 0.4120 PO4_Tech_F  1
             51.26 0.6330 PO4_Tech_F  1
            101.12 0.9875 PO4_Tech_F  1
            331.80 1.7765 PO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 146, station 135:

 sample_key  depth  value        method qc
              4.40  0.400 NO2NO3_Tech_F  1
             25.20  0.485 NO2NO3_Tech_F  1
             50.84  7.960 NO2NO3_Tech_F  1
            100.12 12.565 NO2NO3_Tech_F  2
            447.76 21.720 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 146, station 135:

 sample_key  depth  value      method qc
              4.40  0.405 SiO4_Tech_F  1
             25.20  0.705 SiO4_Tech_F  1
             50.84  7.470 SiO4_Tech_F  1
            100.12 14.115 SiO4_Tech_F  2
            447.76 32.130 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 148, station 136:

 sample_key  depth  value        method qc
              4.49  0.420 NO2NO3_Tech_F  1
             24.97  0.665 NO2NO3_Tech_F  1
             50.57  3.975 NO2NO3_Tech_F  1
            100.32 11.495 NO2NO3_Tech_F  2
            392.33 22.235 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 148, station 136:

 sample_key  depth  value      method qc
              4.49  0.680 SiO4_Tech_F  1
             24.97  1.785 SiO4_Tech_F  1
             50.57  3.335 SiO4_Tech_F  1
            100.32 12.270 SiO4_Tech_F  2
            392.33 34.095 SiO4_Tech_F  1


-> QC repot:
      Filename Pressure Uniqueno Variable Values
 18NE16016_148     5.31   413523     slca   2.52
 18NE16016_148   145.01   413520     slca   6.58
                                                         Test.failed
  Out of Nutrient Climatology in box(es) 5 (Min=0.00 Max=2.31 n=125)
  Out of Nutrient Climatology in box(es) 5 (Min=8.30 Max=44.31 n=77)



-> Flagged OXYGEN, event 158, station 147:

 sample_key depth O2_CTD_mLL qc
             4.75     5.7972  0
            24.66     7.3554  0
            49.94     6.3063  0
            71.66     6.1798  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 168, station 156:

 sample_key depth O2_CTD_mLL qc
             4.25     5.9934  0
            25.09     6.9848  0
            34.25     6.9662  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 206, station 191:

 sample_key depth O2_CTD_mLL qc
             5.66     4.6059  0
            25.78     6.9533  0
            51.11     5.6036  0
            99.96     5.4140  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 211, station 197:

 sample_key  depth  value     method qc
              5.06 0.2015 PO4_Tech_F  1
             25.35 0.2745 PO4_Tech_F  1
             51.08 0.6070 PO4_Tech_F  1
            112.09 0.7600 PO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 212, station 198:

 sample_key  depth value     method qc
              5.05 0.176 PO4_Tech_F  1
             24.14 0.392 PO4_Tech_F  1
             50.49 0.630 PO4_Tech_F  1
            113.00 0.733 PO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 212, station 198:

 sample_key  depth value      method qc
              5.05 1.535 SiO4_Tech_F  1
             24.14 3.005 SiO4_Tech_F  1
             50.49 4.630 SiO4_Tech_F  1
            113.00 5.455 SiO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 213, station 199:

 sample_key  depth O2_CTD_mLL qc
              4.11     5.1463  0
             25.62     5.0833  0
             51.12     5.5838  0
            188.76     4.0026  0


-> QC repot:
      Filename Pressure Uniqueno Variable Values
 18NE16016_213     5.14   413719     phos   0.08
                                                        Test.failed
  Out of Nutrient Climatology in box(es) 8 (Min=0.09 Max=0.73 n=31)



-> Flagged PHOSPHATE, event 213, station 199:

 sample_key depth value     method qc
             4.11 0.000 PO4_Tech_F  2
            25.62 0.000 PO4_Tech_F  2
            51.12 0.153 PO4_Tech_F  2


-> QC repot:
      Filename Pressure Uniqueno Variable Values
 18NE16016_213     5.14   413719     phos   0.08
                                                        Test.failed
  Out of Nutrient Climatology in box(es) 8 (Min=0.09 Max=0.73 n=31)



-> Flagged NITRATE, event 216, station 201:

 sample_key  depth value        method qc
              4.67 0.265 NO2NO3_Tech_F  1
             24.68 0.330 NO2NO3_Tech_F  1
             51.89 3.030 NO2NO3_Tech_F  1
            113.29 8.590 NO2NO3_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 216, station 201:

 sample_key  depth  value     method qc
              4.67 0.2210 PO4_Tech_F  1
             24.68 0.3050 PO4_Tech_F  1
             51.89 0.5345 PO4_Tech_F  1
            113.29 0.7690 PO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 220, station 205:

 sample_key depth value      method qc
             5.00 0.770 SiO4_Tech_F  2
            23.58 1.420 SiO4_Tech_F  1
            49.79 6.945 SiO4_Tech_F  1
            94.37 8.540 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 221, station 206:

 sample_key  depth  value      method qc
              5.18  0.735 SiO4_Tech_F  2
             25.79  1.370 SiO4_Tech_F  1
             50.53  6.655 SiO4_Tech_F  1
            124.99 10.235 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 229, station 213:

 sample_key  depth value      method qc
              5.30 2.525 SiO4_Tech_F  2
             25.26 2.430 SiO4_Tech_F  1
             49.77 6.595 SiO4_Tech_F  1
            145.00 6.575 SiO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 274, station 251:

 sample_key  depth  value     method qc
              5.44 0.1550 PO4_Tech_F  1
             25.01 0.1900 PO4_Tech_F  1
             50.47 0.4345 PO4_Tech_F  1
            101.03 0.6745 PO4_Tech_F  2
            258.36 1.1435 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 288, station 309:

 sample_key  depth  value     method qc
              5.14 0.0835 PO4_Tech_F  2
             24.53 0.3420 PO4_Tech_F  1
             50.80 0.5515 PO4_Tech_F  1
            100.18 0.9190 PO4_Tech_F  1
            436.25 1.5525 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 289, station 311:

 sample_key  depth  value     method qc
              4.39 0.0870 PO4_Tech_F  2
             25.74 0.3545 PO4_Tech_F  1
             50.82 0.5645 PO4_Tech_F  1
            300.07 1.5560 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 296, station 342:

 sample_key  depth value      method qc
              4.55 0.715 SiO4_Tech_F  1
             25.42 2.595 SiO4_Tech_F  1
             49.92 7.515 SiO4_Tech_F  1
            126.71 7.325 SiO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 48, station 42:

 sample_key depth O2_CTD_mLL qc
             4.51     6.1472  0
            24.56     6.1147  0
            50.82     6.0320  0
            67.13     5.9948  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 60, station 56:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               4.39      31.3577    0   97.14           32.276    7
              24.67      31.7479    0   97.14           32.276    7
              50.01      32.1013    0   97.14           32.276    7
              97.14      32.6605    0   97.14           32.276    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE17002"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE17002 FLAG Report:,  2019-03-15 12:15:07
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged OXYGEN, event 5, station 9:

 sample_key depth O2_CTD_mLL qc
             5.46     5.0608  0
            82.70     6.3980  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 7, station 11:

 sample_key depth O2_CTD_mLL qc
             5.56     6.4008  0
            34.85     6.9676  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 8, station 12:

 sample_key depth O2_CTD_mLL qc
             4.67     6.2274  0
            66.16     6.7598  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 9, station HL_02:

 sample_key  depth O2_CTD_mLL qc
              1.87     7.6636  0
              5.60     7.6646  0
             10.29     7.6642  0
             20.80     7.6492  0
             31.43     7.6514  0
             40.41     7.2272  0
             50.76     7.2272  0
             76.70     6.7945  0
            101.19     6.7357  0
            159.22     6.4567  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE17020"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE17020 FLAG Report:,  2019-03-15 12:15:51
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged OXYGEN, event 108, station 113:

 sample_key  depth O2_CTD_mLL qc
              5.58     3.8395  0
             25.58     6.4372  0
             50.97     5.7516  0
            225.97     3.7024  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 134, station 135:

 sample_key  depth O2_CTD_mLL qc
              5.39     5.4223  0
             24.39     7.1544  0
             49.64     6.7904  0
            115.67     5.7995  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 135, station 136:

 sample_key  depth O2_CTD_mLL qc
              4.68     5.5586  0
             24.55     7.1634  0
             50.44     7.0070  0
            142.46     5.8656  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 161, station 163:

 sample_key  depth  value     method qc
              5.43 0.2130 PO4_Tech_F  1
             25.49 0.5295 PO4_Tech_F  1
             49.95 0.8560 PO4_Tech_F  1
            332.85 1.8170 PO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 161, station 163:

 sample_key  depth value      method qc
              5.43  0.68 SiO4_Tech_F  1
             25.49  1.37 SiO4_Tech_F  1
             49.95  4.72 SiO4_Tech_F  1
            332.85 30.80 SiO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 234, station 224:

 sample_key  depth  value        method qc
              5.59  0.295 NO2NO3_Tech_F  1
             24.86  2.240 NO2NO3_Tech_F  2
             49.80  4.085 NO2NO3_Tech_F  1
            211.89 18.140 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 237, station 227:

 sample_key  depth value        method qc
              4.20 0.225 NO2NO3_Tech_F  1
             24.96 0.155 NO2NO3_Tech_F  1
             50.62 2.470 NO2NO3_Tech_F  1
            120.99 7.970 NO2NO3_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 239, station 228:

 sample_key depth value      method qc
             4.93 0.310 SiO4_Tech_F  1
            25.38 0.300 SiO4_Tech_F  1
            37.77 0.475 SiO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 45, station 39:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               5.24      32.1653    0   25.17           32.435    7
              25.17      32.1638    0   25.17           32.435    7
              50.17      32.3449    0   25.17           32.435    7
              63.08      32.4319    0   25.17           32.435    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 62, station 59:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               5.20       1.4439    0    5.20           31.677    7
               5.20       1.4439    0   25.42           32.055    7
               5.20       1.4439    0   50.52           32.282    7
               5.20       1.4439    0  127.15           32.744    7
              25.42      14.0345    0    5.20           31.677    7
              25.42      14.0345    0   25.42           32.055    7
              25.42      14.0345    0   50.52           32.282    7
              25.42      14.0345    0  127.15           32.744    7
              50.52      31.3363    0    5.20           31.677    7
              50.52      31.3363    0   25.42           32.055    7
              50.52      31.3363    0   50.52           32.282    7
              50.52      31.3363    0  127.15           32.744    7
             127.15      31.8343    0    5.20           31.677    7
             127.15      31.8343    0   25.42           32.055    7
             127.15      31.8343    0   50.52           32.282    7
             127.15      31.8343    0  127.15           32.744    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 62, station 59:

 sample_key  depth O2_CTD_mLL qc
              5.20     5.4285  0
             25.42     4.7241  0
             50.52     4.3137  0
            127.15     4.3409  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 68, station 64:

 sample_key  depth O2_CTD_mLL qc
              4.39     5.9625  0
             24.72     6.5893  0
             50.63     5.8650  0
            217.14     4.1824  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 76, station 77:

 sample_key  depth  value      method qc
              5.48  0.000 SiO4_Tech_F  2
             24.60  1.585 SiO4_Tech_F  1
             50.29  4.435 SiO4_Tech_F  1
            313.90 10.450 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 77, station 78:

 sample_key  depth  value      method qc
              5.06  0.000 SiO4_Tech_F  2
             25.16  0.920 SiO4_Tech_F  1
             50.97  2.180 SiO4_Tech_F  1
            100.97  6.055 SiO4_Tech_F  1
            321.52 10.170 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 80, station 80:

 sample_key  depth value      method qc
              5.21  0.00 SiO4_Tech_F  2
             24.76  0.54 SiO4_Tech_F  1
             50.31  2.12 SiO4_Tech_F  1
            100.71  5.65 SiO4_Tech_F  1
            289.28 11.27 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 81, station 81:

 sample_key  depth  value      method qc
              5.69  0.000 SiO4_Tech_F  2
             24.77  0.650 SiO4_Tech_F  1
             50.19  3.280 SiO4_Tech_F  1
            170.89 13.665 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 90, station 90:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               5.20      34.2276    0     5.2           34.502    7
              25.40      35.1118    0     5.2           34.502    7
              51.06      35.1392    0     5.2           34.502    7
             129.95      35.4725    0     5.2           34.502    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 92, station 93:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               5.23      34.8652    0    5.23           35.277    7
              25.77      35.6377    0    5.23           35.277    7
              50.92      35.6192    0    5.23           35.277    7
             100.84      35.2641    0    5.23           35.277    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 92, station 93:

 sample_key  depth O2_CTD_mLL qc
              5.23     4.6867  0
             25.77     4.7338  0
             50.92     4.9372  0
            100.84     4.1421  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 92, station 93:

 sample_key  depth  value        method qc
              5.23 11.895 NO2NO3_Tech_F  2
             25.77  0.890 NO2NO3_Tech_F  1
             50.92  0.210 NO2NO3_Tech_F  1
            100.84  0.215 NO2NO3_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 92, station 93:

 sample_key  depth  value     method qc
              5.23 0.8040 PO4_Tech_F  1
             25.77 0.1855 PO4_Tech_F  1
             50.92 0.0885 PO4_Tech_F  2
            100.84 0.1030 PO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 92, station 93:

 sample_key  depth value      method qc
              5.23 5.825 SiO4_Tech_F  2
             25.77 0.825 SiO4_Tech_F  1
             50.92 0.240 SiO4_Tech_F  1
            100.84 0.155 SiO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE17102"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE17102 FLAG Report:,  2019-03-15 12:17:11
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged OXYGEN, event 2, station 2:

 sample_key  depth O2_CTD_mLL qc
              5.06     7.3760  0
             25.08     7.3724  0
             50.08     7.3005  0
            113.79     5.9562  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE95031"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE95031 FLAG Report:,  2019-03-15 12:17:34
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged CHLOROPHYLL, event IML1995031161, station 161:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              1.59                 0.17  1
              5.55                 0.18  1
             15.27                 0.85  1
             60.08                 0.10  1
            322.62                 0.01  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1995031161, station 161:

 sample_key  depth   value      method qc
              1.59 0.47667 PO4_Tech_SF  1
              5.55 0.42000 PO4_Tech_SF  7
             15.27 0.64000 PO4_Tech_SF  1
             60.08 0.98000 PO4_Tech_SF  1
            322.62 1.82000 PO4_Tech_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1995031161, station 161:

 sample_key  depth value       method qc
              1.59  1.03 SiO4_Tech_SF  1
              5.55  1.11 SiO4_Tech_SF  1
             15.27  1.53 SiO4_Tech_SF  7
             60.08  3.27 SiO4_Tech_SF  1
            322.62 24.70 SiO4_Tech_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1995031211, station 211:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              0.50              0.09000  2
              5.06              0.10000  1
             14.28              0.16667  1
            159.79              0.01000  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML1995031211, station 211:

 sample_key  depth    value         method qc
              0.50  1.71333 NO2NO3_Tech_SF  1
              5.06  1.57000 NO2NO3_Tech_SF  1
             14.28  1.88000 NO2NO3_Tech_SF  1
            159.79 15.47000 NO2NO3_Tech_SF  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1995031251, station 251:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              1.78                 0.08  1
              4.96                 0.11  1
             14.87                 0.15  1
             49.68                 0.15  1
            148.30                 0.03  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1995031251, station 251:

 sample_key  depth value      method qc
              1.78  0.37 PO4_Tech_SF  7
              4.96  0.38 PO4_Tech_SF  1
             14.87  0.45 PO4_Tech_SF  1
             49.68  0.92 PO4_Tech_SF  1
            148.30  1.29 PO4_Tech_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1995031251, station 251:

 sample_key  depth   value       method qc
              1.78 0.78667 SiO4_Tech_SF  1
              4.96 0.75000 SiO4_Tech_SF  1
             14.87 0.48000 SiO4_Tech_SF  7
             49.68 0.62000 SiO4_Tech_SF  1
            148.30 9.46000 SiO4_Tech_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML1995031271, station 271:

 sample_key  depth    value         method qc
              0.99  1.32333 NO2NO3_Tech_SF  2
              4.96  1.96000 NO2NO3_Tech_SF  1
             14.87  1.82000 NO2NO3_Tech_SF  1
             59.49  5.83000 NO2NO3_Tech_SF  7
            416.08 24.32000 NO2NO3_Tech_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1995031271, station 271:

 sample_key  depth value      method qc
              0.99  0.42 PO4_Tech_SF  1
              4.96  0.35 PO4_Tech_SF  1
             14.87  0.46 PO4_Tech_SF  1
             59.49  1.04 PO4_Tech_SF  1
            416.08  1.88 PO4_Tech_SF  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML199503181, station 81:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              1.69                 0.13  1
              5.16                 0.16  1
             14.77                 0.16  7
             99.44                 0.04  1
            348.46                 0.01  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML199503181, station 81:

 sample_key  depth value       method qc
              1.69  2.35 SiO4_Tech_SF  7
              5.16  1.18 SiO4_Tech_SF  2
             14.77  0.93 SiO4_Tech_SF  1
             99.44  3.57 SiO4_Tech_SF  1
            348.46 30.49 SiO4_Tech_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18OK05644"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18OK05644 FLAG Report:,  2019-03-15 12:18:07
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18OL03004"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18OL03004 FLAG Report:,  2019-03-15 12:18:35
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged SILICATE, event IML2003004311, station 311:

 sample_key  depth  value      method qc
              1.09  2.610 SiO4_Alp_SF  1
              5.06  3.250 SiO4_Alp_SF  1
             14.87  3.615 SiO4_Alp_SF  1
             24.99  4.965 SiO4_Alp_SF  1
             50.37  8.235 SiO4_Alp_SF  1
            100.04  8.680 SiO4_Alp_SF  1
            200.22 21.720 SiO4_Alp_SF  1
            300.16 31.520 SiO4_Alp_SF  1
            320.26 35.690 SiO4_Alp_SF  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML2003004341, station 341:

 sample_key  depth  value        method qc
              1.59  6.070 NO2NO3_Alp_SF  2
              5.35  6.075 NO2NO3_Alp_SF  2
             14.97  5.755 NO2NO3_Alp_SF  1
             25.09  6.950 NO2NO3_Alp_SF  2
             49.87  6.990 NO2NO3_Alp_SF  1
             99.93  6.965 NO2NO3_Alp_SF  1
            199.92 11.430 NO2NO3_Alp_SF  1
            249.64 17.530 NO2NO3_Alp_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML2003004341, station 341:

 sample_key  depth  value      method qc
              1.59  8.185 SiO4_Alp_SF  1
              5.35  8.315 SiO4_Alp_SF  2
             14.97  7.930 SiO4_Alp_SF  2
             25.09  8.645 SiO4_Alp_SF  2
             49.87  7.980 SiO4_Alp_SF  1
             99.93  7.905 SiO4_Alp_SF  1
            199.92 11.770 SiO4_Alp_SF  1
            249.64 16.785 SiO4_Alp_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18OL03019"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18OL03019 FLAG Report:,  2019-03-15 12:19:29
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18OL03064"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18OL03064 FLAG Report:,  2019-03-15 12:20:09
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18OL06008"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18OL06008 FLAG Report:,  2019-03-15 12:20:32
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged OXYGEN, event IML2006008331, station 331:

 sample_key  depth O2_CTD_mLL qc
              1.59   290.2007  0
              5.06   291.6745  0
             15.67   332.5830  0
             25.58   370.3654  0
             50.57   342.0063  0
            100.13   298.9094  0
            200.12   171.3604  0
            300.35   170.2886  0
            400.73   180.0245  0
            459.42   187.6167  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event IML2006008371, station 371:

 sample_key depth O2_CTD_mLL qc
             2.28   264.5658  0
             5.06   264.1192  0
            15.17   286.8512  0
            25.39   316.2375  0
            50.08   343.3461  0
            54.44   313.5579  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event IML2006008401, station 401:

 sample_key depth O2_CTD_mLL qc
             2.38   267.6920  0
             5.26   267.5581  0
            15.67   318.8277  0
            25.68   408.2371  0
            34.90   335.7539  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18OL16015"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18OL16015 FLAG Report:,  2019-03-15 12:21:19
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged SILICATE, event IML20160150651, station 651:

 sample_key  depth  value       method qc
              1.29  0.170 SiO4_Tech_SF  1
              5.06  0.160 SiO4_Tech_SF  1
             15.07  0.115 SiO4_Tech_SF  1
             24.59  0.120 SiO4_Tech_SF  1
             49.88  0.605 SiO4_Tech_SF  1
             99.34  7.020 SiO4_Tech_SF  1
            199.92 23.070 SiO4_Tech_SF  1
            300.06 27.325 SiO4_Tech_SF  1
            400.05 31.745 SiO4_Tech_SF  1
            452.79 34.900 SiO4_Tech_SF  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML20160150661, station 661:

 sample_key  depth    value         method qc
              1.59  0.03667 NO2NO3_Tech_SF  1
              5.06  0.05000 NO2NO3_Tech_SF  1
             15.07  0.04500 NO2NO3_Tech_SF  1
             25.48  0.07000 NO2NO3_Tech_SF  1
             49.28  0.75000 NO2NO3_Tech_SF  1
            100.24  5.61000 NO2NO3_Tech_SF  1
            201.12 20.03500 NO2NO3_Tech_SF  1
            299.57 23.38000 NO2NO3_Tech_SF  2
            317.29 23.79500 NO2NO3_Tech_SF  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event IML20160151331, station 1331:

 sample_key depth O2_CTD_mLL qc
             2.68   333.3422  0
            23.90   366.9712  0
            53.44   255.0086  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event IML20160151821, station 1821:

 sample_key depth O2_CTD_mLL qc
             1.19   298.9987  0
             5.06   297.3909  0
            15.07   290.3347  0
            15.07   290.2900  0
            25.09   288.6376  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18OL17001"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18OL17001 FLAG Report:,  2019-03-15 12:23:07
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged SALINITY, event 12, station BBL_03:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               1.84      31.1251    0    1.84           31.699    7
               1.84      31.1251    0   80.62           31.875    1
               2.32      31.1255    0    1.84           31.699    7
               2.32      31.1255    0   80.62           31.875    1
              11.05      31.1256    0    1.84           31.699    7
              11.05      31.1256    0   80.62           31.875    1
              19.89      31.1378    0    1.84           31.699    7
              19.89      31.1378    0   80.62           31.875    1
              31.00      31.3222    0    1.84           31.699    7
              31.00      31.3222    0   80.62           31.875    1
              41.17      31.5201    0    1.84           31.699    7
              41.17      31.5201    0   80.62           31.875    1
              50.52      31.7556    0    1.84           31.699    7
              50.52      31.7556    0   80.62           31.875    1
              60.00      31.8019    0    1.84           31.699    7
              60.00      31.8019    0   80.62           31.875    1
              80.62      31.8934    0    1.84           31.699    7
              80.62      31.8934    0   80.62           31.875    1
              88.62      31.9641    0    1.84           31.699    7
              88.62      31.9641    0   80.62           31.875    1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 128, station STAB_05:

 sample_key depth value      method qc
             1.83 0.000 SiO4_Tech_F  2
            19.93 0.000 SiO4_Tech_F  2
            30.01 0.000 SiO4_Tech_F  2
            39.71 0.000 SiO4_Tech_F  2
            50.25 0.155 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 130, station STAB_06:

 sample_key  depth  value      method qc
             51.02  0.000 SiO4_Tech_F  2
             60.06  2.295 SiO4_Tech_F  1
             78.39  4.205 SiO4_Tech_F  1
            100.98  7.955 SiO4_Tech_F  1
            149.97 10.855 SiO4_Tech_F  1
            201.03 13.555 SiO4_Tech_F  1
            300.36 20.810 SiO4_Tech_F  1
            400.14 25.880 SiO4_Tech_F  1
            445.57 24.285 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 134, station CSL_06:

 sample_key depth value      method qc
             1.57 0.000 SiO4_Tech_F  2
            10.34 0.000 SiO4_Tech_F  2
            20.26 0.000 SiO4_Tech_F  2
            30.05 0.000 SiO4_Tech_F  2
            39.84 1.405 SiO4_Tech_F  1
            50.39 2.755 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 137, station CSL_05:

 sample_key depth value      method qc
             1.92 0.000 SiO4_Tech_F  2
            10.15 0.000 SiO4_Tech_F  2
            19.57 0.000 SiO4_Tech_F  2
            30.06 0.000 SiO4_Tech_F  2
            40.27 3.895 SiO4_Tech_F  1
            50.62 2.540 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 139, station CSL_04:

 sample_key  depth  value        method qc
             79.49  4.910 NO2NO3_Tech_F  7
             79.69  4.240 NO2NO3_Tech_F  7
            100.29  6.645 NO2NO3_Tech_F  1
            150.36 12.535 NO2NO3_Tech_F  1
            200.06 17.145 NO2NO3_Tech_F  1
            251.08 21.115 NO2NO3_Tech_F  1
            299.82 22.090 NO2NO3_Tech_F  1
            462.28 21.900 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 140, station CSL_04:

 sample_key depth value      method qc
             2.06  0.00 SiO4_Tech_F  2
            10.06  0.00 SiO4_Tech_F  2
            19.45  0.00 SiO4_Tech_F  2
            40.00  2.49 SiO4_Tech_F  1
            50.60  3.29 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 149, station BP_01:

 sample_key  depth  value      method qc
              2.69  0.200 SiO4_Tech_F  1
             11.12  0.000 SiO4_Tech_F  2
             20.82  0.220 SiO4_Tech_F  1
             30.93  0.720 SiO4_Tech_F  1
             39.28  2.600 SiO4_Tech_F  1
             49.50  2.980 SiO4_Tech_F  1
             57.74  4.840 SiO4_Tech_F  1
             80.34  6.575 SiO4_Tech_F  1
            100.17  7.035 SiO4_Tech_F  1
            223.58 12.245 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 151, station BP_04:

 sample_key  depth  value      method qc
              2.63  0.185 SiO4_Tech_F  1
             10.41  0.000 SiO4_Tech_F  2
             20.87  0.000 SiO4_Tech_F  2
             30.55  0.435 SiO4_Tech_F  1
             39.66  3.140 SiO4_Tech_F  1
             49.87  6.080 SiO4_Tech_F  1
             59.40  6.550 SiO4_Tech_F  1
             80.36  6.590 SiO4_Tech_F  1
            100.93  7.395 SiO4_Tech_F  1
            251.45 11.395 SiO4_Tech_F  1
            382.43 15.080 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 153, station BP_05:

 sample_key  depth  value      method qc
              2.63  0.000 SiO4_Tech_F  2
              9.12  0.045 SiO4_Tech_F  2
             19.32  0.000 SiO4_Tech_F  2
             29.24  0.125 SiO4_Tech_F  1
             39.29  0.575 SiO4_Tech_F  1
             50.44  0.860 SiO4_Tech_F  1
             60.88  1.195 SiO4_Tech_F  1
             78.65  3.030 SiO4_Tech_F  1
             99.93  4.575 SiO4_Tech_F  1
            251.44 14.310 SiO4_Tech_F  1
            400.92 16.660 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 156, station BANQ_B6:

 sample_key depth value      method qc
             2.48 0.000 SiO4_Tech_F  2
            10.27 0.000 SiO4_Tech_F  2
            19.19 0.000 SiO4_Tech_F  2
            30.36 0.000 SiO4_Tech_F  2
            40.29 0.000 SiO4_Tech_F  2
            49.93 0.175 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 158, station BANQ_B5:

 sample_key  depth  value      method qc
              2.29  0.000 SiO4_Tech_F  2
             10.47  0.000 SiO4_Tech_F  2
             19.92  0.000 SiO4_Tech_F  2
             30.03  0.000 SiO4_Tech_F  2
             40.95  0.000 SiO4_Tech_F  2
             49.26  0.395 SiO4_Tech_F  1
             60.30  1.200 SiO4_Tech_F  1
             80.32  4.220 SiO4_Tech_F  1
            100.70  4.330 SiO4_Tech_F  1
            200.00 11.705 SiO4_Tech_F  1
            422.37 15.050 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 160, station BANQ_B4:

 sample_key  depth  value      method qc
              2.75  0.000 SiO4_Tech_F  2
              9.64  0.045 SiO4_Tech_F  2
             19.27  0.000 SiO4_Tech_F  2
             30.40  0.050 SiO4_Tech_F  1
             39.87  0.000 SiO4_Tech_F  2
             48.39  0.000 SiO4_Tech_F  2
             60.02  0.095 SiO4_Tech_F  1
             80.11  1.170 SiO4_Tech_F  1
             99.74  3.550 SiO4_Tech_F  1
            197.67  9.165 SiO4_Tech_F  1
            382.74 30.500 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 17, station PS_05:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
              60.12      32.5105    0  228.12           35.857    7
              75.79      32.7337    0  228.12           35.857    7
              99.66      32.9831    0  228.12           35.857    7
             125.56      33.8032    0  228.12           35.857    7
             149.99      34.7591    0  228.12           35.857    7
             177.95      35.3382    0  228.12           35.857    7
             228.12      35.1735    0  228.12           35.857    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 18, station PS_05:

 sample_key depth value        method qc
             2.41 0.195 NO2NO3_Tech_F  1
            10.00 0.210 NO2NO3_Tech_F  1
            20.16 0.235 NO2NO3_Tech_F  1
            30.72 0.235 NO2NO3_Tech_F  2
            40.64 0.435 NO2NO3_Tech_F  2
            49.60 3.860 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 20, station PS_07:

 sample_key depth value        method qc
             2.45 0.190 NO2NO3_Tech_F  1
             9.71 0.175 NO2NO3_Tech_F  1
            20.89 0.200 NO2NO3_Tech_F  1
            30.16 0.225 NO2NO3_Tech_F  1
            40.35 0.325 NO2NO3_Tech_F  2
            50.94 0.940 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 20, station PS_07:

 sample_key depth value      method qc
             2.45 0.070 SiO4_Tech_F  1
             9.71 0.160 SiO4_Tech_F  1
            20.89 0.115 SiO4_Tech_F  1
            30.16 0.495 SiO4_Tech_F  1
            40.35 0.150 SiO4_Tech_F  2
            50.94 0.710 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 26, station PS_08:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               1.79      32.2866    0    1.85           32.824    7
               1.85      32.2852    0    1.85           32.824    7
              10.60      32.3070    0    1.85           32.824    7
              20.51      32.3180    0    1.85           32.824    7
              30.01      32.3381    0    1.85           32.824    7
              39.76      32.6241    0    1.85           32.824    7
              50.41      32.7486    0    1.85           32.824    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 32, station PS_04:

 sample_key depth value      method qc
             1.89 0.110 SiO4_Tech_F  1
            10.01 0.115 SiO4_Tech_F  1
            19.53 0.110 SiO4_Tech_F  1
            30.53 0.160 SiO4_Tech_F  2
            40.10 0.320 SiO4_Tech_F  2
            51.28 1.635 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 36, station PS_01:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               1.33      31.8198    0    1.33           31.803    1
               1.33      31.8198    0   40.92           33.663    7
               1.33      31.8198    0   86.73           33.227    1
               9.97      31.8324    0    1.33           31.803    1
               9.97      31.8324    0   40.92           33.663    7
               9.97      31.8324    0   86.73           33.227    1
              20.22      31.9248    0    1.33           31.803    1
              20.22      31.9248    0   40.92           33.663    7
              20.22      31.9248    0   86.73           33.227    1
              30.79      32.0407    0    1.33           31.803    1
              30.79      32.0407    0   40.92           33.663    7
              30.79      32.0407    0   86.73           33.227    1
              40.92      32.2099    0    1.33           31.803    1
              40.92      32.2099    0   40.92           33.663    7
              40.92      32.2099    0   86.73           33.227    1
              50.62      32.5707    0    1.33           31.803    1
              50.62      32.5707    0   40.92           33.663    7
              50.62      32.5707    0   86.73           33.227    1
              60.04      32.6873    0    1.33           31.803    1
              60.04      32.6873    0   40.92           33.663    7
              60.04      32.6873    0   86.73           33.227    1
              75.91      33.2050    0    1.33           31.803    1
              75.91      33.2050    0   40.92           33.663    7
              75.91      33.2050    0   86.73           33.227    1
              86.73      33.2475    0    1.33           31.803    1
              86.73      33.2475    0   40.92           33.663    7
              86.73      33.2475    0   86.73           33.227    1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 44, station BBL_07:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
              60.55      32.9872    0  249.54           35.290    7
              60.55      32.9872    0 1498.69           34.945    7
              60.55      32.9872    0 1880.21           34.931    7
              79.86      33.2161    0  249.54           35.290    7
              79.86      33.2161    0 1498.69           34.945    7
              79.86      33.2161    0 1880.21           34.931    7
             100.14      33.1348    0  249.54           35.290    7
             100.14      33.1348    0 1498.69           34.945    7
             100.14      33.1348    0 1880.21           34.931    7
             249.54      32.1977    0  249.54           35.290    7
             249.54      32.1977    0 1498.69           34.945    7
             249.54      32.1977    0 1880.21           34.931    7
             250.19      32.3778    0  249.54           35.290    7
             250.19      32.3778    0 1498.69           34.945    7
             250.19      32.3778    0 1880.21           34.931    7
             250.39      32.3263    0  249.54           35.290    7
             250.39      32.3263    0 1498.69           34.945    7
             250.39      32.3263    0 1880.21           34.931    7
             250.72      32.3432    0  249.54           35.290    7
             250.72      32.3432    0 1498.69           34.945    7
             250.72      32.3432    0 1880.21           34.931    7
             499.33      32.6035    0  249.54           35.290    7
             499.33      32.6035    0 1498.69           34.945    7
             499.33      32.6035    0 1880.21           34.931    7
             749.35      32.6650    0  249.54           35.290    7
             749.35      32.6650    0 1498.69           34.945    7
             749.35      32.6650    0 1880.21           34.931    7
             999.59      32.6924    0  249.54           35.290    7
             999.59      32.6924    0 1498.69           34.945    7
             999.59      32.6924    0 1880.21           34.931    7
            1498.69      32.4695    0  249.54           35.290    7
            1498.69      32.4695    0 1498.69           34.945    7
            1498.69      32.4695    0 1880.21           34.931    7
            1880.21      32.2612    0  249.54           35.290    7
            1880.21      32.2612    0 1498.69           34.945    7
            1880.21      32.2612    0 1880.21           34.931    7


-> QC repot:
      Filename   Pressure Uniqueno Variable   Values
 18OL17001_044  -5 to 5 m      NaN     psal  31.09  
                                                            Test.failed
  Out of TS Climatology by more than 3*std in box(es) 68 (31.67  0.57)



-> Flagged OXYGEN, event 44, station BBL_07:

 sample_key   depth O2_CTD_mLL qc
              60.55    11.0992  0
              79.86     9.6164  0
             100.14     9.6495  0
             249.54     8.2437  0
             250.19     8.3382  0
             250.39     8.3305  0
             250.72     8.3291  0
             499.33     7.4423  0
             749.35     7.2694  0
             999.59     7.2454  0
            1498.69     6.6556  0
            1880.21     6.8356  0


-> QC repot:
      Filename   Pressure Uniqueno Variable   Values
 18OL17001_044  -5 to 5 m      NaN     psal  31.09  
 18OL17001_044       1.92   440979     slca   0.00  
 18OL17001_044      10.16   440978     slca   0.00  
 18OL17001_044      19.58   440977     slca   0.00  
 18OL17001_044      30.07   440976     slca   0.00  
                                                            Test.failed
  Out of TS Climatology by more than 3*std in box(es) 68 (31.67  0.57)
     Out of Nutrient Climatology in box(es) 8 (Min=0.09 Max=8.20 n=109)
     Out of Nutrient Climatology in box(es) 8 (Min=0.09 Max=7.37 n=170)
     Out of Nutrient Climatology in box(es) 8 (Min=0.09 Max=7.37 n=170)
     Out of Nutrient Climatology in box(es) 8 (Min=0.09 Max=7.37 n=170)



-> Flagged OXYGEN, event 65, station HL_05:

 sample_key depth O2_CTD_mLL qc
             2.67     7.5318  0
             2.85     7.5498  0
            10.28     7.5612  0
            19.60     7.7102  0
            30.07     7.4250  0
            39.33     7.2886  0
            48.52     7.1314  0
            60.18     6.8970  0
            80.45     6.5709  0
            95.60     5.6534  0


-> QC repot:
      Filename Pressure Uniqueno Variable  Values
 18OL17001_065     2.49   441084     slca  0.00  
 18OL17001_065    10.27   441083     slca  0.00  
 18OL17001_065    19.19   441082     slca  0.00  
 18OL17001_065    30.37   441081     slca  0.00  
 18OL17001_065    40.30   441080     slca  0.00  
                                                          Test.failed
   Out of Nutrient Climatology in box(es) 8 (Min=0.09 Max=8.20 n=109)
   Out of Nutrient Climatology in box(es) 8 (Min=0.09 Max=7.37 n=170)
   Out of Nutrient Climatology in box(es) 8 (Min=0.09 Max=7.37 n=170)
  Out of Nutrient Climatology in box(es) 8 (Min=0.04 Max=18.04 n=352)
  Out of Nutrient Climatology in box(es) 8 (Min=0.04 Max=18.04 n=352)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18OL17048"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18OL17048 FLAG Report:,  2019-03-15 12:24:38
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event IML20170481021, station 1021:

 sample_key depth  value         method qc
             1.78  6.155 NO2NO3_Tech_SF  1
             4.96  5.985 NO2NO3_Tech_SF  1
            14.97  4.740 NO2NO3_Tech_SF  1
            25.09  3.535 NO2NO3_Tech_SF  7
            30.04 11.720 NO2NO3_Tech_SF  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18PZ96058"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18PZ96058 FLAG Report:,  2019-03-15 12:25:17
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged CHLOROPHYLL, event IML1996058101, station 101:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              0.50                 0.20  7
             10.41                 0.26  1
             19.44                 0.27  1
             29.35                 0.30  1
             53.05                 0.13  1
             79.12                 0.09  1
            102.91                 0.06  7
            152.85                 0.02  1
            203.09                 0.01  1
            235.18                 0.01  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML1996058101, station 101:

 sample_key  depth  value        method qc
             10.41  1.010 NO2NO3_Tech_F  1
             19.44  1.050 NO2NO3_Tech_F  1
             29.35  1.190 NO2NO3_Tech_F  1
             53.05  1.335 NO2NO3_Tech_F  7
             79.12  3.430 NO2NO3_Tech_F  2
            102.91  5.335 NO2NO3_Tech_F  1
            152.85 10.130 NO2NO3_Tech_F  1
            203.09 13.925 NO2NO3_Tech_F  1
            235.18 16.060 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1996058101, station 101:

 sample_key  depth value     method qc
             10.41 0.460 PO4_Tech_F  1
             19.44 0.500 PO4_Tech_F  1
             29.35 0.555 PO4_Tech_F  7
             53.05 0.535 PO4_Tech_F  1
             79.12 0.670 PO4_Tech_F  2
            102.91 0.770 PO4_Tech_F  1
            152.85 1.095 PO4_Tech_F  1
            203.09 1.220 PO4_Tech_F  1
            235.18 1.275 PO4_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1996058101, station 101:

 sample_key  depth  value      method qc
             10.41  1.860 SiO4_Tech_F  1
             19.44  2.000 SiO4_Tech_F  7
             29.35  2.040 SiO4_Tech_F  1
             53.05  2.145 SiO4_Tech_F  1
             79.12  3.390 SiO4_Tech_F  1
            102.91  4.680 SiO4_Tech_F  1
            152.85 10.220 SiO4_Tech_F  1
            203.09 14.395 SiO4_Tech_F  7
            235.18 15.975 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML199605811, station 11:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              0.50                 0.35  1
              7.54                 0.55  1
             28.86                 0.46  7
             53.45                 0.45  1
            102.52                 0.07  1
            151.87                 0.02  1
            202.70                 0.01  1
            251.54                 0.01  1
            302.74                 0.01  1
            351.85                 0.00  1
            370.46                 0.00  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML199605811, station 11:

 sample_key  depth value        method qc
              0.50  2.14 NO2NO3_Tech_F  7
              7.54  1.42 NO2NO3_Tech_F  1
             28.86  0.73 NO2NO3_Tech_F  1
             53.45  0.91 NO2NO3_Tech_F  1
            102.52  3.87 NO2NO3_Tech_F  1
            151.87  8.41 NO2NO3_Tech_F  1
            202.70 10.68 NO2NO3_Tech_F  7
            251.54 16.02 NO2NO3_Tech_F  1
            302.74 17.87 NO2NO3_Tech_F  1
            351.85 17.82 NO2NO3_Tech_F  1
            370.46 16.68 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML199605811, station 11:

 sample_key  depth value     method qc
              0.50  0.64 PO4_Tech_F  1
              7.54  0.42 PO4_Tech_F  1
             28.86  0.35 PO4_Tech_F  1
             53.45  0.39 PO4_Tech_F  1
            102.52  0.62 PO4_Tech_F  1
            151.87  0.85 PO4_Tech_F  7
            202.70  1.07 PO4_Tech_F  1
            251.54  1.34 PO4_Tech_F  1
            302.74  1.49 PO4_Tech_F  1
            351.85  1.43 PO4_Tech_F  1
            370.46  1.35 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML199605811, station 11:

 sample_key  depth value      method qc
              0.50  2.83 SiO4_Tech_F  1
              7.54  1.93 SiO4_Tech_F  1
             28.86  1.07 SiO4_Tech_F  1
             53.45  1.35 SiO4_Tech_F  1
            102.52  3.37 SiO4_Tech_F  7
            151.87  7.03 SiO4_Tech_F  1
            202.70 12.69 SiO4_Tech_F  1
            251.54 19.36 SiO4_Tech_F  1
            302.74 28.36 SiO4_Tech_F  1
            351.85 22.01 SiO4_Tech_F  1
            370.46 21.93 SiO4_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML199605821, station 21:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              0.50                 0.36  1
              8.03                 0.41  1
             19.14                 0.39  1
             27.86                 0.43  7
             51.96                 0.44  1
            102.22                 0.25  1
            152.17                 0.03  1
            160.79                 0.02  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML199605821, station 21:

 sample_key  depth  value        method qc
              8.03  1.300 NO2NO3_Tech_F  7
             19.14  1.790 NO2NO3_Tech_F  1
             27.86  1.780 NO2NO3_Tech_F  1
             51.96  1.990 NO2NO3_Tech_F  1
            102.22  6.620 NO2NO3_Tech_F  1
            152.17 11.285 NO2NO3_Tech_F  1
            160.79 15.595 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML199605821, station 21:

 sample_key  depth value     method qc
              8.03 0.460 PO4_Tech_F  1
             19.14 0.520 PO4_Tech_F  1
             27.86 0.565 PO4_Tech_F  1
             51.96 0.490 PO4_Tech_F  1
            102.22 0.915 PO4_Tech_F  1
            152.17 1.155 PO4_Tech_F  1
            160.79 1.400 PO4_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML199605821, station 21:

 sample_key  depth  value      method qc
              8.03  2.950 SiO4_Tech_F  1
             19.14  3.330 SiO4_Tech_F  1
             27.86  3.750 SiO4_Tech_F  1
             51.96  2.815 SiO4_Tech_F  1
            102.22  8.915 SiO4_Tech_F  1
            152.17 12.490 SiO4_Tech_F  7
            160.79 18.175 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML199605831, station 31:

 sample_key  depth  value        method qc
              0.50  1.860 NO2NO3_Tech_F  1
              9.12  1.725 NO2NO3_Tech_F  7
             19.24  1.680 NO2NO3_Tech_F  1
             28.96  1.760 NO2NO3_Tech_F  1
             53.74  2.420 NO2NO3_Tech_F  1
            103.11  7.380 NO2NO3_Tech_F  7
            153.86 12.345 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML199605831, station 31:

 sample_key  depth value     method qc
              0.50 0.635 PO4_Tech_F  7
              9.12 0.570 PO4_Tech_F  1
             19.24 0.530 PO4_Tech_F  1
             28.96 0.600 PO4_Tech_F  1
             53.74 0.530 PO4_Tech_F  7
            103.11 0.955 PO4_Tech_F  1
            153.86 1.220 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML199605831, station 31:

 sample_key  depth  value      method qc
              0.50  4.460 SiO4_Tech_F  1
              9.12  4.450 SiO4_Tech_F  1
             19.24  4.370 SiO4_Tech_F  1
             28.96  4.545 SiO4_Tech_F  7
             53.74  4.160 SiO4_Tech_F  1
            103.11  8.145 SiO4_Tech_F  1
            153.86 14.820 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event IML1996058431, station 431:

 sample_key depth O2_CTD_mLL qc
             7.54   342.6315  0
            17.75   341.7383  0
            27.27   340.2645  0
            51.76   278.1425  0
            61.67   240.8960  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1996058431, station 431:

 sample_key depth Chl_a_Holm-Hansen_sF qc
             0.50                 0.45  1
             7.54                 0.37  1
            17.75                 0.45  1
            27.27                 0.35  7
            51.76                 0.05  1
            61.67                 0.07  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML1996058431, station 431:

 sample_key depth  value        method qc
             0.50  2.585 NO2NO3_Tech_F  1
             7.54  3.625 NO2NO3_Tech_F  7
            17.75  3.680 NO2NO3_Tech_F  1
            27.27  3.700 NO2NO3_Tech_F  1
            51.76 14.180 NO2NO3_Tech_F  1
            61.67 15.670 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1996058431, station 431:

 sample_key depth  value      method qc
             0.50  2.795 SiO4_Tech_F  1
             7.54  3.485 SiO4_Tech_F  1
            17.75  4.050 SiO4_Tech_F  1
            27.27  4.135 SiO4_Tech_F  1
            51.76 24.200 SiO4_Tech_F  1
            61.67 28.420 SiO4_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1996058441, station 441:

 sample_key depth Chl_a_Holm-Hansen_sF qc
             0.50                 1.04  1
             5.95                 0.32  1
            19.24                 0.17  7
            29.45                 0.39  1
            53.04                 0.20  1
            68.81                 0.15  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML1996058441, station 441:

 sample_key depth value        method qc
             0.50  4.67 NO2NO3_Tech_F  7
             5.95  4.93 NO2NO3_Tech_F  1
            19.24  4.95 NO2NO3_Tech_F  1
            29.45  4.77 NO2NO3_Tech_F  1
            53.04  4.59 NO2NO3_Tech_F  1
            68.81  9.98 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1996058441, station 441:

 sample_key depth value     method qc
             0.50 0.710 PO4_Tech_F  1
             5.95 0.720 PO4_Tech_F  1
            19.24 0.785 PO4_Tech_F  1
            29.45 0.765 PO4_Tech_F  1
            53.04 0.690 PO4_Tech_F  1
            68.81 1.460 PO4_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1996058441, station 441:

 sample_key depth  value      method qc
             0.50  5.505 SiO4_Tech_F  1
             5.95  5.320 SiO4_Tech_F  1
            19.24  5.460 SiO4_Tech_F  1
            29.45  5.115 SiO4_Tech_F  1
            53.04  4.800 SiO4_Tech_F  7
            68.81 12.905 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1996058451, station 451:

 sample_key depth Chl_a_Holm-Hansen_sF qc
             0.50                 0.42  7
             4.26                 0.37  1
            16.16                 0.62  1
            23.60                 0.41  1
            33.81                 0.54  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1996058451, station 451:

 sample_key depth value     method qc
             0.50 0.755 PO4_Tech_F  1
             4.26 0.755 PO4_Tech_F  1
            16.16 0.755 PO4_Tech_F  1
            23.60 0.685 PO4_Tech_F  7
            33.81 0.760 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1996058451, station 451:

 sample_key depth value      method qc
             0.50 5.510 SiO4_Tech_F  1
             4.26 5.435 SiO4_Tech_F  1
            16.16 5.430 SiO4_Tech_F  7
            23.60 4.925 SiO4_Tech_F  1
            33.81 5.475 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML1996058461, station 461:

 sample_key depth  value        method qc
             0.50  3.855 NO2NO3_Tech_F  1
             8.03  3.990 NO2NO3_Tech_F  1
            17.45  4.050 NO2NO3_Tech_F  1
            27.67  4.030 NO2NO3_Tech_F  1
            52.65 11.860 NO2NO3_Tech_F  7
            56.12 12.160 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1996058461, station 461:

 sample_key depth value     method qc
             0.50 0.685 PO4_Tech_F  1
             8.03 0.730 PO4_Tech_F  1
            17.45 0.710 PO4_Tech_F  7
            27.67 0.690 PO4_Tech_F  1
            52.65 1.390 PO4_Tech_F  1
            56.12 1.415 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1996058461, station 461:

 sample_key depth  value      method qc
             0.50  4.625 SiO4_Tech_F  1
             8.03  4.715 SiO4_Tech_F  7
            17.45  4.725 SiO4_Tech_F  1
            27.67  4.670 SiO4_Tech_F  1
            52.65 17.635 SiO4_Tech_F  1
            56.12 17.445 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event IML1996058471, station 471:

 sample_key depth O2_CTD_mLL qc
             8.83   326.3306  0
            19.14   323.6064  0
            28.86   322.8025  0
            53.65   278.8570  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1996058471, station 471:

 sample_key depth Chl_a_Holm-Hansen_sF qc
             0.50                 0.36  1
             8.83                 0.40  1
            19.14                 0.36  1
            28.86                 0.29  1
            53.65                 0.08  1
            67.53                 0.07  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1996058471, station 471:

 sample_key depth value     method qc
             0.50 0.565 PO4_Tech_F  1
             8.83 0.590 PO4_Tech_F  7
            19.14 0.550 PO4_Tech_F  1
            28.86 0.615 PO4_Tech_F  1
            53.65 1.110 PO4_Tech_F  1
            67.53 1.145 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1996058471, station 471:

 sample_key depth  value      method qc
             0.50  3.470 SiO4_Tech_F  7
             8.83  3.595 SiO4_Tech_F  1
            19.14  3.365 SiO4_Tech_F  1
            28.86  3.655 SiO4_Tech_F  1
            53.65 13.735 SiO4_Tech_F  1
            67.53 14.340 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1996058481, station 481:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              0.50                 0.34  1
              9.62                 0.37  1
             18.94                 0.32  1
             28.66                 0.38  1
             54.34                 0.11  1
             78.43                 0.05  1
            102.91                 0.05  7
            108.07                 0.04  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1996058481, station 481:

 sample_key  depth value     method qc
              0.50 0.580 PO4_Tech_F  1
              9.62 0.560 PO4_Tech_F  1
             18.94 0.580 PO4_Tech_F  7
             28.66 0.550 PO4_Tech_F  1
             54.34 0.975 PO4_Tech_F  1
             78.43 1.050 PO4_Tech_F  1
            102.91 1.245 PO4_Tech_F  1
            108.07 1.210 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1996058481, station 481:

 sample_key  depth  value      method qc
              0.50  3.785 SiO4_Tech_F  1
              9.62  3.585 SiO4_Tech_F  7
             18.94  3.610 SiO4_Tech_F  1
             28.66  3.510 SiO4_Tech_F  1
             54.34 10.550 SiO4_Tech_F  1
             78.43 10.635 SiO4_Tech_F  1
            102.91 13.915 SiO4_Tech_F  1
            108.07 12.785 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1996058491, station 491:

 sample_key depth Chl_a_Holm-Hansen_sF qc
             0.50                 0.40  1
            15.37                 0.36  7
            25.29                 0.29  1
            34.91                 0.21  1
            60.09                 0.05  1
            76.45                 0.05  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML1996058501, station 501:

 sample_key depth value        method qc
             0.50 2.425 NO2NO3_Tech_F  7
             4.96 2.350 NO2NO3_Tech_F  1
            17.65 2.685 NO2NO3_Tech_F  1
            27.67 2.850 NO2NO3_Tech_F  1
            47.20 8.410 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1996058501, station 501:

 sample_key depth value     method qc
             0.50 0.565 PO4_Tech_F  1
             4.96 0.500 PO4_Tech_F  1
            17.65 0.610 PO4_Tech_F  1
            27.67 0.595 PO4_Tech_F  7
            47.20 0.945 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1996058501, station 501:

 sample_key depth  value      method qc
             0.50  3.575 SiO4_Tech_F  1
             4.96  2.895 SiO4_Tech_F  1
            17.65  3.935 SiO4_Tech_F  7
            27.67  3.795 SiO4_Tech_F  1
            47.20 10.140 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1996058511, station 511:

 sample_key depth Chl_a_Holm-Hansen_sF qc
             0.99                 0.42  7
             6.45                 0.43  1
            16.36                 0.33  1
            24.30                 0.31  1
            36.19                 0.18  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1996058511, station 511:

 sample_key depth value     method qc
             0.99 0.600 PO4_Tech_F  1
             6.45 0.665 PO4_Tech_F  1
            16.36 0.620 PO4_Tech_F  1
            24.30 0.540 PO4_Tech_F  1
            36.19 0.700 PO4_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1996058511, station 511:

 sample_key depth value      method qc
             0.99 3.440 SiO4_Tech_F  1
             6.45 3.905 SiO4_Tech_F  1
            16.36 3.590 SiO4_Tech_F  7
            24.30 3.110 SiO4_Tech_F  1
            36.19 4.680 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1996058521, station 521:

 sample_key depth Chl_a_Holm-Hansen_sF qc
             0.50                 0.55  1
             3.97                 0.32  7
            18.84                 0.59  1
            26.48                 0.35  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML1996058531, station 531:

 sample_key depth value        method qc
             0.50  2.12 NO2NO3_Tech_F  1
             6.94  2.14 NO2NO3_Tech_F  7
            16.76  2.16 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1996058531, station 531:

 sample_key depth value     method qc
             0.50 0.540 PO4_Tech_F  7
             6.94 0.550 PO4_Tech_F  1
            16.76 0.585 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML199605861, station 61:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              0.50                 0.45  1
             14.87                 0.46  1
             24.79                 0.35  7
             53.25                 0.39  1
            102.42                 0.06  1
            152.56                 0.02  1
            202.20                 0.01  7
            251.14                 0.01  1
            302.04                 0.00  1
            352.04                 0.01  1
            401.54                 0.01  1
            431.92                 0.00  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML199605861, station 61:

 sample_key  depth  value        method qc
              8.53  1.805 NO2NO3_Tech_F  1
             14.87  1.200 NO2NO3_Tech_F  1
             24.79  1.475 NO2NO3_Tech_F  1
             53.25  1.140 NO2NO3_Tech_F  7
            102.42  6.135 NO2NO3_Tech_F  1
            152.56 11.605 NO2NO3_Tech_F  1
            202.20 16.630 NO2NO3_Tech_F  1
            251.14 19.465 NO2NO3_Tech_F  1
            302.04 22.640 NO2NO3_Tech_F  1
            352.04 23.680 NO2NO3_Tech_F  1
            401.54 23.615 NO2NO3_Tech_F  1
            431.92 23.730 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML199605861, station 61:

 sample_key  depth value     method qc
              8.53 0.400 PO4_Tech_F  1
             14.87 0.490 PO4_Tech_F  1
             24.79 0.480 PO4_Tech_F  1
             53.25 0.490 PO4_Tech_F  1
            102.42 0.860 PO4_Tech_F  1
            152.56 1.145 PO4_Tech_F  1
            202.20 1.310 PO4_Tech_F  1
            251.14 1.385 PO4_Tech_F  1
            302.04 1.550 PO4_Tech_F  1
            352.04 1.525 PO4_Tech_F  7
            401.54 1.745 PO4_Tech_F  1
            431.92 1.740 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML199605861, station 61:

 sample_key  depth  value      method qc
              8.53  2.140 SiO4_Tech_F  1
             14.87  2.485 SiO4_Tech_F  1
             24.79  2.660 SiO4_Tech_F  1
             53.25  2.415 SiO4_Tech_F  1
            102.42  5.440 SiO4_Tech_F  1
            152.56 12.860 SiO4_Tech_F  1
            202.20 17.885 SiO4_Tech_F  1
            251.14 19.970 SiO4_Tech_F  1
            302.04 23.370 SiO4_Tech_F  7
            352.04 28.035 SiO4_Tech_F  1
            401.54 34.645 SiO4_Tech_F  1
            431.92 34.385 SiO4_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML199605871, station 71:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              0.50                 0.43  1
              4.76                 0.27  1
             14.87                 0.37  1
             24.79                 0.30  1
             49.88                 0.16  7
             99.34                 0.05  1
            149.49                 0.02  1
            199.13                 0.01  1
            247.27                 0.01  1
            298.57                 0.00  1
            347.58                 0.00  1
            396.29                 0.00  7
            463.48                 0.01  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML199605871, station 71:

 sample_key  depth  value        method qc
              4.76  1.235 NO2NO3_Tech_F  1
             14.87  1.150 NO2NO3_Tech_F  1
             24.79  1.230 NO2NO3_Tech_F  7
             49.88  1.385 NO2NO3_Tech_F  1
             99.34  7.580 NO2NO3_Tech_F  1
            149.49 12.000 NO2NO3_Tech_F  1
            199.13 16.620 NO2NO3_Tech_F  1
            247.27 22.475 NO2NO3_Tech_F  7
            298.57 16.290 NO2NO3_Tech_F  1
            347.58 14.355 NO2NO3_Tech_F  1
            396.29 24.020 NO2NO3_Tech_F  1
            463.48 23.430 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML199605871, station 71:

 sample_key  depth value     method qc
              4.76 0.500 PO4_Tech_F  1
             14.87 0.460 PO4_Tech_F  7
             24.79 0.485 PO4_Tech_F  1
             49.88 0.480 PO4_Tech_F  1
             99.34 0.930 PO4_Tech_F  1
            149.49 1.170 PO4_Tech_F  1
            199.13 1.270 PO4_Tech_F  7
            247.27 1.550 PO4_Tech_F  1
            298.57 1.310 PO4_Tech_F  1
            347.58 1.210 PO4_Tech_F  1
            396.29 1.695 PO4_Tech_F  1
            463.48 1.740 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML199605871, station 71:

 sample_key  depth  value      method qc
              4.76  2.380 SiO4_Tech_F  1
             14.87  2.265 SiO4_Tech_F  1
             24.79  2.355 SiO4_Tech_F  1
             49.88  2.155 SiO4_Tech_F  1
             99.34  7.090 SiO4_Tech_F  1
            149.49 13.435 SiO4_Tech_F  7
            199.13 17.325 SiO4_Tech_F  1
            247.27 24.630 SiO4_Tech_F  1
            298.57 20.825 SiO4_Tech_F  1
            347.58 19.340 SiO4_Tech_F  1
            396.29 32.000 SiO4_Tech_F  1
            463.48 35.650 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML199605881, station 81:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              0.50                 0.32  1
              9.02                 0.35  1
             14.87                 0.36  7
             24.79                 0.27  1
             53.25                 0.35  1
            103.31                 0.04  1
            152.76                 0.03  1
            201.51                 0.01  1
            251.93                 0.01  1
            301.54                 0.00  1
            349.16                 0.00  1
            400.44                 0.00  1
            461.20                 0.01  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML199605881, station 81:

 sample_key  depth  value        method qc
              9.02  1.030 NO2NO3_Tech_F  1
             14.87  1.100 NO2NO3_Tech_F  1
             24.79  0.840 NO2NO3_Tech_F  1
             53.25  1.765 NO2NO3_Tech_F  1
            103.31  6.880 NO2NO3_Tech_F  7
            152.76  8.430 NO2NO3_Tech_F  1
            201.51 17.785 NO2NO3_Tech_F  1
            251.93 20.370 NO2NO3_Tech_F  1
            301.54 17.435 NO2NO3_Tech_F  1
            349.16 14.695 NO2NO3_Tech_F  7
            400.44 23.770 NO2NO3_Tech_F  1
            461.20 17.995 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML199605881, station 81:

 sample_key  depth value     method qc
              9.02 0.450 PO4_Tech_F  1
             14.87 0.490 PO4_Tech_F  1
             24.79 0.400 PO4_Tech_F  1
             53.25 0.495 PO4_Tech_F  7
            103.31 0.775 PO4_Tech_F  1
            152.76 0.905 PO4_Tech_F  2
            201.51 1.335 PO4_Tech_F  1
            251.93 1.450 PO4_Tech_F  1
            301.54 1.235 PO4_Tech_F  7
            349.16 1.040 PO4_Tech_F  1
            400.44 1.720 PO4_Tech_F  7
            461.20 1.395 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML199605881, station 81:

 sample_key  depth  value      method qc
              9.02  1.755 SiO4_Tech_F  7
             14.87  1.900 SiO4_Tech_F  1
             24.79  1.555 SiO4_Tech_F  1
             53.25  2.075 SiO4_Tech_F  1
            103.31  6.600 SiO4_Tech_F  1
            152.76  9.245 SiO4_Tech_F  1
            201.51 17.625 SiO4_Tech_F  1
            251.93 21.140 SiO4_Tech_F  1
            301.54 17.155 SiO4_Tech_F  1
            349.16 16.860 SiO4_Tech_F  1
            400.44 33.715 SiO4_Tech_F  1
            461.20 27.525 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML199605891, station 91:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              0.50                 0.71  7
              8.92                 0.38  1
             14.87                 0.34  1
             24.79                 0.40  1
             52.65                 0.50  1
            101.92                 0.05  1
            152.76                 0.02  1
            196.25                 0.02  1
            247.86                 0.01  1
            300.05                 0.01  1
            349.36                 0.01  1
            399.84                 0.00  7
            435.17                 0.01  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML199605891, station 91:

 sample_key  depth  value        method qc
              0.50  1.345 NO2NO3_Tech_F  1
              8.92  0.750 NO2NO3_Tech_F  1
             14.87  0.825 NO2NO3_Tech_F  1
             24.79  1.175 NO2NO3_Tech_F  1
             52.65  1.070 NO2NO3_Tech_F  7
            101.92  7.975 NO2NO3_Tech_F  1
            152.76  9.960 NO2NO3_Tech_F  1
            196.25 11.420 NO2NO3_Tech_F  1
            247.86 18.680 NO2NO3_Tech_F  1
            300.05 23.475 NO2NO3_Tech_F  7
            349.36 19.355 NO2NO3_Tech_F  1
            399.84 19.865 NO2NO3_Tech_F  1
            435.17 21.885 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML199605891, station 91:

 sample_key  depth value     method qc
              0.50 0.520 PO4_Tech_F  1
              8.92 0.430 PO4_Tech_F  7
             14.87 0.425 PO4_Tech_F  1
             24.79 0.465 PO4_Tech_F  1
             52.65 0.390 PO4_Tech_F  1
            101.92 0.965 PO4_Tech_F  1
            152.76 1.010 PO4_Tech_F  1
            196.25 0.965 PO4_Tech_F  1
            247.86 1.290 PO4_Tech_F  7
            300.05 1.585 PO4_Tech_F  1
            349.36 1.320 PO4_Tech_F  1
            399.84 1.490 PO4_Tech_F  1
            435.17 1.590 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML199605891, station 91:

 sample_key  depth  value      method qc
              0.50  1.605 SiO4_Tech_F  1
              8.92  1.460 SiO4_Tech_F  1
             14.87  1.545 SiO4_Tech_F  1
             24.79  1.535 SiO4_Tech_F  7
             52.65  1.515 SiO4_Tech_F  1
            101.92  7.265 SiO4_Tech_F  1
            152.76 10.640 SiO4_Tech_F  1
            196.25 11.000 SiO4_Tech_F  7
            247.86 16.905 SiO4_Tech_F  1
            300.05 23.805 SiO4_Tech_F  1
            349.36 19.425 SiO4_Tech_F  1
            399.84 28.495 SiO4_Tech_F  1
            435.17 31.895 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL00002"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL00002 FLAG Report:,  2019-03-15 12:26:49
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged PHOSPHATE, event 1, station STN27:

           sample_key depth value method qc
 18TL00002_002_197910     7  0.79  PO4_0  1
 18TL00002_002_197909    11  0.86  PO4_0  1
 18TL00002_002_197908    20  0.84  PO4_0  1
 18TL00002_002_197907    31  0.87  PO4_0  3
 18TL00002_002_197906    41  0.87  PO4_0  1
 18TL00002_002_197905    52  1.63  PO4_0  1
 18TL00002_002_197904    76  1.74  PO4_0  1
 18TL00002_002_197903   100  1.78  PO4_0  1
 18TL00002_002_197902   150  2.04  PO4_0  1
 18TL00002_002_197901   167  1.98  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 1, station STN27:

           sample_key depth value method qc
 18TL00002_002_197910     7  0.31 SiO4_0  1
 18TL00002_002_197909    11  0.43 SiO4_0  1
 18TL00002_002_197908    20  0.31 SiO4_0  3
 18TL00002_002_197907    31  0.35 SiO4_0  1
 18TL00002_002_197906    41  0.40 SiO4_0  1
 18TL00002_002_197905    52  2.93 SiO4_0  7
 18TL00002_002_197904    76  5.15 SiO4_0  1
 18TL00002_002_197903   100  6.39 SiO4_0  1
 18TL00002_002_197902   150  9.05 SiO4_0  1
 18TL00002_002_197901   167  9.55 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 104, station FC-12:

           sample_key depth value method qc
 18TL00002_008_221206     6  0.75  PO4_0  3
 18TL00002_008_221205    10  0.68  PO4_0  1
 18TL00002_008_221204    20  0.77  PO4_0  1
 18TL00002_008_221203    30  0.80  PO4_0  1
 18TL00002_008_221202    40  0.98  PO4_0  1
 18TL00002_008_221201    50  1.56  PO4_0  1
 18TL00002_008_221200    76  1.95  PO4_0  1
 18TL00002_008_221199   101  1.97  PO4_0  1
 18TL00002_008_221198   130  2.13  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 104, station FC-12:

           sample_key depth value method qc
 18TL00002_008_221206     6  0.26 SiO4_0  1
 18TL00002_008_221205    10  0.13 SiO4_0  1
 18TL00002_008_221204    20  0.31 SiO4_0  7
 18TL00002_008_221203    30  0.23 SiO4_0  1
 18TL00002_008_221202    40  0.36 SiO4_0  1
 18TL00002_008_221201    50  0.57 SiO4_0  1
 18TL00002_008_221200    76  5.29 SiO4_0  1
 18TL00002_008_221199   101  7.80 SiO4_0  1
 18TL00002_008_221198   130 10.24 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 11, station SEGB-05:

           sample_key depth value   method qc
 18TL00002_014_197932     5  1.00 NO2NO3_0  1
 18TL00002_014_197931    10  0.93 NO2NO3_0  2
 18TL00002_014_197930    20  0.77 NO2NO3_0  1
 18TL00002_014_197929    30  0.40 NO2NO3_0  1
 18TL00002_014_197928    39  0.62 NO2NO3_0  1
 18TL00002_014_197927    50  0.58 NO2NO3_0  7
 18TL00002_014_197926    83 10.03 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 11, station SEGB-05:

           sample_key depth value method qc
 18TL00002_014_197932     5  0.66  PO4_0  1
 18TL00002_014_197931    10  0.75  PO4_0  1
 18TL00002_014_197930    20  0.79  PO4_0  1
 18TL00002_014_197929    30  0.76  PO4_0  1
 18TL00002_014_197928    39  0.66  PO4_0  1
 18TL00002_014_197927    50  0.68  PO4_0  7
 18TL00002_014_197926    83  2.09  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 11, station SEGB-05:

           sample_key depth value method qc
 18TL00002_014_197932     5  0.02 SiO4_0  1
 18TL00002_014_197931    10  0.08 SiO4_0  2
 18TL00002_014_197930    20  0.11 SiO4_0  1
 18TL00002_014_197929    30  0.17 SiO4_0  1
 18TL00002_014_197928    39  0.08 SiO4_0  1
 18TL00002_014_197927    50  0.04 SiO4_0  1
 18TL00002_014_197926    83 12.44 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 12, station SEGB-06:

           sample_key depth value   method qc
 18TL00002_025_197939     5  1.90 NO2NO3_0  1
 18TL00002_025_197938     9  1.91 NO2NO3_0  1
 18TL00002_025_197937    19  1.81 NO2NO3_0  1
 18TL00002_025_197936    29  1.79 NO2NO3_0  1
 18TL00002_025_197935    39  1.61 NO2NO3_0  1
 18TL00002_025_197934    49  1.68 NO2NO3_0  1
 18TL00002_025_197933    76  8.41 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 12, station SEGB-06:

           sample_key depth value method qc
 18TL00002_025_197939     5  0.85  PO4_0  1
 18TL00002_025_197938     9  0.86  PO4_0  1
 18TL00002_025_197937    19  0.85  PO4_0  1
 18TL00002_025_197936    29  0.84  PO4_0  1
 18TL00002_025_197935    39  0.71  PO4_0  1
 18TL00002_025_197934    49  0.80  PO4_0  7
 18TL00002_025_197933    76  1.48  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 12, station SEGB-06:

           sample_key depth value method qc
 18TL00002_025_197939     5  0.05 SiO4_0  1
 18TL00002_025_197938     9  0.06 SiO4_0  1
 18TL00002_025_197937    19  0.06 SiO4_0  1
 18TL00002_025_197936    29  0.02 SiO4_0  1
 18TL00002_025_197935    39  0.03 SiO4_0  1
 18TL00002_025_197934    49  0.14 SiO4_0  7
 18TL00002_025_197933    76  9.51 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 13, station SEGB-07:

           sample_key depth value   method qc
 18TL00002_036_197946     7  2.27 NO2NO3_0  1
 18TL00002_036_197945    11  2.14 NO2NO3_0  1
 18TL00002_036_197944    20  2.12 NO2NO3_0  1
 18TL00002_036_197943    30  2.14 NO2NO3_0  1
 18TL00002_036_197942    40  2.17 NO2NO3_0  1
 18TL00002_036_197941    50  2.08 NO2NO3_0  1
 18TL00002_036_197940    77  7.40 NO2NO3_0  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 15, station SEGB-09:

           sample_key depth value   method qc
 18TL00002_058_197960     5  0.00 NO2NO3_0  1
 18TL00002_058_197959    12  0.62 NO2NO3_0  1
 18TL00002_058_197958    21  0.70 NO2NO3_0  1
 18TL00002_058_197957    32  0.68 NO2NO3_0  1
 18TL00002_058_197956    40  0.68 NO2NO3_0  7
 18TL00002_058_197955    51  0.61 NO2NO3_0  1
 18TL00002_058_197954    67  1.56 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 153, station S27-06:

           sample_key depth value   method qc
 18TL00002_062_221441     5  0.00 NO2NO3_0  1
 18TL00002_062_221440    11  0.00 NO2NO3_0  1
 18TL00002_062_221439    19  0.00 NO2NO3_0  1
 18TL00002_062_221438    31  0.00 NO2NO3_0  7
 18TL00002_062_221437    39  0.00 NO2NO3_0  1
 18TL00002_062_221436    48  1.37 NO2NO3_0  1
 18TL00002_062_221435    74  7.12 NO2NO3_0  1
 18TL00002_062_221434    99  7.48 NO2NO3_0  1
 18TL00002_062_221433   138  9.32 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 153, station S27-06:

           sample_key depth value method qc
 18TL00002_062_221441     5  0.87  PO4_0  1
 18TL00002_062_221440    11  0.64  PO4_0  1
 18TL00002_062_221439    19  0.79  PO4_0  1
 18TL00002_062_221438    31  0.83  PO4_0  7
 18TL00002_062_221437    39  1.02  PO4_0  1
 18TL00002_062_221436    48  1.15  PO4_0  1
 18TL00002_062_221435    74  1.77  PO4_0  1
 18TL00002_062_221434    99  1.89  PO4_0  1
 18TL00002_062_221433   138  2.17  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 153, station S27-06:

           sample_key depth value method qc
 18TL00002_062_221441     5  0.17 SiO4_0  1
 18TL00002_062_221440    11  0.19 SiO4_0  1
 18TL00002_062_221439    19  0.09 SiO4_0  1
 18TL00002_062_221438    31  0.20 SiO4_0  1
 18TL00002_062_221437    39  0.20 SiO4_0  1
 18TL00002_062_221436    48  0.81 SiO4_0  1
 18TL00002_062_221435    74  5.97 SiO4_0  1
 18TL00002_062_221434    99  6.78 SiO4_0  1
 18TL00002_062_221433   138 11.21 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 155, station S27-04:

           sample_key depth value   method qc
 18TL00002_064_221451     6  0.00 NO2NO3_0  1
 18TL00002_064_221450    11  0.00 NO2NO3_0  1
 18TL00002_064_221449    20  0.00 NO2NO3_0  1
 18TL00002_064_221448    32  0.00 NO2NO3_0  1
 18TL00002_064_221447    40  0.00 NO2NO3_0  1
 18TL00002_064_221446    51  1.49 NO2NO3_0  1
 18TL00002_064_221445    75  6.41 NO2NO3_0  3
 18TL00002_064_221444    98  7.50 NO2NO3_0  1
 18TL00002_064_221443   151  8.89 NO2NO3_0  1
 18TL00002_064_221442   180  9.91 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 155, station S27-04:

           sample_key depth value method qc
 18TL00002_064_221451     6  0.45  PO4_0  1
 18TL00002_064_221450    11  0.37  PO4_0  1
 18TL00002_064_221449    20  0.40  PO4_0  1
 18TL00002_064_221448    32  0.39  PO4_0  1
 18TL00002_064_221447    40  1.16  PO4_0  1
 18TL00002_064_221446    51  1.28  PO4_0  1
 18TL00002_064_221445    75  1.78  PO4_0  1
 18TL00002_064_221444    98  1.99  PO4_0  1
 18TL00002_064_221443   151  1.92  PO4_0  7
 18TL00002_064_221442   180  2.28  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 155, station S27-04:

           sample_key depth value method qc
 18TL00002_064_221451     6  0.18 SiO4_0  1
 18TL00002_064_221450    11  0.00 SiO4_0  1
 18TL00002_064_221449    20  0.00 SiO4_0  1
 18TL00002_064_221448    32  0.00 SiO4_0  1
 18TL00002_064_221447    40  0.28 SiO4_0  1
 18TL00002_064_221446    51  0.50 SiO4_0  1
 18TL00002_064_221445    75  4.73 SiO4_0  1
 18TL00002_064_221444    98  6.72 SiO4_0  1
 18TL00002_064_221443   151 10.62 SiO4_0  7
 18TL00002_064_221442   180 13.44 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 157, station S27-02:

           sample_key depth value   method qc
 18TL00002_066_221461     5  0.00 NO2NO3_0  1
 18TL00002_066_221460    11  0.00 NO2NO3_0  1
 18TL00002_066_221459    20  0.00 NO2NO3_0  1
 18TL00002_066_221458    30  0.00 NO2NO3_0  1
 18TL00002_066_221457    40  0.00 NO2NO3_0  1
 18TL00002_066_221456    52  0.00 NO2NO3_0  1
 18TL00002_066_221455    77  7.11 NO2NO3_0  3
 18TL00002_066_221454    99  7.32 NO2NO3_0  1
 18TL00002_066_221453   149  8.98 NO2NO3_0  1
 18TL00002_066_221452   159  9.47 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 157, station S27-02:

           sample_key depth value method qc
 18TL00002_066_221461     5  0.39  PO4_0  1
 18TL00002_066_221460    11  0.42  PO4_0  1
 18TL00002_066_221459    20  0.39  PO4_0  1
 18TL00002_066_221458    30  0.42  PO4_0  1
 18TL00002_066_221457    40  0.41  PO4_0  1
 18TL00002_066_221456    52  0.61  PO4_0  3
 18TL00002_066_221455    77  0.93  PO4_0  1
 18TL00002_066_221454    99  0.94  PO4_0  1
 18TL00002_066_221453   149  1.04  PO4_0  7
 18TL00002_066_221452   159  1.12  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 157, station S27-02:

           sample_key depth value method qc
 18TL00002_066_221461     5  0.00 SiO4_0  1
 18TL00002_066_221460    11  0.00 SiO4_0  1
 18TL00002_066_221459    20  0.17 SiO4_0  1
 18TL00002_066_221458    30  0.00 SiO4_0  1
 18TL00002_066_221457    40  0.00 SiO4_0  1
 18TL00002_066_221456    52  0.00 SiO4_0  1
 18TL00002_066_221455    77  5.84 SiO4_0  1
 18TL00002_066_221454    99  6.10 SiO4_0  7
 18TL00002_066_221453   149  9.72 SiO4_0  7
 18TL00002_066_221452   159 12.37 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 158, station STN27:

           sample_key depth value   method qc
 18TL00002_067_221471     5  0.00 NO2NO3_0  1
 18TL00002_067_221470    10  0.00 NO2NO3_0  1
 18TL00002_067_221469    20  0.00 NO2NO3_0  1
 18TL00002_067_221468    30  0.00 NO2NO3_0  1
 18TL00002_067_221467    40  0.00 NO2NO3_0  3
 18TL00002_067_221466    50  1.00 NO2NO3_0  1
 18TL00002_067_221465    74  5.06 NO2NO3_0  1
 18TL00002_067_221464   100  5.14 NO2NO3_0  1
 18TL00002_067_221463   150  8.77 NO2NO3_0  1
 18TL00002_067_221462   165  9.10 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 158, station STN27:

           sample_key depth value method qc
 18TL00002_067_221471     5  0.46  PO4_0  1
 18TL00002_067_221470    10  0.45  PO4_0  1
 18TL00002_067_221469    20  0.42  PO4_0  1
 18TL00002_067_221468    30  0.44  PO4_0  1
 18TL00002_067_221467    40  0.39  PO4_0  1
 18TL00002_067_221466    50  0.55  PO4_0  1
 18TL00002_067_221465    74  0.89  PO4_0  7
 18TL00002_067_221464   100  0.83  PO4_0  1
 18TL00002_067_221463   150  1.06  PO4_0  1
 18TL00002_067_221462   165  1.10  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 158, station STN27:

           sample_key depth value method qc
 18TL00002_067_221471     5  0.00 SiO4_0  1
 18TL00002_067_221470    10  0.00 SiO4_0  1
 18TL00002_067_221469    20  0.00 SiO4_0  1
 18TL00002_067_221468    30  0.00 SiO4_0  1
 18TL00002_067_221467    40  0.15 SiO4_0  1
 18TL00002_067_221466    50  0.52 SiO4_0  1
 18TL00002_067_221465    74  2.39 SiO4_0  7
 18TL00002_067_221464   100  3.64 SiO4_0  1
 18TL00002_067_221463   150  9.84 SiO4_0  1
 18TL00002_067_221462   165 11.76 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 16, station SEGB-10:

           sample_key depth value method qc
 18TL00002_069_197967     6  0.22 SiO4_0  1
 18TL00002_069_197966    11  0.29 SiO4_0  1
 18TL00002_069_197965    19  0.15 SiO4_0  7
 18TL00002_069_197964    28  0.29 SiO4_0  1
 18TL00002_069_197963    39  0.18 SiO4_0  1
 18TL00002_069_197962    50  0.50 SiO4_0  1
 18TL00002_069_197961    65  1.44 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 25, station SEGB-19:

           sample_key depth value   method qc
 18TL00002_171_221018     6  4.08 NO2NO3_0  1
 18TL00002_171_221017    10  4.06 NO2NO3_0  1
 18TL00002_171_221016    20  4.13 NO2NO3_0  7
 18TL00002_171_221015    29  4.04 NO2NO3_0  7
 18TL00002_171_221014    40  4.37 NO2NO3_0  1
 18TL00002_171_221013    49  4.63 NO2NO3_0  1
 18TL00002_171_221012    74  5.67 NO2NO3_0  1
 18TL00002_171_221011    99  5.15 NO2NO3_0  1
 18TL00002_171_221010   150  7.40 NO2NO3_0  1
 18TL00002_171_221009  1500 18.07 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 25, station SEGB-19:

           sample_key depth value method qc
 18TL00002_171_221018     6  0.32  PO4_0  1
 18TL00002_171_221017    10  0.29  PO4_0  7
 18TL00002_171_221016    20  0.27  PO4_0  7
 18TL00002_171_221015    29  0.30  PO4_0  1
 18TL00002_171_221014    40  0.28  PO4_0  1
 18TL00002_171_221013    49  0.30  PO4_0  1
 18TL00002_171_221012    74  0.39  PO4_0  1
 18TL00002_171_221011    99  0.33  PO4_0  1
 18TL00002_171_221010   150  0.47  PO4_0  1
 18TL00002_171_221009  1500  1.22  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 25, station SEGB-19:

           sample_key depth value method qc
 18TL00002_171_221018     6  1.51 SiO4_0  7
 18TL00002_171_221017    10  1.78 SiO4_0  7
 18TL00002_171_221016    20  1.36 SiO4_0  1
 18TL00002_171_221015    29  1.82 SiO4_0  1
 18TL00002_171_221014    40  1.21 SiO4_0  1
 18TL00002_171_221013    49  1.33 SiO4_0  1
 18TL00002_171_221012    74  2.46 SiO4_0  7
 18TL00002_171_221011    99  1.48 SiO4_0  1
 18TL00002_171_221010   150  2.66 SiO4_0  1
 18TL00002_171_221009  1500 11.12 SiO4_0  1


-> QC repot:
      Filename Pressure Uniqueno Variable  Values
 18TL00002_025    76.84   197933     slca  9.51  
                                                         Test.failed
  Out of Nutrient Climatology in box(es) 9 (Min=0.00 Max=8.82 n=244)



-> Flagged PHOSPHATE, event 83, station STN27:

           sample_key depth value method qc
 18TL00002_330_221107     4  0.66  PO4_0  1
 18TL00002_330_221106     9  0.73  PO4_0  1
 18TL00002_330_221105    19  0.72  PO4_0  1
 18TL00002_330_221104    29  0.72  PO4_0  1
 18TL00002_330_221103    40  0.97  PO4_0  1
 18TL00002_330_221102    49  1.03  PO4_0  7
 18TL00002_330_221101    74  1.28  PO4_0  1
 18TL00002_330_221100    99  1.56  PO4_0  1
 18TL00002_330_221099   149  1.59  PO4_0  1
 18TL00002_330_221098   169  1.72  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 83, station STN27:

           sample_key depth value method qc
 18TL00002_330_221107     4  0.18 SiO4_0  1
 18TL00002_330_221106     9  0.17 SiO4_0  1
 18TL00002_330_221105    19  0.00 SiO4_0  1
 18TL00002_330_221104    29  0.00 SiO4_0  1
 18TL00002_330_221103    40  0.18 SiO4_0  7
 18TL00002_330_221102    49  1.36 SiO4_0  7
 18TL00002_330_221101    74  3.64 SiO4_0  1
 18TL00002_330_221100    99  5.88 SiO4_0  1
 18TL00002_330_221099   149  8.54 SiO4_0  1
 18TL00002_330_221098   169  9.73 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 85, station FC-01:

           sample_key depth value method qc
 18TL00002_334_221115     4  0.79  PO4_0  1
 18TL00002_334_221114     9  0.79  PO4_0  1
 18TL00002_334_221113    19  0.80  PO4_0  1
 18TL00002_334_221112    30  0.96  PO4_0  7
 18TL00002_334_221111    39  1.34  PO4_0  1
 18TL00002_334_221110    50  1.40  PO4_0  1
 18TL00002_334_221109    75  1.48  PO4_0  1
 18TL00002_334_221108    98  1.62  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 85, station FC-01:

           sample_key depth value method qc
 18TL00002_334_221115     4  0.30 SiO4_0  1
 18TL00002_334_221114     9  0.00 SiO4_0  1
 18TL00002_334_221113    19  0.01 SiO4_0  7
 18TL00002_334_221112    30  0.07 SiO4_0  7
 18TL00002_334_221111    39  2.34 SiO4_0  1
 18TL00002_334_221110    50  4.06 SiO4_0  1
 18TL00002_334_221109    75  5.25 SiO4_0  1
 18TL00002_334_221108    98  6.70 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 86, station FC-02:

           sample_key depth value method qc
 18TL00002_335_221125     5  0.71  PO4_0  1
 18TL00002_335_221124    10  0.69  PO4_0  1
 18TL00002_335_221123    20  0.73  PO4_0  1
 18TL00002_335_221122    30  0.81  PO4_0  1
 18TL00002_335_221121    40  0.79  PO4_0  1
 18TL00002_335_221120    49  1.11  PO4_0  1
 18TL00002_335_221119    75  1.33  PO4_0  1
 18TL00002_335_221118   100  1.43  PO4_0  1
 18TL00002_335_221117   148  1.56  PO4_0  1
 18TL00002_335_221116   178  1.86  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 86, station FC-02:

           sample_key depth value method qc
 18TL00002_335_221125     5  0.41 SiO4_0  1
 18TL00002_335_221124    10  0.29 SiO4_0  1
 18TL00002_335_221123    20  0.00 SiO4_0  1
 18TL00002_335_221122    30  0.05 SiO4_0  1
 18TL00002_335_221121    40  0.00 SiO4_0  1
 18TL00002_335_221120    49  0.59 SiO4_0  1
 18TL00002_335_221119    75  3.91 SiO4_0  1
 18TL00002_335_221118   100  5.87 SiO4_0  1
 18TL00002_335_221117   148  8.58 SiO4_0  1
 18TL00002_335_221116   178 13.35 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 87, station FC-03:

           sample_key depth value   method qc
 18TL00002_336_221134     5  0.07 NO2NO3_0  1
 18TL00002_336_221133    10  0.05 NO2NO3_0  1
 18TL00002_336_221132    20  0.07 NO2NO3_0  7
 18TL00002_336_221131    31  0.01 NO2NO3_0  1
 18TL00002_336_221130    40  0.01 NO2NO3_0  1
 18TL00002_336_221129    50  5.47 NO2NO3_0  1
 18TL00002_336_221128    74  6.39 NO2NO3_0  1
 18TL00002_336_221127   100  6.50 NO2NO3_0  1
 18TL00002_336_221126   152 10.15 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 87, station FC-03:

           sample_key depth value method qc
 18TL00002_336_221134     5  0.75  PO4_0  7
 18TL00002_336_221133    10  0.69  PO4_0  1
 18TL00002_336_221132    20  0.67  PO4_0  1
 18TL00002_336_221131    31  0.68  PO4_0  1
 18TL00002_336_221130    40  0.94  PO4_0  1
 18TL00002_336_221129    50  1.74  PO4_0  1
 18TL00002_336_221128    74  1.80  PO4_0  1
 18TL00002_336_221127   100  1.45  PO4_0  1
 18TL00002_336_221126   152  1.88  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 87, station FC-03:

           sample_key depth value method qc
 18TL00002_336_221134     5  0.13 SiO4_0  7
 18TL00002_336_221133    10  0.20 SiO4_0  1
 18TL00002_336_221132    20  0.11 SiO4_0  1
 18TL00002_336_221131    31  0.12 SiO4_0  1
 18TL00002_336_221130    40  0.26 SiO4_0  1
 18TL00002_336_221129    50  1.45 SiO4_0  7
 18TL00002_336_221128    74  5.36 SiO4_0  1
 18TL00002_336_221127   100  6.81 SiO4_0  1
 18TL00002_336_221126   152 14.81 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 88, station FC-04:

           sample_key depth value method qc
 18TL00002_337_221142     5  0.81  PO4_0  3
 18TL00002_337_221141    10  0.89  PO4_0  1
 18TL00002_337_221140    20  1.00  PO4_0  1
 18TL00002_337_221139    30  0.83  PO4_0  1
 18TL00002_337_221138    40  1.51  PO4_0  1
 18TL00002_337_221136    76  1.91  PO4_0  1
 18TL00002_337_221135   118  2.13  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 88, station FC-04:

           sample_key depth value method qc
 18TL00002_337_221142     5  0.09 SiO4_0  1
 18TL00002_337_221141    10  0.28 SiO4_0  1
 18TL00002_337_221140    20  1.16 SiO4_0  7
 18TL00002_337_221139    30  0.23 SiO4_0  1
 18TL00002_337_221138    40  1.40 SiO4_0  1
 18TL00002_337_221136    76  6.06 SiO4_0  1
 18TL00002_337_221135   118 15.58 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 90, station FC-06:

           sample_key depth value method qc
 18TL00002_340_221159     6  0.84  PO4_0  1
 18TL00002_340_221158    11  0.85  PO4_0  1
 18TL00002_340_221157    20  0.89  PO4_0  1
 18TL00002_340_221156    29  0.91  PO4_0  3
 18TL00002_340_221155    40  0.92  PO4_0  1
 18TL00002_340_221154    50  1.27  PO4_0  1
 18TL00002_340_221153    74  1.64  PO4_0  1
 18TL00002_340_221152    95  2.19  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 90, station FC-06:

           sample_key depth value method qc
 18TL00002_340_221159     6  0.00 SiO4_0  1
 18TL00002_340_221158    11  0.00 SiO4_0  1
 18TL00002_340_221157    20  0.00 SiO4_0  3
 18TL00002_340_221156    29  0.00 SiO4_0  1
 18TL00002_340_221155    40  0.00 SiO4_0  1
 18TL00002_340_221154    50  0.89 SiO4_0  7
 18TL00002_340_221153    74  4.46 SiO4_0  1
 18TL00002_340_221152    95 12.47 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 91, station FC-07:

           sample_key depth value   method qc
 18TL00002_353_221167     5  0.00 NO2NO3_0  1
 18TL00002_353_221166    10  0.00 NO2NO3_0  1
 18TL00002_353_221165    20  0.00 NO2NO3_0  7
 18TL00002_353_221164    29  0.00 NO2NO3_0  1
 18TL00002_353_221163    41  0.00 NO2NO3_0  1
 18TL00002_353_221162    50  0.37 NO2NO3_0  1
 18TL00002_353_221161    74  7.21 NO2NO3_0  1
 18TL00002_353_221160    99  9.76 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL00007"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL00007 FLAG Report:,  2019-03-15 12:30:40
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 18, station FC-12:

           sample_key depth value   method qc
 18TL00007_091_221651     6  0.00 NO2NO3_0  1
 18TL00007_091_221650    11  0.00 NO2NO3_0  1
 18TL00007_091_221649    20  0.00 NO2NO3_0  1
 18TL00007_091_221648    31  0.00 NO2NO3_0  1
 18TL00007_091_221647    41  0.00 NO2NO3_0  1
 18TL00007_091_221646    51  2.83 NO2NO3_0  1
 18TL00007_091_221644    75  6.93 NO2NO3_0  1
 18TL00007_091_221645   102  8.23 NO2NO3_0  1
 18TL00007_091_221643   128  9.34 NO2NO3_0  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 18, station FC-12:

           sample_key depth value method qc
 18TL00007_091_221651     6  0.97  PO4_0  1
 18TL00007_091_221650    11  0.94  PO4_0  1
 18TL00007_091_221649    20  1.07  PO4_0  1
 18TL00007_091_221648    31  0.98  PO4_0  1
 18TL00007_091_221647    41  0.99  PO4_0  1
 18TL00007_091_221646    51  1.73  PO4_0  1
 18TL00007_091_221644    75  1.83  PO4_0  3
 18TL00007_091_221645   102  1.82  PO4_0  1
 18TL00007_091_221643   128  2.14  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 4, station FC-01:

           sample_key depth value   method qc
 18TL00007_264_221489     6  0.00 NO2NO3_0  1
 18TL00007_264_221488    10  0.05 NO2NO3_0  1
 18TL00007_264_221487    20  0.05 NO2NO3_0  7
 18TL00007_264_221486    31  1.54 NO2NO3_0  1
 18TL00007_264_221485    40  2.45 NO2NO3_0  1
 18TL00007_264_221484    51  2.84 NO2NO3_0  1
 18TL00007_264_221483    75  4.25 NO2NO3_0  1
 18TL00007_264_221482    91  4.83 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 6, station FC-03:

           sample_key depth value   method qc
 18TL00007_304_221499     5  0.00 NO2NO3_0  1
 18TL00007_304_221498    10  0.00 NO2NO3_0  1
 18TL00007_304_221497    20  0.00 NO2NO3_0  1
 18TL00007_304_221496    30  0.01 NO2NO3_0  1
 18TL00007_304_221495    40  0.00 NO2NO3_0  1
 18TL00007_304_221494    50  2.03 NO2NO3_0  1
 18TL00007_304_221492   100  9.77 NO2NO3_0  7
 18TL00007_304_221491   148 10.51 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL01003"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL01003 FLAG Report:,  2019-03-15 12:31:06
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 11, station SEGB-05:

           sample_key depth value   method qc
 18TL01003_014_222187     5  1.64 NO2NO3_0  7
 18TL01003_014_222186    10  1.69 NO2NO3_0  7
 18TL01003_014_222185    20  1.52 NO2NO3_0  1
 18TL01003_014_222184    30  1.39 NO2NO3_0  3
 18TL01003_014_222183    41  1.62 NO2NO3_0  1
 18TL01003_014_222182    51  2.06 NO2NO3_0  1
 18TL01003_014_222181    74  4.08 NO2NO3_0  1
 18TL01003_014_222180    83  5.87 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 11, station SEGB-05:

           sample_key depth value method qc
 18TL01003_014_222187     5  0.39  PO4_0  7
 18TL01003_014_222186    10  0.49  PO4_0  1
 18TL01003_014_222185    20  0.65  PO4_0  3
 18TL01003_014_222184    30  0.47  PO4_0  1
 18TL01003_014_222183    41  0.51  PO4_0  1
 18TL01003_014_222182    51  0.59  PO4_0  1
 18TL01003_014_222181    74  0.98  PO4_0  1
 18TL01003_014_222180    83  1.73  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 11, station SEGB-05:

           sample_key depth value method qc
 18TL01003_014_222187     5  0.88 SiO4_0  1
 18TL01003_014_222186    10  0.95 SiO4_0  1
 18TL01003_014_222185    20  1.09 SiO4_0  1
 18TL01003_014_222184    30  0.87 SiO4_0  1
 18TL01003_014_222183    41  0.88 SiO4_0  1
 18TL01003_014_222182    51  0.92 SiO4_0  7
 18TL01003_014_222181    74  2.62 SiO4_0  1
 18TL01003_014_222180    83  6.16 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 12, station SEGB-06:

           sample_key depth value   method qc
 18TL01003_025_222194     5  0.46 NO2NO3_0  7
 18TL01003_025_222193    10  0.57 NO2NO3_0  1
 18TL01003_025_222192    20  0.53 NO2NO3_0  1
 18TL01003_025_222191    30  0.76 NO2NO3_0  1
 18TL01003_025_222190    40  1.00 NO2NO3_0  1
 18TL01003_025_222189    50  0.24 NO2NO3_0  1
 18TL01003_025_222188    75  2.67 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 12, station SEGB-06:

           sample_key depth value method qc
 18TL01003_025_222194     5  0.32  PO4_0  1
 18TL01003_025_222193    10  0.40  PO4_0  3
 18TL01003_025_222192    20  0.32  PO4_0  1
 18TL01003_025_222191    30  0.31  PO4_0  1
 18TL01003_025_222190    40  0.43  PO4_0  1
 18TL01003_025_222189    50  0.36  PO4_0  1
 18TL01003_025_222188    75  0.77  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 12, station SEGB-06:

           sample_key depth value method qc
 18TL01003_025_222194     5  0.21 SiO4_0  1
 18TL01003_025_222193    10  0.20 SiO4_0  1
 18TL01003_025_222192    20  0.17 SiO4_0  1
 18TL01003_025_222191    30  0.18 SiO4_0  1
 18TL01003_025_222190    40  0.22 SiO4_0  1
 18TL01003_025_222189    50  1.23 SiO4_0  7
 18TL01003_025_222188    75  0.51 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 121, station STN27:

           sample_key depth value   method qc
 18TL01003_027_223197     5  3.01 NO2NO3_0  1
 18TL01003_027_223196    10  2.38 NO2NO3_0  1
 18TL01003_027_223195    20  3.09 NO2NO3_0  1
 18TL01003_027_223194    30  3.24 NO2NO3_0  1
 18TL01003_027_223193    40  3.32 NO2NO3_0  1
 18TL01003_027_223192    50  3.54 NO2NO3_0  1
 18TL01003_027_223191    75  8.34 NO2NO3_0  7
 18TL01003_027_223190    99  5.06 NO2NO3_0  1
 18TL01003_027_223189   149  6.06 NO2NO3_0  1
 18TL01003_027_223188   167  7.18 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 121, station STN27:

           sample_key depth value method qc
 18TL01003_027_223197     5  2.67 SiO4_0  1
 18TL01003_027_223196    10  2.96 SiO4_0  3
 18TL01003_027_223195    20  3.26 SiO4_0  1
 18TL01003_027_223194    30  2.44 SiO4_0  1
 18TL01003_027_223193    40  1.66 SiO4_0  1
 18TL01003_027_223192    50  2.84 SiO4_0  1
 18TL01003_027_223191    75  3.00 SiO4_0  1
 18TL01003_027_223190    99  2.35 SiO4_0  1
 18TL01003_027_223189   149  5.36 SiO4_0  1
 18TL01003_027_223188   167 11.16 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 13, station SEGB-07:

           sample_key depth value   method qc
 18TL01003_036_222683     5  0.22 NO2NO3_0  7
 18TL01003_036_222200     9  0.26 NO2NO3_0  7
 18TL01003_036_222199    20  0.70 NO2NO3_0  1
 18TL01003_036_222198    30  0.13 NO2NO3_0  1
 18TL01003_036_222197    39  0.13 NO2NO3_0  1
 18TL01003_036_222196    49  0.38 NO2NO3_0  1
 18TL01003_036_222195    74  3.17 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 13, station SEGB-07:

           sample_key depth value method qc
 18TL01003_036_222683     5  0.29  PO4_0  7
 18TL01003_036_222200     9  0.33  PO4_0  1
 18TL01003_036_222199    20  0.25  PO4_0  1
 18TL01003_036_222198    30  0.34  PO4_0  1
 18TL01003_036_222197    39  0.32  PO4_0  1
 18TL01003_036_222196    49  0.30  PO4_0  1
 18TL01003_036_222195    74  0.91  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 14, station SEGB-08:

           sample_key depth value   method qc
 18TL01003_047_222690     5  0.38 NO2NO3_0  7
 18TL01003_047_222689    10  0.57 NO2NO3_0  1
 18TL01003_047_222688    20  0.53 NO2NO3_0  1
 18TL01003_047_222687    29  0.76 NO2NO3_0  1
 18TL01003_047_222686    39  0.99 NO2NO3_0  1
 18TL01003_047_222685    50  2.22 NO2NO3_0  1
 18TL01003_047_222684    68  3.66 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 14, station SEGB-08:

           sample_key depth value method qc
 18TL01003_047_222690     5  0.30  PO4_0  1
 18TL01003_047_222689    10  0.40  PO4_0  1
 18TL01003_047_222688    20  0.32  PO4_0  1
 18TL01003_047_222687    29  0.31  PO4_0  1
 18TL01003_047_222686    39  0.52  PO4_0  1
 18TL01003_047_222685    50  0.88  PO4_0  1
 18TL01003_047_222684    68  1.29  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 14, station SEGB-08:

           sample_key depth value method qc
 18TL01003_047_222690     5  0.28 SiO4_0  1
 18TL01003_047_222689    10  0.20 SiO4_0  1
 18TL01003_047_222688    20  0.17 SiO4_0  1
 18TL01003_047_222687    29  0.18 SiO4_0  1
 18TL01003_047_222686    39  0.85 SiO4_0  7
 18TL01003_047_222685    50  1.51 SiO4_0  7
 18TL01003_047_222684    68  2.59 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 15, station SEGB-09:

           sample_key depth value   method qc
 18TL01003_058_222697     4  0.25 NO2NO3_0  1
 18TL01003_058_222696    10  0.09 NO2NO3_0  1
 18TL01003_058_222695    20  0.11 NO2NO3_0  1
 18TL01003_058_222694    30  0.11 NO2NO3_0  1
 18TL01003_058_222693    40  0.15 NO2NO3_0  1
 18TL01003_058_222692    50  1.38 NO2NO3_0  1
 18TL01003_058_222691    69  1.14 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 15, station SEGB-09:

           sample_key depth value method qc
 18TL01003_058_222697     4  0.45  PO4_0  1
 18TL01003_058_222696    10  0.49  PO4_0  1
 18TL01003_058_222695    20  0.46  PO4_0  1
 18TL01003_058_222694    30  0.50  PO4_0  1
 18TL01003_058_222693    40  0.49  PO4_0  1
 18TL01003_058_222692    50  0.53  PO4_0  7
 18TL01003_058_222691    69  0.67  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 15, station SEGB-09:

           sample_key depth value method qc
 18TL01003_058_222697     4  2.17 SiO4_0  1
 18TL01003_058_222696    10  2.03 SiO4_0  1
 18TL01003_058_222695    20  2.14 SiO4_0  1
 18TL01003_058_222694    30  2.09 SiO4_0  7
 18TL01003_058_222693    40  2.04 SiO4_0  7
 18TL01003_058_222692    50  1.25 SiO4_0  1
 18TL01003_058_222691    69  2.19 SiO4_0  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 16, station SEGB-10:

           sample_key depth value   method qc
 18TL01003_069_222704     5  0.24 NO2NO3_0  1
 18TL01003_069_222703    11  0.17 NO2NO3_0  1
 18TL01003_069_222702    20  0.17 NO2NO3_0  1
 18TL01003_069_222701    30  0.17 NO2NO3_0  1
 18TL01003_069_222700    40  0.21 NO2NO3_0  1
 18TL01003_069_222699    50  0.16 NO2NO3_0  7
 18TL01003_069_222698    67  0.56 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 16, station SEGB-10:

           sample_key depth value method qc
 18TL01003_069_222704     5  0.41  PO4_0  1
 18TL01003_069_222703    11  0.49  PO4_0  1
 18TL01003_069_222702    20  0.50  PO4_0  1
 18TL01003_069_222701    30  0.71  PO4_0  1
 18TL01003_069_222700    40  0.46  PO4_0  7
 18TL01003_069_222699    50  0.48  PO4_0  7
 18TL01003_069_222698    67  0.38  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 16, station SEGB-10:

           sample_key depth value method qc
 18TL01003_069_222704     5  2.26 SiO4_0  1
 18TL01003_069_222703    11  2.14 SiO4_0  1
 18TL01003_069_222702    20  1.76 SiO4_0  7
 18TL01003_069_222701    30  1.71 SiO4_0  7
 18TL01003_069_222700    40  2.05 SiO4_0  1
 18TL01003_069_222699    50  2.21 SiO4_0  3
 18TL01003_069_222698    67  2.16 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 17, station SEGB-11:

           sample_key depth value   method qc
 18TL01003_080_222711     5  0.17 NO2NO3_0  7
 18TL01003_080_222710    10  0.09 NO2NO3_0  1
 18TL01003_080_222708    31  0.09 NO2NO3_0  1
 18TL01003_080_222707    39  0.09 NO2NO3_0  7
 18TL01003_080_222706    51  0.15 NO2NO3_0  7
 18TL01003_080_222705    64  0.13 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 17, station SEGB-11:

           sample_key depth value method qc
 18TL01003_080_222711     5  0.41  PO4_0  1
 18TL01003_080_222710    10  0.31  PO4_0  1
 18TL01003_080_222708    31  0.33  PO4_0  7
 18TL01003_080_222707    39  0.32  PO4_0  7
 18TL01003_080_222706    51  0.51  PO4_0  1
 18TL01003_080_222705    64  0.43  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 17, station SEGB-11:

           sample_key depth value method qc
 18TL01003_080_222711     5  1.93 SiO4_0  1
 18TL01003_080_222710    10  2.67 SiO4_0  1
 18TL01003_080_222708    31  2.35 SiO4_0  1
 18TL01003_080_222707    39  2.47 SiO4_0  3
 18TL01003_080_222706    51  1.82 SiO4_0  1
 18TL01003_080_222705    64  1.79 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 18, station SEGB-12:

           sample_key depth value   method qc
 18TL01003_091_222718     5  0.10 NO2NO3_0  1
 18TL01003_091_222717    10  0.10 NO2NO3_0  1
 18TL01003_091_222716    20  0.10 NO2NO3_0  1
 18TL01003_091_222715    30  0.38 NO2NO3_0  1
 18TL01003_091_222714    40  0.13 NO2NO3_0  1
 18TL01003_091_222713    50  0.21 NO2NO3_0  1
 18TL01003_091_222712    59  0.46 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 18, station SEGB-12:

           sample_key depth value method qc
 18TL01003_091_222718     5  0.36  PO4_0  3
 18TL01003_091_222717    10  0.42  PO4_0  1
 18TL01003_091_222716    20  0.49  PO4_0  1
 18TL01003_091_222715    30  0.74  PO4_0  1
 18TL01003_091_222714    40  0.50  PO4_0  1
 18TL01003_091_222713    50  0.49  PO4_0  1
 18TL01003_091_222712    59  0.32  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 18, station SEGB-12:

           sample_key depth value method qc
 18TL01003_091_222718     5  2.75 SiO4_0  1
 18TL01003_091_222717    10  2.72 SiO4_0  1
 18TL01003_091_222716    20  3.08 SiO4_0  1
 18TL01003_091_222715    30  3.31 SiO4_0  7
 18TL01003_091_222714    40  2.96 SiO4_0  7
 18TL01003_091_222713    50  2.84 SiO4_0  1
 18TL01003_091_222712    59  0.21 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 19, station SEGB-13:

           sample_key depth value   method qc
 18TL01003_102_222725     6  0.06 NO2NO3_0  1
 18TL01003_102_222724    11  0.00 NO2NO3_0  1
 18TL01003_102_222723    21  0.00 NO2NO3_0  1
 18TL01003_102_222722    30  0.24 NO2NO3_0  7
 18TL01003_102_222721    40  0.10 NO2NO3_0  1
 18TL01003_102_222720    50  2.29 NO2NO3_0  1
 18TL01003_102_222719    60  2.43 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 21, station SEGB-15:

           sample_key depth value method qc
 18TL01003_127_222736     4  0.59  PO4_0  1
 18TL01003_127_222735    10  0.70  PO4_0  1
 18TL01003_127_222734    20  0.68  PO4_0  1
 18TL01003_127_222733    30  0.86  PO4_0  1
 18TL01003_127_222732    40  0.81  PO4_0  1
 18TL01003_127_222731    51  0.88  PO4_0  7
 18TL01003_127_222730    75  0.87  PO4_0  1
 18TL01003_127_222729    99  0.96  PO4_0  1
 18TL01003_127_222728   149  1.14  PO4_0  1
 18TL01003_127_222727   384  0.96  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 21, station SEGB-15:

           sample_key depth value method qc
 18TL01003_127_222736     4  3.19 SiO4_0  1
 18TL01003_127_222735    10  3.30 SiO4_0  1
 18TL01003_127_222734    20  3.30 SiO4_0  1
 18TL01003_127_222733    30  3.85 SiO4_0  7
 18TL01003_127_222732    40  3.57 SiO4_0  7
 18TL01003_127_222731    51  4.68 SiO4_0  1
 18TL01003_127_222730    75  6.51 SiO4_0  1
 18TL01003_127_222729    99  7.13 SiO4_0  1
 18TL01003_127_222728   149  7.92 SiO4_0  1
 18TL01003_127_222727   384  7.83 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 70, station FC-09:

           sample_key depth value   method qc
 18TL01003_316_222925     5  0.00 NO2NO3_0  7
 18TL01003_316_222924    10  0.00 NO2NO3_0  1
 18TL01003_316_222923    20  0.00 NO2NO3_0  1
 18TL01003_316_222922    30  0.00 NO2NO3_0  1
 18TL01003_316_222921    40  0.00 NO2NO3_0  1
 18TL01003_316_222920    50  0.03 NO2NO3_0  1
 18TL01003_316_222919    76  4.88 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 70, station FC-09:

           sample_key depth value method qc
 18TL01003_316_222925     5  0.30  PO4_0  1
 18TL01003_316_222924    10  0.40  PO4_0  1
 18TL01003_316_222923    20  0.28  PO4_0  1
 18TL01003_316_222922    30  0.25  PO4_0  1
 18TL01003_316_222921    40  0.33  PO4_0  1
 18TL01003_316_222920    50  0.51  PO4_0  1
 18TL01003_316_222919    76  1.33  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 70, station FC-09:

           sample_key depth value method qc
 18TL01003_316_222925     5  0.00 SiO4_0  1
 18TL01003_316_222924    10  0.00 SiO4_0  1
 18TL01003_316_222923    20  0.00 SiO4_0  1
 18TL01003_316_222922    30  0.00 SiO4_0  1
 18TL01003_316_222921    40  0.00 SiO4_0  7
 18TL01003_316_222920    50  0.13 SiO4_0  7
 18TL01003_316_222919    76  3.69 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 72, station FC-07:

           sample_key depth value   method qc
 18TL01003_318_222934     6  0.48 NO2NO3_0  7
 18TL01003_318_222933    11  0.67 NO2NO3_0  7
 18TL01003_318_222932    20  0.44 NO2NO3_0  1
 18TL01003_318_222931    30  0.72 NO2NO3_0  3
 18TL01003_318_222930    41  0.93 NO2NO3_0  1
 18TL01003_318_222929    51  2.65 NO2NO3_0  1
 18TL01003_318_222928    73  4.54 NO2NO3_0  1
 18TL01003_318_222927    95  6.46 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 72, station FC-07:

           sample_key depth value method qc
 18TL01003_318_222934     6  0.30  PO4_0  7
 18TL01003_318_222933    11  0.20  PO4_0  1
 18TL01003_318_222932    20  0.42  PO4_0  1
 18TL01003_318_222931    30  0.43  PO4_0  1
 18TL01003_318_222930    41  0.58  PO4_0  1
 18TL01003_318_222929    51  0.91  PO4_0  1
 18TL01003_318_222928    73  1.01  PO4_0  1
 18TL01003_318_222927    95  1.52  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 72, station FC-07:

           sample_key depth value method qc
 18TL01003_318_222934     6  0.28 SiO4_0  1
 18TL01003_318_222933    11  0.46 SiO4_0  1
 18TL01003_318_222932    20  0.33 SiO4_0  1
 18TL01003_318_222931    30  0.13 SiO4_0  1
 18TL01003_318_222930    41  0.25 SiO4_0  1
 18TL01003_318_222929    51  1.12 SiO4_0  7
 18TL01003_318_222928    73  3.20 SiO4_0  7
 18TL01003_318_222927    95  7.19 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 73, station FC-06:

           sample_key depth value   method qc
 18TL01003_319_222942     6  1.40 NO2NO3_0  7
 18TL01003_319_222941    10  1.56 NO2NO3_0  7
 18TL01003_319_222940    19  0.69 NO2NO3_0  1
 18TL01003_319_222939    31  1.99 NO2NO3_0  1
 18TL01003_319_222938    40  3.06 NO2NO3_0  1
 18TL01003_319_222937    50  4.15 NO2NO3_0  1
 18TL01003_319_222936    74  4.74 NO2NO3_0  1
 18TL01003_319_222935    94  5.38 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 73, station FC-06:

           sample_key depth value method qc
 18TL01003_319_222942     6  0.34  PO4_0  7
 18TL01003_319_222941    10  0.40  PO4_0  1
 18TL01003_319_222940    19  0.56  PO4_0  1
 18TL01003_319_222939    31  0.52  PO4_0  1
 18TL01003_319_222938    40  0.78  PO4_0  1
 18TL01003_319_222937    50  0.69  PO4_0  1
 18TL01003_319_222936    74  0.74  PO4_0  1
 18TL01003_319_222935    94  1.10  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 73, station FC-06:

           sample_key depth value method qc
 18TL01003_319_222942     6  0.26 SiO4_0  3
 18TL01003_319_222941    10  0.11 SiO4_0  1
 18TL01003_319_222940    19  0.49 SiO4_0  1
 18TL01003_319_222939    31  1.14 SiO4_0  1
 18TL01003_319_222938    40  1.65 SiO4_0  1
 18TL01003_319_222937    50  3.26 SiO4_0  1
 18TL01003_319_222936    74  6.40 SiO4_0  1
 18TL01003_319_222935    94  7.87 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 74, station FC-05:

           sample_key depth value   method qc
 18TL01003_320_222951     5  3.00 NO2NO3_0  1
 18TL01003_320_222950    11  1.25 NO2NO3_0  1
 18TL01003_320_222949    20  1.11 NO2NO3_0  1
 18TL01003_320_222948    31  1.85 NO2NO3_0  7
 18TL01003_320_222947    39  1.40 NO2NO3_0  7
 18TL01003_320_222946    49  1.81 NO2NO3_0  1
 18TL01003_320_222945    76  4.24 NO2NO3_0  3
 18TL01003_320_222944   101  4.25 NO2NO3_0  1
 18TL01003_320_222943   129  5.85 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 74, station FC-05:

           sample_key depth value method qc
 18TL01003_320_222951     5  0.45  PO4_0  1
 18TL01003_320_222950    11  0.39  PO4_0  1
 18TL01003_320_222949    20  0.43  PO4_0  1
 18TL01003_320_222948    31  0.54  PO4_0  7
 18TL01003_320_222947    39  0.37  PO4_0  1
 18TL01003_320_222946    49  0.53  PO4_0  1
 18TL01003_320_222945    76  0.60  PO4_0  1
 18TL01003_320_222944   101  0.65  PO4_0  1
 18TL01003_320_222943   129  0.91  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 74, station FC-05:

           sample_key depth value method qc
 18TL01003_320_222951     5  2.28 SiO4_0  1
 18TL01003_320_222950    11  1.04 SiO4_0  1
 18TL01003_320_222949    20  1.10 SiO4_0  1
 18TL01003_320_222948    31  0.93 SiO4_0  1
 18TL01003_320_222947    39  0.86 SiO4_0  1
 18TL01003_320_222946    49  1.78 SiO4_0  1
 18TL01003_320_222945    76  4.22 SiO4_0  1
 18TL01003_320_222944   101  4.28 SiO4_0  1
 18TL01003_320_222943   129  7.12 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 75, station FC-04:

           sample_key depth value   method qc
 18TL01003_321_222960     5  1.75 NO2NO3_0  1
 18TL01003_321_222959    11  1.86 NO2NO3_0  1
 18TL01003_321_222958    21  1.38 NO2NO3_0  7
 18TL01003_321_222957    30  0.67 NO2NO3_0  1
 18TL01003_321_222956    41  1.89 NO2NO3_0  1
 18TL01003_321_222955    50  3.12 NO2NO3_0  1
 18TL01003_321_222954    75  3.64 NO2NO3_0  1
 18TL01003_321_222953   100  4.26 NO2NO3_0  1
 18TL01003_321_222952   116  3.48 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 75, station FC-04:

           sample_key depth value method qc
 18TL01003_321_222960     5  0.49  PO4_0  1
 18TL01003_321_222959    11  0.51  PO4_0  1
 18TL01003_321_222958    21  0.38  PO4_0  1
 18TL01003_321_222957    30  0.22  PO4_0  1
 18TL01003_321_222956    41  0.51  PO4_0  1
 18TL01003_321_222955    50  0.80  PO4_0  1
 18TL01003_321_222954    75  0.69  PO4_0  1
 18TL01003_321_222953   100  0.76  PO4_0  1
 18TL01003_321_222952   116  0.78  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 75, station FC-04:

           sample_key depth value method qc
 18TL01003_321_222960     5  1.19 SiO4_0  1
 18TL01003_321_222959    11  0.45 SiO4_0  1
 18TL01003_321_222958    21  0.27 SiO4_0  1
 18TL01003_321_222957    30  0.00 SiO4_0  1
 18TL01003_321_222956    41  1.72 SiO4_0  1
 18TL01003_321_222955    50  1.90 SiO4_0  1
 18TL01003_321_222954    75  2.81 SiO4_0  7
 18TL01003_321_222953   100  2.76 SiO4_0  7
 18TL01003_321_222952   116  3.67 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 76, station FC-03:

           sample_key depth value method qc
 18TL01003_322_222970     6  0.46  PO4_0  1
 18TL01003_322_222969     9  0.57  PO4_0  1
 18TL01003_322_222968    21  0.46  PO4_0  1
 18TL01003_322_222967    30  0.56  PO4_0  1
 18TL01003_322_222966    40  0.67  PO4_0  1
 18TL01003_322_222965    50  0.39  PO4_0  1
 18TL01003_322_222964    76  1.13  PO4_0  7
 18TL01003_322_222963   100  0.78  PO4_0  1
 18TL01003_322_222962   124  0.90  PO4_0  1
 18TL01003_322_222961   149  0.78  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 76, station FC-03:

           sample_key depth value method qc
 18TL01003_322_222970     6  0.83 SiO4_0  1
 18TL01003_322_222969     9  1.34 SiO4_0  1
 18TL01003_322_222968    21  1.41 SiO4_0  1
 18TL01003_322_222967    30  1.04 SiO4_0  1
 18TL01003_322_222966    40  0.75 SiO4_0  7
 18TL01003_322_222965    50  0.00 SiO4_0  7
 18TL01003_322_222964    76  5.12 SiO4_0  1
 18TL01003_322_222963   100  4.12 SiO4_0  1
 18TL01003_322_222962   124  3.98 SiO4_0  1
 18TL01003_322_222961   149  7.48 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 77, station FC-02:

           sample_key depth value   method qc
 18TL01003_323_222980     5  1.73 NO2NO3_0  1
 18TL01003_323_222979    11  1.66 NO2NO3_0  1
 18TL01003_323_222978    21  1.47 NO2NO3_0  1
 18TL01003_323_222977    31  2.23 NO2NO3_0  1
 18TL01003_323_222976    40  3.18 NO2NO3_0  1
 18TL01003_323_222975    49  2.93 NO2NO3_0  1
 18TL01003_323_222974    74  4.10 NO2NO3_0  3
 18TL01003_323_222973   100  4.35 NO2NO3_0  1
 18TL01003_323_222972   149  5.80 NO2NO3_0  1
 18TL01003_323_222971   179  5.12 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 77, station FC-02:

           sample_key depth value method qc
 18TL01003_323_222980     5  0.55  PO4_0  1
 18TL01003_323_222979    11  0.52  PO4_0  1
 18TL01003_323_222978    21  0.62  PO4_0  1
 18TL01003_323_222977    31  0.66  PO4_0  1
 18TL01003_323_222976    40  0.81  PO4_0  1
 18TL01003_323_222975    49  0.92  PO4_0  3
 18TL01003_323_222974    74  0.99  PO4_0  1
 18TL01003_323_222973   100  0.93  PO4_0  1
 18TL01003_323_222972   149  0.95  PO4_0  1
 18TL01003_323_222971   179  1.09  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 77, station FC-02:

           sample_key depth value method qc
 18TL01003_323_222980     5  3.93 SiO4_0  1
 18TL01003_323_222979    11  3.73 SiO4_0  1
 18TL01003_323_222978    21  3.01 SiO4_0  1
 18TL01003_323_222977    31  2.33 SiO4_0  1
 18TL01003_323_222976    40  5.00 SiO4_0  1
 18TL01003_323_222975    49  3.59 SiO4_0  1
 18TL01003_323_222974    74  6.72 SiO4_0  1
 18TL01003_323_222973   100  6.02 SiO4_0  1
 18TL01003_323_222972   149  9.68 SiO4_0  7
 18TL01003_323_222971   179  9.75 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 78, station FC-01:

           sample_key depth value   method qc
 18TL01003_324_222988     5  2.35 NO2NO3_0  1
 18TL01003_324_222987     9  2.81 NO2NO3_0  7
 18TL01003_324_222986    19  2.63 NO2NO3_0  7
 18TL01003_324_222985    30  2.66 NO2NO3_0  1
 18TL01003_324_222984    40  2.78 NO2NO3_0  3
 18TL01003_324_222983    49  3.04 NO2NO3_0  1
 18TL01003_324_222982    74  3.52 NO2NO3_0  1
 18TL01003_324_222981    99  3.23 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 78, station FC-01:

           sample_key depth value method qc
 18TL01003_324_222988     5  0.98  PO4_0  7
 18TL01003_324_222987     9  0.66  PO4_0  7
 18TL01003_324_222986    19  0.72  PO4_0  1
 18TL01003_324_222985    30  0.58  PO4_0  3
 18TL01003_324_222984    40  0.67  PO4_0  1
 18TL01003_324_222983    49  0.74  PO4_0  1
 18TL01003_324_222982    74  0.78  PO4_0  1
 18TL01003_324_222981    99  0.74  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 81, station STN27:

           sample_key depth value   method qc
 18TL01003_328_222998     6  2.42 NO2NO3_0  1
 18TL01003_328_222997    11  2.09 NO2NO3_0  1
 18TL01003_328_222996    20  2.85 NO2NO3_0  7
 18TL01003_328_222995    30  2.13 NO2NO3_0  7
 18TL01003_328_222994    40  4.04 NO2NO3_0  1
 18TL01003_328_222992    74  2.83 NO2NO3_0  1
 18TL01003_328_222991    99  3.01 NO2NO3_0  1
 18TL01003_328_222990   150  4.21 NO2NO3_0  1
 18TL01003_328_222989   168  5.43 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 81, station STN27:

           sample_key depth value method qc
 18TL01003_328_222998     6  0.59  PO4_0  1
 18TL01003_328_222997    11  0.62  PO4_0  1
 18TL01003_328_222996    20  0.67  PO4_0  7
 18TL01003_328_222995    30  0.64  PO4_0  1
 18TL01003_328_222994    40  0.76  PO4_0  3
 18TL01003_328_222992    74  0.90  PO4_0  1
 18TL01003_328_222991    99  0.62  PO4_0  1
 18TL01003_328_222990   150  0.91  PO4_0  1
 18TL01003_328_222989   168  1.09  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 81, station STN27:

           sample_key depth value method qc
 18TL01003_328_222998     6  3.78 SiO4_0  1
 18TL01003_328_222997    11  3.16 SiO4_0  1
 18TL01003_328_222996    20  3.72 SiO4_0  3
 18TL01003_328_222995    30  3.40 SiO4_0  1
 18TL01003_328_222994    40  3.19 SiO4_0  1
 18TL01003_328_222992    74  2.95 SiO4_0  1
 18TL01003_328_222991    99  2.91 SiO4_0  1
 18TL01003_328_222990   150  5.27 SiO4_0  1
 18TL01003_328_222989   168  7.54 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 9, station SEGB-03:

           sample_key depth value method qc
 18TL01003_339_222178     5  0.64  PO4_0  1
 18TL01003_339_222177    11  0.64  PO4_0  1
 18TL01003_339_222176    21  0.65  PO4_0  3
 18TL01003_339_222175    30  0.58  PO4_0  1
 18TL01003_339_222174    40  0.57  PO4_0  1
 18TL01003_339_222173    49  0.63  PO4_0  1
 18TL01003_339_222172    75  0.71  PO4_0  1
 18TL01003_339_222171   100  0.72  PO4_0  1
 18TL01003_339_222170   148  1.73  PO4_0  1
 18TL01003_339_222169   163  0.69  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL01006"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL01006 FLAG Report:,  2019-03-15 12:32:51
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 1, station STN27:

           sample_key depth value   method qc
 18TL01006_002_253009     9  0.34 NO2NO3_0  1
 18TL01006_002_253008    20  0.00 NO2NO3_0  3
 18TL01006_002_253007    30  0.93 NO2NO3_0  1
 18TL01006_002_253006    39  0.52 NO2NO3_0  1
 18TL01006_002_253005    50  0.40 NO2NO3_0  1
 18TL01006_002_253004    74  3.92 NO2NO3_0  1
 18TL01006_002_253003   101  6.91 NO2NO3_0  1
 18TL01006_002_253002   150  7.50 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 10, station FC-07:

           sample_key depth value   method qc
 18TL01006_003_253053     6  0.00 NO2NO3_0  1
 18TL01006_003_253052    11  0.00 NO2NO3_0  1
 18TL01006_003_253051    21  0.00 NO2NO3_0  3
 18TL01006_003_253050    31  0.00 NO2NO3_0  1
 18TL01006_003_253049    41  0.00 NO2NO3_0  1
 18TL01006_003_253048    50  3.54 NO2NO3_0  1
 18TL01006_003_253047    75  7.05 NO2NO3_0  1
 18TL01006_003_253046   100  6.23 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 10, station FC-07:

           sample_key depth value method qc
 18TL01006_003_253053     6  0.31  PO4_0  1
 18TL01006_003_253052    11  0.22  PO4_0  3
 18TL01006_003_253051    21  0.16  PO4_0  1
 18TL01006_003_253050    31  0.25  PO4_0  1
 18TL01006_003_253049    41  0.43  PO4_0  1
 18TL01006_003_253048    50  1.16  PO4_0  1
 18TL01006_003_253047    75  1.49  PO4_0  1
 18TL01006_003_253046   100  1.01  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 13, station FC-10:

           sample_key depth value method qc
 18TL01006_036_253068     5  0.39  PO4_0  3
 18TL01006_036_253067    10  0.35  PO4_0  1
 18TL01006_036_253066    20  0.35  PO4_0  1
 18TL01006_036_253065    30  0.22  PO4_0  1
 18TL01006_036_253064    39  0.57  PO4_0  1
 18TL01006_036_253063    50  1.21  PO4_0  1
 18TL01006_036_253062    76  1.89  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 4, station FC-01:

           sample_key depth value method qc
 18TL01006_264_253018     6  0.39 SiO4_0  1
 18TL01006_264_253017    12  0.11 SiO4_0  1
 18TL01006_264_253016    21  0.41 SiO4_0  1
 18TL01006_264_253015    31  0.33 SiO4_0  1
 18TL01006_264_253014    40  0.30 SiO4_0  1
 18TL01006_264_253013    49  0.24 SiO4_0  3
 18TL01006_264_253012    76  3.33 SiO4_0  1
 18TL01006_264_253011    96  6.32 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 6, station FC-03:

           sample_key depth value method qc
 18TL01006_304_253027     6  0.12 SiO4_0  1
 18TL01006_304_253026    10  0.08 SiO4_0  1
 18TL01006_304_253025    21  0.18 SiO4_0  1
 18TL01006_304_253024    31  0.41 SiO4_0  1
 18TL01006_304_253023    41  0.19 SiO4_0  3
 18TL01006_304_253022    50  0.07 SiO4_0  1
 18TL01006_304_253021    75  0.91 SiO4_0  1
 18TL01006_304_253020   100  8.32 SiO4_0  1
 18TL01006_304_253019   151 16.46 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 8, station FC-05:

           sample_key depth value method qc
 18TL01006_326_253045     6  0.27 SiO4_0  1
 18TL01006_326_253044    11  0.26 SiO4_0  3
 18TL01006_326_253043    21  0.27 SiO4_0  1
 18TL01006_326_253042    31  0.93 SiO4_0  1
 18TL01006_326_253041    40  0.64 SiO4_0  1
 18TL01006_326_253040    51  3.29 SiO4_0  1
 18TL01006_326_253039    76  1.25 SiO4_0  1
 18TL01006_326_253038   101  5.89 SiO4_0  1
 18TL01006_326_253037   130  1.95 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL02005"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL02005 FLAG Report:,  2019-03-15 12:33:28
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 6, station SEGB-05:

           sample_key depth value   method qc
 18TL02005_304_254360     5  2.76 NO2NO3_0  1
 18TL02005_304_254359    10  2.68 NO2NO3_0  1
 18TL02005_304_254358    20  3.04 NO2NO3_0  1
 18TL02005_304_254357    30  2.96 NO2NO3_0  1
 18TL02005_304_254356    40  4.36 NO2NO3_0  1
 18TL02005_304_254355    49  5.10 NO2NO3_0  7
 18TL02005_304_254354    74  5.92 NO2NO3_0  1
 18TL02005_304_254353    84  5.65 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 6, station SEGB-05:

           sample_key depth value method qc
 18TL02005_304_254360     5  1.03  PO4_0  1
 18TL02005_304_254359    10  0.76  PO4_0  1
 18TL02005_304_254358    20  0.70  PO4_0  1
 18TL02005_304_254357    30  0.91  PO4_0  1
 18TL02005_304_254356    40  0.92  PO4_0  7
 18TL02005_304_254355    49  1.11  PO4_0  1
 18TL02005_304_254354    74  1.23  PO4_0  1
 18TL02005_304_254353    84  1.03  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 6, station SEGB-05:

           sample_key depth value method qc
 18TL02005_304_254360     5  1.65 SiO4_0  1
 18TL02005_304_254359    10  1.50 SiO4_0  1
 18TL02005_304_254358    20  1.15 SiO4_0  7
 18TL02005_304_254357    30  1.43 SiO4_0  1
 18TL02005_304_254356    40  3.12 SiO4_0  1
 18TL02005_304_254355    49  4.25 SiO4_0  1
 18TL02005_304_254354    74  5.57 SiO4_0  1
 18TL02005_304_254353    84  5.36 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 7, station SEGB-06:

           sample_key depth value   method qc
 18TL02005_315_254367     5  5.44 NO2NO3_0  1
 18TL02005_315_254366    10  5.27 NO2NO3_0  1
 18TL02005_315_254365    20  5.23 NO2NO3_0  1
 18TL02005_315_254364    30  5.12 NO2NO3_0  1
 18TL02005_315_254363    40  5.52 NO2NO3_0  1
 18TL02005_315_254362    49  5.52 NO2NO3_0  7
 18TL02005_315_254361    74  6.65 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 8, station SEGB-07:

           sample_key depth value method qc
 18TL02005_326_254374     5  0.74  PO4_0  1
 18TL02005_326_254373    11  0.72  PO4_0  1
 18TL02005_326_254372    21  0.76  PO4_0  1
 18TL02005_326_254371    30  0.78  PO4_0  1
 18TL02005_326_254370    40  0.70  PO4_0  1
 18TL02005_326_254369    50  0.89  PO4_0  7
 18TL02005_326_254368    76  1.13  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL02010"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL02010 FLAG Report:,  2019-03-15 12:34:28
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL03004"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL03004 FLAG Report:,  2019-03-15 12:34:58
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged SILICATE, event 49, station FC-07:

           sample_key depth value method qc
 18TL03004_283_256343     4  2.17 SiO4_0  1
 18TL03004_283_256342    10  1.89 SiO4_0  1
 18TL03004_283_256341    20  2.08 SiO4_0  3
 18TL03004_283_256340    30  2.29 SiO4_0  1
 18TL03004_283_256339    39  2.15 SiO4_0  1
 18TL03004_283_256338    49  1.61 SiO4_0  1
 18TL03004_283_256337    74  6.11 SiO4_0  1
 18TL03004_283_256336   100  8.39 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 52, station FC-04:

           sample_key depth value method qc
 18TL03004_296_256362     5  0.74  PO4_0  1
 18TL03004_296_256361    10  0.57  PO4_0  1
 18TL03004_296_256360    20  0.63  PO4_0  1
 18TL03004_296_256359    31  1.26  PO4_0  1
 18TL03004_296_256358    41  0.68  PO4_0  1
 18TL03004_296_256357    50  0.64  PO4_0  3
 18TL03004_296_256356    75  0.66  PO4_0  1
 18TL03004_296_256355   100  0.74  PO4_0  1
 18TL03004_296_256354   119  0.93  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 52, station FC-04:

           sample_key depth value method qc
 18TL03004_296_256362     5  2.63 SiO4_0  1
 18TL03004_296_256361    10  1.73 SiO4_0  1
 18TL03004_296_256360    20  1.63 SiO4_0  1
 18TL03004_296_256359    31  6.77 SiO4_0  4
 18TL03004_296_256358    41  1.06 SiO4_0  1
 18TL03004_296_256357    50  1.76 SiO4_0  1
 18TL03004_296_256356    75  1.58 SiO4_0  1
 18TL03004_296_256355   100  2.88 SiO4_0  1
 18TL03004_296_256354   119  8.16 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL04021"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL04021 FLAG Report:,  2019-03-15 12:35:25
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged OXYGEN, event IML2004021361, station 361:

 sample_key  depth O2_CTD_mLL qc
              1.59   308.3773  0
              4.86   310.5656  0
             14.18   317.1307  0
             24.19   324.8122  0
             52.95   313.9598  0
             98.65   300.2492  0
            198.63   202.8457  0
            250.44   160.8207  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML2004021401, station 401:

 sample_key  depth  value        method qc
              4.66  0.555 NO2NO3_Alp_SF  1
             14.38  0.175 NO2NO3_Alp_SF  1
             25.29  0.295 NO2NO3_Alp_SF  2
             51.17  0.925 NO2NO3_Alp_SF  1
            100.63  4.460 NO2NO3_Alp_SF  1
            175.16 15.985 NO2NO3_Alp_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL04033"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL04033 FLAG Report:,  2019-03-15 12:35:58
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL04524"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL04524 FLAG Report:,  2019-03-15 12:36:35
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL05035"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL05035 FLAG Report:,  2019-03-15 12:37:05
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged OXYGEN, event IML2005035591, station 591:

 sample_key depth O2_CTD_mLL qc
             1.79   313.9151  0
             5.45   313.6918  0
            15.67   331.3325  0
            25.68   333.6549  0
            50.47   324.4549  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL05045"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL05045 FLAG Report:,  2019-03-15 12:37:28
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged OXYGEN, event IML2005045231, station 231:

 sample_key  depth O2_CTD_mLL qc
              1.09   267.6920  0
            249.74   168.8148  0
            423.08   202.3545  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event IML2005045371, station 371:

 sample_key  depth O2_CTD_mLL qc
              2.48   268.9425  0
            249.54   170.5119  0
            495.02   203.0690  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL05601"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL05601 FLAG Report:,  2019-03-15 12:37:50
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged PHOSPHATE, event 53, station STN27:

           sample_key depth value method qc
 18TL05601_297_259898     4  0.31  PO4_0  1
 18TL05601_297_259897    10  0.52  PO4_0  1
 18TL05601_297_259896    20  0.28  PO4_0  1
 18TL05601_297_259895    30  0.31  PO4_0  1
 18TL05601_297_259894    40  0.27  PO4_0  2
 18TL05601_297_259893    49  0.26  PO4_0  2
 18TL05601_297_259892    75  0.46  PO4_0  1
 18TL05601_297_259891    99  0.72  PO4_0  1
 18TL05601_297_259890   149  1.16  PO4_0  1
 18TL05601_297_259889   172  1.30  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL06043"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)
