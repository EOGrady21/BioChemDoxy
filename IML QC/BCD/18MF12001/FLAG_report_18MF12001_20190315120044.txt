
> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18MF12001 FLAG Report:,  2019-03-15 12:00:44
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18MT71031"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18MT71031 FLAG Report:,  2019-03-15 12:02:04
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18MT71036"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18MT71036 FLAG Report:,  2019-03-15 12:02:41
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged PHOSPHATE, event IML1971036F1721, station F1721:

 sample_key depth value     method qc
                0  1.06 PO4_Tech_F  1
                4  1.13 PO4_Tech_F  1
                7  1.03 PO4_Tech_F  1
               11  1.19 PO4_Tech_F  1
               18  1.06 PO4_Tech_F  7
               36  1.08 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18MT71044"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18MT71044 FLAG Report:,  2019-03-15 12:03:01
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NA95908"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NA95908 FLAG Report:,  2019-03-15 12:03:26
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 1, station CAST#1:

           sample_key depth value   method qc
 18NA95908_002_152244     5  0.00 NO2NO3_0  1
 18NA95908_002_152203     5  0.28 NO2NO3_0  7
 18NA95908_002_152202    25  0.00 NO2NO3_0  1
 18NA95908_002_152201    44  0.00 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 1, station CAST#1:

           sample_key depth   value method qc
 18NA95908_002_152244     5  0.2905  PO4_0  7
 18NA95908_002_152203     5  0.3855  PO4_0  1
 18NA95908_002_152202    25 18.8250  PO4_0  4
 18NA95908_002_152201    44 24.3050  PO4_0  4


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 1, station CAST#1:

           sample_key depth   value method qc
 18NA95908_002_152244     5   6.175 SiO4_0  7
 18NA95908_002_152203     5   5.755 SiO4_0  7
 18NA95908_002_152202    25  67.930 SiO4_0  1
 18NA95908_002_152201    44 112.770 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 11, station CAST#1:

           sample_key depth value   method qc
 18NA95908_014_152255     7 0.010 NO2NO3_0  1
 18NA95908_014_152225     7 0.005 NO2NO3_0  7
 18NA95908_014_152256    25 2.030 NO2NO3_0  1
 18NA95908_014_152224    25 1.925 NO2NO3_0  1
 18NA95908_014_152223    75 5.210 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 11, station CAST#1:

           sample_key depth  value method qc
 18NA95908_014_152255     7 0.0785  PO4_0  7
 18NA95908_014_152225     7 0.1095  PO4_0  1
 18NA95908_014_152256    25 0.4220  PO4_0  1
 18NA95908_014_152224    25 0.4295  PO4_0  1
 18NA95908_014_152223    75 0.7085  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 11, station CAST#1:

           sample_key depth value method qc
 18NA95908_014_152255     7 2.405 SiO4_0  1
 18NA95908_014_152225     7 1.965 SiO4_0  7
 18NA95908_014_152256    25 5.255 SiO4_0  7
 18NA95908_014_152224    25 4.760 SiO4_0  1
 18NA95908_014_152223    75 7.395 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 12, station CAST#1:

           sample_key depth value   method qc
 18NA95908_025_152227     1  0.00 NO2NO3_0  1
 18NA95908_025_152258     7  0.06 NO2NO3_0  7
 18NA95908_025_152226     7  0.41 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 12, station CAST#1:

           sample_key depth value method qc
 18NA95908_025_152227     1 2.530 SiO4_0  7
 18NA95908_025_152258     7 2.930 SiO4_0  1
 18NA95908_025_152226     7 2.515 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 13, station CAST#1:

           sample_key depth value   method qc
 18NA95908_036_152229     1  0.00 NO2NO3_0  7
 18NA95908_036_152260     5  0.02 NO2NO3_0  7
 18NA95908_036_152228     5  0.00 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 13, station CAST#1:

           sample_key depth  value method qc
 18NA95908_036_152229     1 0.1415  PO4_0  7
 18NA95908_036_152260     5 0.1495  PO4_0  1
 18NA95908_036_152228     5 0.1770  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 13, station CAST#1:

           sample_key depth value method qc
 18NA95908_036_152229     1 3.290 SiO4_0  1
 18NA95908_036_152260     5 2.895 SiO4_0  7
 18NA95908_036_152228     5 2.330 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 14, station CAST#1:

           sample_key depth value method qc
 18NA95908_047_152259     3 2.775 SiO4_0  7
 18NA95908_047_152230     3 2.400 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 15, station CAST#1:

           sample_key depth value   method qc
 18NA95908_058_152232     5 0.000 NO2NO3_0  7
 18NA95908_058_152231    20 0.055 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 15, station CAST#1:

           sample_key depth value method qc
 18NA95908_058_152232     5  1.88 SiO4_0  1
 18NA95908_058_152231    20  3.67 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 16, station CAST#1:

           sample_key depth value   method qc
 18NA95908_069_152234     5 0.005 NO2NO3_0  1
 18NA95908_069_152233    20 0.000 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 4, station CAST#1:

           sample_key depth value method qc
 18NA95908_264_152210     5  4.66 SiO4_0  7
 18NA95908_264_152209    13  8.68 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 5, station CAST#1:

           sample_key depth value   method qc
 18NA95908_284_152248     5  0.03 NO2NO3_0  7
 18NA95908_284_152212     5  0.18 NO2NO3_0  1
 18NA95908_284_152211     9  0.11 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 5, station CAST#1:

           sample_key depth value method qc
 18NA95908_284_152248     5 7.245 SiO4_0  7
 18NA95908_284_152212     5 7.255 SiO4_0  1
 18NA95908_284_152211     9 6.300 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 6, station CAST#1:

           sample_key depth  value method qc
 18NA95908_304_152214     5 0.1475  PO4_0  7
 18NA95908_304_152213     9 0.1960  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 6, station CAST#1:

           sample_key depth value method qc
 18NA95908_304_152214     5 5.800 SiO4_0  7
 18NA95908_304_152213     9 3.635 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 8, station CAST#1:

           sample_key depth value   method qc
 18NA95908_326_152218     5 0.220 NO2NO3_0  7
 18NA95908_326_152251     9 0.000 NO2NO3_0  1
 18NA95908_326_152217     9 0.055 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 8, station CAST#1:

           sample_key depth  value method qc
 18NA95908_326_152218     5 0.1725  PO4_0  1
 18NA95908_326_152251     9 0.2365  PO4_0  7
 18NA95908_326_152217     9 0.2490  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 8, station CAST#1:

           sample_key depth value method qc
 18NA95908_326_152218     5 3.805 SiO4_0  7
 18NA95908_326_152251     9 4.230 SiO4_0  7
 18NA95908_326_152217     9 4.290 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 9, station CAST#1:

           sample_key depth  value method qc
 18NA95908_339_152254     5 0.0465  PO4_0  1
 18NA95908_339_152220     5 0.1660  PO4_0  1
 18NA95908_339_152219     9 0.1520  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 9, station CAST#1:

           sample_key depth value method qc
 18NA95908_339_152254     5  4.11 SiO4_0  1
 18NA95908_339_152220     5  4.24 SiO4_0  7
 18NA95908_339_152219     9  2.97 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NA96002"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NA96002 FLAG Report:,  2019-03-15 12:04:23
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 23, station CAST#1:

           sample_key depth value   method qc
 18NA96002_149_147465     1 0.080 NO2NO3_0  1
 18NA96002_149_147464     7 0.075 NO2NO3_0  1
 18NA96002_149_147463    21 0.215 NO2NO3_0  7
 18NA96002_149_147462    46 0.415 NO2NO3_0  1
 18NA96002_149_147461    88 0.765 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 23, station CAST#1:

           sample_key depth  value method qc
 18NA96002_149_147465     1 0.1495  PO4_0  1
 18NA96002_149_147464     7 0.1895  PO4_0  7
 18NA96002_149_147463    21 0.2615  PO4_0  1
 18NA96002_149_147462    46 0.3130  PO4_0  1
 18NA96002_149_147461    88 0.5580  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 23, station CAST#1:

           sample_key depth value method qc
 18NA96002_149_147465     1 1.770 SiO4_0  7
 18NA96002_149_147464     7 0.805 SiO4_0  1
 18NA96002_149_147463    21 0.845 SiO4_0  1
 18NA96002_149_147462    46 1.085 SiO4_0  7
 18NA96002_149_147461    88 0.815 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 46, station CAST#1:

           sample_key depth  value   method qc
 18NA96002_280_147623     1  0.000 NO2NO3_0  1
 18NA96002_280_147622     5  0.010 NO2NO3_0  1
 18NA96002_280_147621    15  0.190 NO2NO3_0  1
 18NA96002_280_147620   222 14.485 NO2NO3_0  4


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 55, station CAST#1:

           sample_key depth value   method qc
 18NA96002_299_147650     1 0.090 NO2NO3_0  1
 18NA96002_299_147649     5 0.100 NO2NO3_0  1
 18NA96002_299_147648    15 0.130 NO2NO3_0  1
 18NA96002_299_147647    50 0.295 NO2NO3_0  7
 18NA96002_299_147646    70 0.795 NO2NO3_0  1
 18NA96002_299_147645   112 1.920 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 55, station CAST#1:

           sample_key depth  value method qc
 18NA96002_299_147650     1 0.1615  PO4_0  1
 18NA96002_299_147649     5 0.1495  PO4_0  1
 18NA96002_299_147648    15 0.1805  PO4_0  7
 18NA96002_299_147647    50 0.3455  PO4_0  1
 18NA96002_299_147646    70 0.3420  PO4_0  1
 18NA96002_299_147645   112 0.4830  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 58, station CAST#1:

           sample_key depth  value method qc
 18NA96002_302_147661     1 0.1495  PO4_0  1
 18NA96002_302_147660     5 0.1610  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NA96013"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NA96013 FLAG Report:,  2019-03-15 12:04:56
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged PHOSPHATE, event 16, station CAST#1:

           sample_key depth  value method qc
 18NA96013_069_158749     1 0.2005  PO4_0  7
 18NA96013_069_158748     4 0.1115  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 17, station CAST#1:

           sample_key depth value method qc
 18NA96013_080_158751     1  1.19 SiO4_0  1
 18NA96013_080_158750     4  1.14 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 34, station CAST#1:

           sample_key depth value   method qc
 18NA96013_244_158799     1  0.31 NO2NO3_0  1
 18NA96013_244_158798     5  0.34 NO2NO3_0  7
 18NA96013_244_158797    18  0.29 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 47, station CAST#1:

           sample_key depth value method qc
 18NA96013_281_158836     1 2.645 SiO4_0  1
 18NA96013_281_158835     5 2.335 SiO4_0  7
 18NA96013_281_158834    20 2.955 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 48, station CAST#1:

           sample_key depth  value method qc
 18NA96013_282_158840     1 0.0530  PO4_0  1
 18NA96013_282_158839     5 0.0625  PO4_0  4
 18NA96013_282_158838    40 0.3345  PO4_0  1
 18NA96013_282_158837    73 0.4465  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NA96022"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NA96022 FLAG Report:,  2019-03-15 12:05:19
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged SILICATE, event 13, station CAST#1:

           sample_key depth  value method qc
 18NA96022_036_175709     1  3.200 SiO4_0  1
 18NA96022_036_175708     5  3.645 SiO4_0  1
 18NA96022_036_175707    15  3.240 SiO4_0  2
 18NA96022_036_175706    50  7.140 SiO4_0  2
 18NA96022_036_175705   100 16.670 SiO4_0  2
 18NA96022_036_175704   150 27.530 SiO4_0  1
 18NA96022_036_175703   247 27.085 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 22, station CAST#1:

           sample_key depth value method qc
 18NA96022_138_175737     1 0.302  PO4_0  1
 18NA96022_138_175736     7 0.291  PO4_0  4


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 22, station CAST#1:

           sample_key depth value method qc
 18NA96022_138_175737     1 6.845 SiO4_0  4
 18NA96022_138_175736     7 7.670 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 23, station CAST#1:

           sample_key depth value   method qc
 18NA96022_149_175739     5  0.47 NO2NO3_0  1
 18NA96022_149_175738     9  1.20 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 23, station CAST#1:

           sample_key depth  value method qc
 18NA96022_149_175739     5 0.2985  PO4_0  7
 18NA96022_149_175738     9 0.3590  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 23, station CAST#1:

           sample_key depth value method qc
 18NA96022_149_175739     5  7.50 SiO4_0  1
 18NA96022_149_175738     9  5.76 SiO4_0  4


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 24, station CAST#1:

           sample_key depth value method qc
 18NA96022_160_175741     3 7.515 SiO4_0  1
 18NA96022_160_175740     6 6.415 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 43, station CAST#1:

           sample_key depth  value method qc
 18NA96022_277_175793     1 0.1515  PO4_0  1
 18NA96022_277_175792     5 0.1740  PO4_0  7
 18NA96022_277_175791    15 0.1775  PO4_0  1
 18NA96022_277_175790    56 0.8310  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 43, station CAST#1:

           sample_key depth  value method qc
 18NA96022_277_175793     1  3.150 SiO4_0  7
 18NA96022_277_175792     5  3.225 SiO4_0  1
 18NA96022_277_175791    15  3.355 SiO4_0  1
 18NA96022_277_175790    56 12.010 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 51, station CAST#1:

           sample_key depth value   method qc
 18NA96022_295_175824     1 0.350 NO2NO3_0  1
 18NA96022_295_175823     5 0.310 NO2NO3_0  1
 18NA96022_295_175822    40 3.430 NO2NO3_0  1
 18NA96022_295_175821    68 4.115 NO2NO3_0  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NA97015"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NA97015 FLAG Report:,  2019-03-15 12:05:55
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 13, station CAST#1:

           sample_key depth value   method qc
 18NA97015_036_147688     4     0 NO2NO3_0  7
 18NA97015_036_147687     8     0 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 21, station CAST#1:

           sample_key depth value   method qc
 18NA97015_127_147690     1     0 NO2NO3_0  1
 18NA97015_127_147689     7     0 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 21, station CAST#1:

           sample_key depth  value method qc
 18NA97015_127_147690     1 0.1565  PO4_0  7
 18NA97015_127_147689     7 0.1525  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 23, station CAST#1:

           sample_key depth value   method qc
 18NA97015_149_147694     1     0 NO2NO3_0  7
 18NA97015_149_147693     4     0 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 24, station CAST#1:

           sample_key depth value method qc
 18NA97015_160_147696     1 0.077  PO4_0  1
 18NA97015_160_147695     7 0.264  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 24, station CAST#1:

           sample_key depth value method qc
 18NA97015_160_147696     1 3.555 SiO4_0  7
 18NA97015_160_147695     7 2.675 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 26, station CAST#1:

           sample_key depth value   method qc
 18NA97015_182_147698     0     0 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 27, station CAST#1:

           sample_key depth value method qc
 18NA97015_193_180603     0 0.018  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 35, station CAST#1:

           sample_key depth value method qc
 18NA97015_247_180621     1  0.00 SiO4_0  7
 18NA97015_247_180620     5  0.04 SiO4_0  1
 18NA97015_247_180619    10  0.00 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 6, station CAST#1:

           sample_key depth value   method qc
 18NA97015_304_147683     1 0.000 NO2NO3_0  1
 18NA97015_304_147682     4 0.000 NO2NO3_0  1
 18NA97015_304_147681    10 0.695 NO2NO3_0  7
 18NA97015_304_147680    15 4.385 NO2NO3_0  1
 18NA97015_304_147679    20 1.810 NO2NO3_0  1
 18NA97015_304_147678    35 0.000 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 6, station CAST#1:

           sample_key depth  value method qc
 18NA97015_304_147683     1  0.117  PO4_0  1
 18NA97015_304_147682     4  0.169  PO4_0  7
 18NA97015_304_147681    10  0.450  PO4_0  1
 18NA97015_304_147680    15  1.162  PO4_0  1
 18NA97015_304_147679    20  5.430  PO4_0  1
 18NA97015_304_147678    35 12.217  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 6, station CAST#1:

           sample_key depth  value method qc
 18NA97015_304_147683     1  4.955 SiO4_0  7
 18NA97015_304_147682     4  4.180 SiO4_0  1
 18NA97015_304_147681    10  1.620 SiO4_0  1
 18NA97015_304_147680    15  2.045 SiO4_0  1
 18NA97015_304_147679    20 29.235 SiO4_0  1
 18NA97015_304_147678    35 36.870 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 8, station CAST#1:

           sample_key depth  value method qc
 18NA97015_326_147686     1 0.0300  PO4_0  1
 18NA97015_326_147685     8 2.6755  PO4_0  4
 18NA97015_326_147684    15 2.9080  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 8, station CAST#1:

           sample_key depth  value method qc
 18NA97015_326_147686     1  8.755 SiO4_0  4
 18NA97015_326_147685     8 34.550 SiO4_0  1
 18NA97015_326_147684    15 35.155 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NA97052"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NA97052 FLAG Report:,  2019-03-15 12:06:34
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 1, station CAST#1:

           sample_key depth  value   method qc
 18NA97052_002_180704     1  0.000 NO2NO3_0  1
 18NA97052_002_180703     5  0.000 NO2NO3_0  1
 18NA97052_002_180702    15  6.360 NO2NO3_0  1
 18NA97052_002_180701    25 11.645 NO2NO3_0  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 1, station CAST#1:

           sample_key depth  value method qc
 18NA97052_002_180704     1 0.1175  PO4_0  1
 18NA97052_002_180703     5 0.1215  PO4_0  1
 18NA97052_002_180702    15 1.6325  PO4_0  1
 18NA97052_002_180701    25 2.2655  PO4_0  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 1, station CAST#1:

           sample_key depth  value method qc
 18NA97052_002_180704     1  2.510 SiO4_0  1
 18NA97052_002_180703     5  2.320 SiO4_0  1
 18NA97052_002_180702    15 14.355 SiO4_0  2
 18NA97052_002_180701    25 19.570 SiO4_0  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 2, station CAST#1:

           sample_key depth value method qc
 18NA97052_113_180707     1  2.66 SiO4_0  2
 18NA97052_113_180706     5  2.65 SiO4_0  1
 18NA97052_113_180705    10  7.57 SiO4_0  1


-> QC repot:
      Filename Pressure Uniqueno Variable   Values
 18NA97052_002    15.00   180702     slca  14.36  
 18NA97052_002    25.00   180701     slca  19.57  
                                                        Test.failed
  Out of Nutrient Climatology in box(es) 6 (Min=0.00 Max=9.44 n=94)
  Out of Nutrient Climatology in box(es) 6 (Min=0.00 Max=9.44 n=94)



-> Flagged NITRATE, event 23, station CAST#1:

           sample_key depth  value   method qc
 18NA97052_149_180745     1  0.035 NO2NO3_0  1
 18NA97052_149_180744     5  0.010 NO2NO3_0  1
 18NA97052_149_180743    10  1.240 NO2NO3_0  1
 18NA97052_149_180742    15 24.580 NO2NO3_0  7
 18NA97052_149_180741    20  5.500 NO2NO3_0  1
 18NA97052_149_180739    25  0.350 NO2NO3_0  1
 18NA97052_149_180738    43  0.170 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 23, station CAST#1:

           sample_key depth   value method qc
 18NA97052_149_180745     1  0.4350  PO4_0  1
 18NA97052_149_180744     5  0.4375  PO4_0  1
 18NA97052_149_180743    10  0.8640  PO4_0  7
 18NA97052_149_180742    15  3.2840  PO4_0  1
 18NA97052_149_180741    20  4.4795  PO4_0  4
 18NA97052_149_180739    25 10.0000  PO4_0  1
 18NA97052_149_180738    43 14.0000  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 23, station CAST#1:

           sample_key depth  value method qc
 18NA97052_149_180745     1  6.775 SiO4_0  1
 18NA97052_149_180744     5  6.715 SiO4_0  7
 18NA97052_149_180743    10  8.070 SiO4_0  1
 18NA97052_149_180742    15 15.045 SiO4_0  4
 18NA97052_149_180741    20 29.085 SiO4_0  1
 18NA97052_149_180739    25 55.000 SiO4_0  1
 18NA97052_149_180738    43 85.000 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 4, station CAST#1:

           sample_key depth  value method qc
 18NA97052_264_180713     1 0.1290  PO4_0  1
 18NA97052_264_180712     5 0.1440  PO4_0  1
 18NA97052_264_180711    15 0.2555  PO4_0  1
 18NA97052_264_180710    24 0.6405  PO4_0  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE13022"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE13022 FLAG Report:,  2019-03-15 12:07:07
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 133, station 133:

           sample_key depth value        method qc
 18NE13022_040_388521     4     0 NO2NO3_Tech_F  7
 18NE13022_040_388520    25     0 NO2NO3_Tech_F  7
 18NE13022_040_388519    52     0 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 225, station 225:

           sample_key depth  value        method qc
 18NE13022_144_388875     2  0.435 NO2NO3_Tech_F  7
 18NE13022_144_388874     4  2.935 NO2NO3_Tech_F  7
 18NE13022_144_388873    26  4.505 NO2NO3_Tech_F  1
 18NE13022_144_388872    51 22.190 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE14018"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE14018 FLAG Report:,  2019-03-15 12:07:28
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 115, station 115:

           sample_key depth value        method qc
 18NE14018_020_398386     5     0 NO2NO3_Tech_F  7
 18NE14018_020_398385    34     0 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event 128, station 128:

           sample_key depth Chl_a_Holm-Hansen_F qc
 18NE14018_034_398412  5.83             0.24695  7
 18NE14018_034_398411 53.31             0.24695  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 133, station 133:

           sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
 18NE14018_040_398421   37.25      32.3916    1   37.25          32.0554    7
 18NE14018_040_398422    5.42      31.8573    1      NA               NA <NA>


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 137, station 137:

           sample_key depth value      method qc
 18NE14018_044_398428  5.42 0.000 SiO4_Tech_F  1
 18NE14018_044_398427 49.27 0.505 SiO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 142, station HL_02:

           sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
 18NE14018_050_398437  141.27      34.4168    1  141.27          34.3964    1
 18NE14018_050_398438  101.08      33.4975    1      NA               NA <NA>
 18NE14018_050_398439   75.83      32.8657    1      NA               NA <NA>
 18NE14018_050_398440   50.84      32.2698    1      NA               NA <NA>
 18NE14018_050_398441   40.89      32.0428    1   40.89          31.8085    7
 18NE14018_050_398442   30.50      31.9026    1      NA               NA <NA>
 18NE14018_050_398443   20.46      32.2331    1      NA               NA <NA>
 18NE14018_050_398444   10.46      31.3574    1      NA               NA <NA>
 18NE14018_050_398445    5.27      31.2498    1      NA               NA <NA>
 18NE14018_050_398446    2.30      31.0802    1    2.30          31.1020    1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 142, station HL_02:

           sample_key  depth  value        method qc
 18NE14018_050_398446   2.30  0.000 NO2NO3_Tech_F  1
 18NE14018_050_398445   5.27  0.000 NO2NO3_Tech_F  1
 18NE14018_050_398444  10.46  0.000 NO2NO3_Tech_F  1
 18NE14018_050_398443  20.46  0.000 NO2NO3_Tech_F  1
 18NE14018_050_398442  30.50  0.885 NO2NO3_Tech_F  1
 18NE14018_050_398441  40.89  1.400 NO2NO3_Tech_F  1
 18NE14018_050_398440  50.84  3.330 NO2NO3_Tech_F  1
 18NE14018_050_398439  75.83  2.820 NO2NO3_Tech_F  1
 18NE14018_050_398438 101.08  7.855 NO2NO3_Tech_F  2
 18NE14018_050_398437 141.27 16.875 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 142, station HL_02:

           sample_key  depth  value      method qc
 18NE14018_050_398446   2.30  0.535 SiO4_Tech_F  1
 18NE14018_050_398445   5.27  0.355 SiO4_Tech_F  1
 18NE14018_050_398444  10.46  0.400 SiO4_Tech_F  1
 18NE14018_050_398443  20.46  0.360 SiO4_Tech_F  1
 18NE14018_050_398442  30.50  1.835 SiO4_Tech_F  1
 18NE14018_050_398441  40.89  1.285 SiO4_Tech_F  1
 18NE14018_050_398440  50.84  2.835 SiO4_Tech_F  1
 18NE14018_050_398439  75.83  3.435 SiO4_Tech_F  1
 18NE14018_050_398438 101.08  7.735 SiO4_Tech_F  2
 18NE14018_050_398437 141.27 15.285 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 146, station 146:

           sample_key  depth value      method qc
 18NE14018_054_398458   4.39 0.310 SiO4_Tech_F  1
 18NE14018_054_398457  24.57 0.315 SiO4_Tech_F  1
 18NE14018_054_398456  50.13 2.985 SiO4_Tech_F  1
 18NE14018_054_398455 106.03 6.680 SiO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 159, station 159:

           sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
 18NE14018_068_398499   94.68      29.1042    1   94.68          32.4014    7
 18NE14018_068_398500   50.13      30.5220    1      NA               NA <NA>
 18NE14018_068_398501   24.54      29.4792    1      NA               NA <NA>
 18NE14018_068_398502    5.50       7.2882    1      NA               NA <NA>


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 171, station 171:

           sample_key depth  value      method qc
 18NE14018_082_398538     5  0.410 SiO4_Tech_F  1
 18NE14018_082_398537    25  7.005 SiO4_Tech_F  2
 18NE14018_082_398536    51  9.340 SiO4_Tech_F  1
 18NE14018_082_398535    83 11.935 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 180, station 180:

           sample_key  depth value        method qc
 18NE14018_092_398566   5.31  0.00 NO2NO3_Tech_F  1
 18NE14018_092_398565  25.46  0.00 NO2NO3_Tech_F  1
 18NE14018_092_398564  50.26  2.25 NO2NO3_Tech_F  1
 18NE14018_092_398563 336.93 22.43 NO2NO3_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 181, station 181:

           sample_key  depth  value     method qc
 18NE14018_093_398570   5.13 0.0545 PO4_Tech_F  2
 18NE14018_093_398569  25.37 0.4195 PO4_Tech_F  1
 18NE14018_093_398568  49.91 0.7020 PO4_Tech_F  1
 18NE14018_093_398567 443.10 1.7075 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 181, station 181:

           sample_key  depth  value      method qc
 18NE14018_093_398570   5.13  0.140 SiO4_Tech_F  2
 18NE14018_093_398569  25.37  0.335 SiO4_Tech_F  1
 18NE14018_093_398568  49.91  1.345 SiO4_Tech_F  2
 18NE14018_093_398567 443.10 30.585 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 182, station 182:

           sample_key  depth value     method qc
 18NE14018_094_398574   4.74 0.081 PO4_Tech_F  2
 18NE14018_094_398573  25.35 0.617 PO4_Tech_F  1
 18NE14018_094_398572  49.86 0.615 PO4_Tech_F  1
 18NE14018_094_398571 394.75 1.695 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 182, station 182:

           sample_key  depth  value      method qc
 18NE14018_094_398574   4.74  0.230 SiO4_Tech_F  2
 18NE14018_094_398573  25.35  3.470 SiO4_Tech_F  1
 18NE14018_094_398572  49.86  0.505 SiO4_Tech_F  2
 18NE14018_094_398571 394.75 29.535 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 189, station 189:

           sample_key  depth value      method qc
 18NE14018_101_398598   4.20  0.24 SiO4_Tech_F  2
 18NE14018_101_398597  25.10  1.18 SiO4_Tech_F  1
 18NE14018_101_398596  50.41  0.16 SiO4_Tech_F  2
 18NE14018_101_398595 342.33 30.16 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 196, station 196:

           sample_key  depth value      method qc
 18NE14018_109_398626   4.70  0.38 SiO4_Tech_F  1
 18NE14018_109_398625  24.80  0.19 SiO4_Tech_F  1
 18NE14018_109_398624  49.86  0.00 SiO4_Tech_F  2
 18NE14018_109_398623 258.57 14.05 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 201, station 201:

           sample_key  depth  value      method qc
 18NE14018_118_398644   4.34  0.155 SiO4_Tech_F  2
 18NE14018_118_398643  25.52  0.155 SiO4_Tech_F  1
 18NE14018_118_398642  50.91  1.325 SiO4_Tech_F  2
 18NE14018_118_398641 419.49 18.250 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 204, station 204:

           sample_key  depth value      method qc
 18NE14018_121_398651   5.52 0.150 SiO4_Tech_F  1
 18NE14018_121_398650  25.03 0.175 SiO4_Tech_F  1
 18NE14018_121_398649  50.02 0.370 SiO4_Tech_F  2
 18NE14018_121_398648 118.67 5.885 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 225, station 225:

           sample_key  depth  value     method qc
 18NE14018_144_398726   4.39 0.0735 PO4_Tech_F  2
 18NE14018_144_398725  25.28 0.2475 PO4_Tech_F  1
 18NE14018_144_398724  50.71 0.6445 PO4_Tech_F  1
 18NE14018_144_398723 148.08 1.3540 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 76, station 76:

           sample_key  depth  value     method qc
 18NE14018_322_398291   5.69 0.0625 PO4_Tech_F  2
 18NE14018_322_398290  25.66 0.0745 PO4_Tech_F  2
 18NE14018_322_398289  51.08 0.6515 PO4_Tech_F  1
 18NE14018_322_398288 120.44 1.0900 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 9, station 9:

           sample_key depth value        method qc
 18NE14018_339_398052  5.20 0.000 NO2NO3_Tech_F  1
 18NE14018_339_398051 25.23 0.000 NO2NO3_Tech_F  1
 18NE14018_339_398050 50.53 0.000 NO2NO3_Tech_F  2
 18NE14018_339_398049 60.40 4.025 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE14101"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE14101 FLAG Report:,  2019-03-15 12:08:45
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 15, station 15:

           sample_key depth value        method qc
 18NE14101_058_397874  4.99 8.840 NO2NO3_Tech_F  1
 18NE14101_058_397873 25.14 8.840 NO2NO3_Tech_F  2
 18NE14101_058_397872 50.69 8.830 NO2NO3_Tech_F  1
 18NE14101_058_397871 79.66 8.905 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 15, station 15:

           sample_key depth  value     method qc
 18NE14101_058_397874  4.99 0.9545 PO4_Tech_F  1
 18NE14101_058_397873 25.14 0.8805 PO4_Tech_F  2
 18NE14101_058_397872 50.69 0.8835 PO4_Tech_F  1
 18NE14101_058_397871 79.66 0.8870 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 17, station 17:

           sample_key depth value        method qc
 18NE14101_080_397878  4.49 8.190 NO2NO3_Tech_F  1
 18NE14101_080_397877 25.19 8.160 NO2NO3_Tech_F  2
 18NE14101_080_397876 50.42 8.315 NO2NO3_Tech_F  1
 18NE14101_080_397875 68.19 8.465 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 17, station 17:

           sample_key depth  value     method qc
 18NE14101_080_397878  4.49 0.8660 PO4_Tech_F  1
 18NE14101_080_397877 25.19 0.8625 PO4_Tech_F  2
 18NE14101_080_397876 50.42 0.8515 PO4_Tech_F  1
 18NE14101_080_397875 68.19 0.8690 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 19, station 19:

           sample_key  depth  value        method qc
 18NE14101_102_397887   5.13  5.415 NO2NO3_Tech_F  1
 18NE14101_102_397886  25.75  7.495 NO2NO3_Tech_F  2
 18NE14101_102_397885  50.25  9.185 NO2NO3_Tech_F  1
 18NE14101_102_397884 214.80 15.845 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 19, station 19:

           sample_key  depth  value     method qc
 18NE14101_102_397887   5.13 0.7325 PO4_Tech_F  1
 18NE14101_102_397886  25.75 0.7960 PO4_Tech_F  2
 18NE14101_102_397885  50.25 0.8675 PO4_Tech_F  1
 18NE14101_102_397884 214.80 1.1770 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 20, station 20:

           sample_key depth value        method qc
 18NE14101_114_397890  5.08 8.385 NO2NO3_Tech_F  1
 18NE14101_114_397889 25.40 7.965 NO2NO3_Tech_F  2
 18NE14101_114_397888 50.72 8.475 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 20, station 20:

           sample_key depth  value     method qc
 18NE14101_114_397890  5.08 0.8915 PO4_Tech_F  1
 18NE14101_114_397889 25.40 0.9215 PO4_Tech_F  2
 18NE14101_114_397888 50.72 0.9195 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 21, station 21:

           sample_key depth value        method qc
 18NE14101_127_397894  4.99 8.410 NO2NO3_Tech_F  1
 18NE14101_127_397893 24.41 8.230 NO2NO3_Tech_F  2
 18NE14101_127_397892 50.45 8.195 NO2NO3_Tech_F  1
 18NE14101_127_397891 59.16 8.620 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 21, station 21:

           sample_key depth  value     method qc
 18NE14101_127_397894  4.99 0.9950 PO4_Tech_F  1
 18NE14101_127_397893 24.41 1.0460 PO4_Tech_F  2
 18NE14101_127_397892 50.45 1.0360 PO4_Tech_F  1
 18NE14101_127_397891 59.16 0.9925 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 22, station 22:

           sample_key depth value        method qc
 18NE14101_138_397898  5.76 7.855 NO2NO3_Tech_F  1
 18NE14101_138_397897 25.24 7.790 NO2NO3_Tech_F  2
 18NE14101_138_397896 50.39 7.990 NO2NO3_Tech_F  1
 18NE14101_138_397895 86.00 7.960 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 22, station 22:

           sample_key depth  value     method qc
 18NE14101_138_397898  5.76 0.8720 PO4_Tech_F  1
 18NE14101_138_397897 25.24 0.8765 PO4_Tech_F  2
 18NE14101_138_397896 50.39 0.9245 PO4_Tech_F  1
 18NE14101_138_397895 86.00 0.9185 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 23, station 23:

           sample_key depth value        method qc
 18NE14101_149_397901  5.55 9.105 NO2NO3_Tech_F  1
 18NE14101_149_397900 25.18 8.025 NO2NO3_Tech_F  2
 18NE14101_149_397899 53.25 8.105 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 23, station 23:

           sample_key depth  value     method qc
 18NE14101_149_397901  5.55 0.9410 PO4_Tech_F  1
 18NE14101_149_397900 25.18 0.9095 PO4_Tech_F  2
 18NE14101_149_397899 53.25 0.9285 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 24, station 24:

           sample_key  depth value        method qc
 18NE14101_160_397905   3.42 8.630 NO2NO3_Tech_F  1
 18NE14101_160_397904  25.12 8.810 NO2NO3_Tech_F  2
 18NE14101_160_397903  50.75 8.225 NO2NO3_Tech_F  1
 18NE14101_160_397902 105.98 9.565 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 24, station 24:

           sample_key  depth  value     method qc
 18NE14101_160_397905   3.42 0.8830 PO4_Tech_F  1
 18NE14101_160_397904  25.12 0.9000 PO4_Tech_F  2
 18NE14101_160_397903  50.75 0.8725 PO4_Tech_F  1
 18NE14101_160_397902 105.98 0.9740 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 25, station 25:

           sample_key  depth value        method qc
 18NE14101_171_397913   4.49 8.835 NO2NO3_Tech_F  1
 18NE14101_171_397912  24.74 8.530 NO2NO3_Tech_F  2
 18NE14101_171_397911  50.73 8.860 NO2NO3_Tech_F  1
 18NE14101_171_397910 138.90 8.995 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 25, station 25:

           sample_key  depth  value     method qc
 18NE14101_171_397913   4.49 0.8805 PO4_Tech_F  1
 18NE14101_171_397912  24.74 0.8755 PO4_Tech_F  2
 18NE14101_171_397911  50.73 0.8940 PO4_Tech_F  1
 18NE14101_171_397910 138.90 0.8810 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 26, station 26:

           sample_key  depth value        method qc
 18NE14101_182_397917   5.16 8.695 NO2NO3_Tech_F  1
 18NE14101_182_397916  24.52 8.670 NO2NO3_Tech_F  2
 18NE14101_182_397915  49.51 8.870 NO2NO3_Tech_F  1
 18NE14101_182_397914 103.86 9.570 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 26, station 26:

           sample_key  depth  value     method qc
 18NE14101_182_397917   5.16 0.8620 PO4_Tech_F  1
 18NE14101_182_397916  24.52 0.8610 PO4_Tech_F  2
 18NE14101_182_397915  49.51 0.8560 PO4_Tech_F  1
 18NE14101_182_397914 103.86 0.9195 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 27, station 27:

           sample_key depth value        method qc
 18NE14101_193_397920  5.57 7.870 NO2NO3_Tech_F  1
 18NE14101_193_397919 25.28 7.695 NO2NO3_Tech_F  2
 18NE14101_193_397918 55.35 8.695 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 27, station 27:

           sample_key depth  value     method qc
 18NE14101_193_397920  5.57 0.8265 PO4_Tech_F  1
 18NE14101_193_397919 25.28 0.7930 PO4_Tech_F  2
 18NE14101_193_397918 55.35 0.8805 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 28, station 28:

           sample_key  depth value        method qc
 18NE14101_204_397924   4.03 8.810 NO2NO3_Tech_F  1
 18NE14101_204_397923  25.30 8.770 NO2NO3_Tech_F  2
 18NE14101_204_397922  50.38 8.895 NO2NO3_Tech_F  1
 18NE14101_204_397921 112.36 8.575 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 28, station 28:

           sample_key  depth  value     method qc
 18NE14101_204_397924   4.03 0.8920 PO4_Tech_F  1
 18NE14101_204_397923  25.30 0.8805 PO4_Tech_F  2
 18NE14101_204_397922  50.38 0.8750 PO4_Tech_F  1
 18NE14101_204_397921 112.36 0.8525 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 29, station 29:

           sample_key depth value        method qc
 18NE14101_215_397928  6.72 8.530 NO2NO3_Tech_F  1
 18NE14101_215_397927 24.89 8.525 NO2NO3_Tech_F  2
 18NE14101_215_397926 49.77 8.465 NO2NO3_Tech_F  1
 18NE14101_215_397925 84.17 8.340 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 29, station 29:

           sample_key depth value     method qc
 18NE14101_215_397928  6.72 0.868 PO4_Tech_F  1
 18NE14101_215_397927 24.89 0.874 PO4_Tech_F  2
 18NE14101_215_397926 49.77 0.879 PO4_Tech_F  1
 18NE14101_215_397925 84.17 0.868 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 30, station 30:

           sample_key depth value        method qc
 18NE14101_226_397932  6.31 8.565 NO2NO3_Tech_F  1
 18NE14101_226_397931 24.59 8.590 NO2NO3_Tech_F  2
 18NE14101_226_397930 50.77 8.565 NO2NO3_Tech_F  1
 18NE14101_226_397929 67.16 8.690 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 30, station 30:

           sample_key depth  value     method qc
 18NE14101_226_397932  6.31 0.8585 PO4_Tech_F  1
 18NE14101_226_397931 24.59 0.8615 PO4_Tech_F  2
 18NE14101_226_397930 50.77 0.8485 PO4_Tech_F  1
 18NE14101_226_397929 67.16 0.8570 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 31, station 31:

           sample_key depth value        method qc
 18NE14101_237_397936  5.31 8.800 NO2NO3_Tech_F  1
 18NE14101_237_397935 25.23 8.895 NO2NO3_Tech_F  2
 18NE14101_237_397934 50.32 8.915 NO2NO3_Tech_F  1
 18NE14101_237_397933 83.98 8.870 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 31, station 31:

           sample_key depth  value     method qc
 18NE14101_237_397936  5.31 0.8685 PO4_Tech_F  1
 18NE14101_237_397935 25.23 0.8685 PO4_Tech_F  2
 18NE14101_237_397934 50.32 0.8610 PO4_Tech_F  1
 18NE14101_237_397933 83.98 0.8690 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 32, station 32:

           sample_key depth value        method qc
 18NE14101_239_397940  4.69 8.970 NO2NO3_Tech_F  1
 18NE14101_239_397939 25.02 8.960 NO2NO3_Tech_F  2
 18NE14101_239_397938 50.09 9.095 NO2NO3_Tech_F  1
 18NE14101_239_397937 92.86 8.955 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 32, station 32:

           sample_key depth  value     method qc
 18NE14101_239_397940  4.69 0.8815 PO4_Tech_F  1
 18NE14101_239_397939 25.02 0.8730 PO4_Tech_F  2
 18NE14101_239_397938 50.09 0.8775 PO4_Tech_F  1
 18NE14101_239_397937 92.86 0.8645 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 33, station 33:

           sample_key  depth value        method qc
 18NE14101_243_397944   5.82 8.855 NO2NO3_Tech_F  1
 18NE14101_243_397943  24.69 9.005 NO2NO3_Tech_F  2
 18NE14101_243_397942  49.73 9.010 NO2NO3_Tech_F  1
 18NE14101_243_397941 107.81 9.135 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 33, station 33:

           sample_key  depth  value     method qc
 18NE14101_243_397944   5.82 0.8745 PO4_Tech_F  1
 18NE14101_243_397943  24.69 0.8690 PO4_Tech_F  2
 18NE14101_243_397942  49.73 0.8405 PO4_Tech_F  1
 18NE14101_243_397941 107.81 0.8765 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 34, station 34:

           sample_key  depth value        method qc
 18NE14101_244_397948   6.21  8.72 NO2NO3_Tech_F  1
 18NE14101_244_397947  25.99  8.65 NO2NO3_Tech_F  2
 18NE14101_244_397946  49.08  8.79 NO2NO3_Tech_F  1
 18NE14101_244_397945 105.50  8.90 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 34, station 34:

           sample_key  depth  value     method qc
 18NE14101_244_397948   6.21 0.8950 PO4_Tech_F  1
 18NE14101_244_397947  25.99 0.8910 PO4_Tech_F  2
 18NE14101_244_397946  49.08 0.8935 PO4_Tech_F  1
 18NE14101_244_397945 105.50 0.8760 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 35, station 35:

           sample_key  depth  value        method qc
 18NE14101_247_397952   4.70  8.955 NO2NO3_Tech_F  1
 18NE14101_247_397951  25.03  9.150 NO2NO3_Tech_F  2
 18NE14101_247_397950  50.41  9.890 NO2NO3_Tech_F  1
 18NE14101_247_397949 171.25 13.640 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 35, station 35:

           sample_key  depth  value     method qc
 18NE14101_247_397952   4.70 0.8495 PO4_Tech_F  1
 18NE14101_247_397951  25.03 0.8575 PO4_Tech_F  2
 18NE14101_247_397950  50.41 0.8970 PO4_Tech_F  1
 18NE14101_247_397949 171.25 1.0925 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 925, station 925:

           sample_key depth value        method qc
 18NE14101_368_397909  5.79 8.720 NO2NO3_Tech_F  1
 18NE14101_368_397908 25.12 8.570 NO2NO3_Tech_F  2
 18NE14101_368_397907 50.19 8.680 NO2NO3_Tech_F  1
 18NE14101_368_397906 72.90 8.845 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 925, station 925:

           sample_key depth  value     method qc
 18NE14101_368_397909  5.79 0.8810 PO4_Tech_F  1
 18NE14101_368_397908 25.12 0.8835 PO4_Tech_F  2
 18NE14101_368_397907 50.19 0.8935 PO4_Tech_F  1
 18NE14101_368_397906 72.90 0.8945 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE15015"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE15015 FLAG Report:,  2019-03-15 12:10:35
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE15017"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE15017 FLAG Report:,  2019-03-15 12:11:24
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged SALINITY, event 105, station 93:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               5.12      31.7637    0   180.6          33.3502    7
              25.35      31.7659    0   180.6          33.3502    7
              50.35      32.0154    0   180.6          33.3502    7
             180.60      33.0928    0   180.6          33.3502    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 112, station 99:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               5.19      32.0923    0  209.62          33.2466    7
              25.74      32.3316    0  209.62          33.2466    7
              50.59      33.2170    0  209.62          33.2466    7
             209.62      34.9118    0  209.62          33.2466    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 112, station 99:

 sample_key  depth O2_CTD_mLL qc
              5.19     6.1669  0
             25.74     6.6922  0
             50.59     5.8559  0
            209.62     4.2444  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 117, station 104:

 sample_key  depth value      method qc
              5.28 0.565 SiO4_Tech_F  2
             25.94 0.975 SiO4_Tech_F  1
             50.14 4.990 SiO4_Tech_F  1
            119.21 8.255 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 118, station 105:

 sample_key  depth value      method qc
              4.74 0.480 SiO4_Tech_F  2
             25.00 0.760 SiO4_Tech_F  1
             50.77 3.940 SiO4_Tech_F  1
            117.18 7.475 SiO4_Tech_F  1


-> QC repot:
      Filename Pressure Uniqueno Variable Values
 18NE15017_118    50.56   402286     slca   1.13
                                                        Test.failed
  Out of Nutrient Climatology in box(es) 8 (Min=1.39 Max=9.12 n=32)



-> Flagged SILICATE, event 128, station 115:

 sample_key  depth value      method qc
              4.37 0.345 SiO4_Tech_F  2
             25.60 0.615 SiO4_Tech_F  1
             50.30 5.665 SiO4_Tech_F  1
            115.46 8.200 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 132, station 118:

 sample_key  depth value      method qc
              4.55 0.285 SiO4_Tech_F  2
             24.64 0.655 SiO4_Tech_F  1
             50.52 2.285 SiO4_Tech_F  1
            123.86 8.730 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 135, station 120:

 sample_key  depth value      method qc
              4.79 0.215 SiO4_Tech_F  2
             24.96 0.590 SiO4_Tech_F  1
             50.14 3.685 SiO4_Tech_F  1
            215.59 9.865 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 138, station HL_02:

 sample_key  depth  value     method qc
              2.42 0.1645 PO4_Tech_F  1
              5.32 0.1730 PO4_Tech_F  1
             10.28 0.1780 PO4_Tech_F  1
             19.91 0.2670 PO4_Tech_F  1
             31.24 0.2915 PO4_Tech_F  2
             39.99 0.4955 PO4_Tech_F  1
             50.78 0.7120 PO4_Tech_F  1
             75.44 1.1540 PO4_Tech_F  1
            100.88 1.3295 PO4_Tech_F  1
            161.35 1.3695 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 155, station 139:

 sample_key depth value        method qc
             4.56     0 NO2NO3_Tech_F  7
            27.70     0 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 159, station 143:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               5.26      30.7012    0   24.62          34.6599    7
               5.26      30.7012    0  208.27          34.7113    1
              24.62      32.0764    0   24.62          34.6599    7
              24.62      32.0764    0  208.27          34.7113    1
              49.61      32.6505    0   24.62          34.6599    7
              49.61      32.6505    0  208.27          34.7113    1
             101.36      33.9460    0   24.62          34.6599    7
             101.36      33.9460    0  208.27          34.7113    1
             208.27      34.7263    0   24.62          34.6599    7
             208.27      34.7263    0  208.27          34.7113    1


-> QC repot:
      Filename    Pressure Uniqueno Variable Values
 18NE15017_159  45 to 55 m      NaN     psal  32.79
                                                           Test.failed
  Out of TS Climatology by more than 3*std in box(es) 9 (32.46  0.33)



-> Flagged NITRATE, event 185, station 168:

 sample_key depth value        method qc
             4.97     0 NO2NO3_Tech_F  7
            25.00     0 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 191, station 174:

 sample_key  depth  value        method qc
              5.55  0.000 NO2NO3_Tech_F  1
             24.88  0.155 NO2NO3_Tech_F  1
             50.61  3.495 NO2NO3_Tech_F  1
            101.69 12.535 NO2NO3_Tech_F  1
            325.72 22.840 NO2NO3_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 200, station 181:

 sample_key  depth  value      method qc
              4.43  0.350 SiO4_Tech_F  1
             24.41  0.485 SiO4_Tech_F  1
             52.96  1.370 SiO4_Tech_F  2
            102.50  5.715 SiO4_Tech_F  1
            421.09 27.240 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 201, station 182:

 sample_key  depth  value      method qc
              4.19  0.455 SiO4_Tech_F  1
             26.01  0.875 SiO4_Tech_F  1
             50.56  1.130 SiO4_Tech_F  2
            101.58  4.995 SiO4_Tech_F  1
            485.38 19.665 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 204, station 184:

 sample_key  depth  value      method qc
              4.18  0.325 SiO4_Tech_F  1
             24.68  0.385 SiO4_Tech_F  1
             50.63  0.570 SiO4_Tech_F  2
            333.22 28.710 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 212, station 192:

 sample_key  depth  value      method qc
              5.40  0.305 SiO4_Tech_F  1
             24.84  0.865 SiO4_Tech_F  1
             51.44  0.920 SiO4_Tech_F  2
            101.67  6.445 SiO4_Tech_F  1
            341.13 21.350 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 215, station 195:

 sample_key depth value        method qc
             4.75     0 NO2NO3_Tech_F  7
            25.40     0 NO2NO3_Tech_F  7
            40.14     0 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 218, station 198:

 sample_key depth  value     method qc
             5.34 0.0640 PO4_Tech_F  1
            24.88 0.0975 PO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 222, station 202:

 sample_key depth value        method qc
             5.01     0 NO2NO3_Tech_F  7
            24.44     0 NO2NO3_Tech_F  7
            31.74     0 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 223, station 203:

 sample_key depth value        method qc
             4.58     0 NO2NO3_Tech_F  7
            25.49     0 NO2NO3_Tech_F  7
            37.39     0 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 228, station 208:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               2.43      31.7023    0   69.16          32.6575    7
              24.66      31.9155    0   69.16          32.6575    7
              49.35      32.5926    0   69.16          32.6575    7
              69.16      32.9264    0   69.16          32.6575    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 244, station 224:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               5.82      31.0636    0   63.64          31.8856    7
              24.65      31.9918    0   63.64          31.8856    7
              63.64      32.6099    0   63.64          31.8856    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 244, station 224:

 sample_key depth value        method qc
             5.82     0 NO2NO3_Tech_F  7
            24.65     0 NO2NO3_Tech_F  7
            63.64     0 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 258, station HL_02:

 sample_key  depth  value     method qc
              2.11 0.1140 PO4_Tech_F  1
              4.77 0.1095 PO4_Tech_F  1
             10.17 0.1110 PO4_Tech_F  2
             19.67 0.2310 PO4_Tech_F  1
             29.92 0.3275 PO4_Tech_F  1
             40.21 0.6425 PO4_Tech_F  1
             50.34 0.9390 PO4_Tech_F  1
             75.17 1.0700 PO4_Tech_F  1
            100.56 1.2015 PO4_Tech_F  1
            157.77 1.4100 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 71, station 57:

 sample_key  depth O2_CTD_mLL qc
              4.67     6.4129  0
             24.74     7.2890  0
             50.19     6.2061  0
            106.62     4.3998  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 96, station 84:

 sample_key depth O2_CTD_mLL qc
             4.78     5.8708  0
            25.08     5.8974  0
            52.14     6.5108  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE16016"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE16016 FLAG Report:,  2019-03-15 12:13:24
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged PHOSPHATE, event 139, station 128:

 sample_key  depth  value     method qc
              5.18 0.1875 PO4_Tech_F  1
             25.10 0.5455 PO4_Tech_F  1
             50.30 0.6335 PO4_Tech_F  1
            100.52 0.9370 PO4_Tech_F  1
            290.95 1.7685 PO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 143, station 133:

 sample_key  depth O2_CTD_mLL qc
              4.98     5.7790  0
             25.58     7.5036  0
             49.98     7.4467  0
            142.88     4.6939  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 144, station 134:

 sample_key  depth  value     method qc
              5.47 0.2675 PO4_Tech_F  1
             26.00 0.4120 PO4_Tech_F  1
             51.26 0.6330 PO4_Tech_F  1
            101.12 0.9875 PO4_Tech_F  1
            331.80 1.7765 PO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 146, station 135:

 sample_key  depth  value        method qc
              4.40  0.400 NO2NO3_Tech_F  1
             25.20  0.485 NO2NO3_Tech_F  1
             50.84  7.960 NO2NO3_Tech_F  1
            100.12 12.565 NO2NO3_Tech_F  2
            447.76 21.720 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 146, station 135:

 sample_key  depth  value      method qc
              4.40  0.405 SiO4_Tech_F  1
             25.20  0.705 SiO4_Tech_F  1
             50.84  7.470 SiO4_Tech_F  1
            100.12 14.115 SiO4_Tech_F  2
            447.76 32.130 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 148, station 136:

 sample_key  depth  value        method qc
              4.49  0.420 NO2NO3_Tech_F  1
             24.97  0.665 NO2NO3_Tech_F  1
             50.57  3.975 NO2NO3_Tech_F  1
            100.32 11.495 NO2NO3_Tech_F  2
            392.33 22.235 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 148, station 136:

 sample_key  depth  value      method qc
              4.49  0.680 SiO4_Tech_F  1
             24.97  1.785 SiO4_Tech_F  1
             50.57  3.335 SiO4_Tech_F  1
            100.32 12.270 SiO4_Tech_F  2
            392.33 34.095 SiO4_Tech_F  1


-> QC repot:
      Filename Pressure Uniqueno Variable Values
 18NE16016_148     5.31   413523     slca   2.52
 18NE16016_148   145.01   413520     slca   6.58
                                                         Test.failed
  Out of Nutrient Climatology in box(es) 5 (Min=0.00 Max=2.31 n=125)
  Out of Nutrient Climatology in box(es) 5 (Min=8.30 Max=44.31 n=77)



-> Flagged OXYGEN, event 158, station 147:

 sample_key depth O2_CTD_mLL qc
             4.75     5.7972  0
            24.66     7.3554  0
            49.94     6.3063  0
            71.66     6.1798  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 168, station 156:

 sample_key depth O2_CTD_mLL qc
             4.25     5.9934  0
            25.09     6.9848  0
            34.25     6.9662  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 206, station 191:

 sample_key depth O2_CTD_mLL qc
             5.66     4.6059  0
            25.78     6.9533  0
            51.11     5.6036  0
            99.96     5.4140  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 211, station 197:

 sample_key  depth  value     method qc
              5.06 0.2015 PO4_Tech_F  1
             25.35 0.2745 PO4_Tech_F  1
             51.08 0.6070 PO4_Tech_F  1
            112.09 0.7600 PO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 212, station 198:

 sample_key  depth value     method qc
              5.05 0.176 PO4_Tech_F  1
             24.14 0.392 PO4_Tech_F  1
             50.49 0.630 PO4_Tech_F  1
            113.00 0.733 PO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 212, station 198:

 sample_key  depth value      method qc
              5.05 1.535 SiO4_Tech_F  1
             24.14 3.005 SiO4_Tech_F  1
             50.49 4.630 SiO4_Tech_F  1
            113.00 5.455 SiO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 213, station 199:

 sample_key  depth O2_CTD_mLL qc
              4.11     5.1463  0
             25.62     5.0833  0
             51.12     5.5838  0
            188.76     4.0026  0


-> QC repot:
      Filename Pressure Uniqueno Variable Values
 18NE16016_213     5.14   413719     phos   0.08
                                                        Test.failed
  Out of Nutrient Climatology in box(es) 8 (Min=0.09 Max=0.73 n=31)



-> Flagged PHOSPHATE, event 213, station 199:

 sample_key depth value     method qc
             4.11 0.000 PO4_Tech_F  2
            25.62 0.000 PO4_Tech_F  2
            51.12 0.153 PO4_Tech_F  2


-> QC repot:
      Filename Pressure Uniqueno Variable Values
 18NE16016_213     5.14   413719     phos   0.08
                                                        Test.failed
  Out of Nutrient Climatology in box(es) 8 (Min=0.09 Max=0.73 n=31)



-> Flagged NITRATE, event 216, station 201:

 sample_key  depth value        method qc
              4.67 0.265 NO2NO3_Tech_F  1
             24.68 0.330 NO2NO3_Tech_F  1
             51.89 3.030 NO2NO3_Tech_F  1
            113.29 8.590 NO2NO3_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 216, station 201:

 sample_key  depth  value     method qc
              4.67 0.2210 PO4_Tech_F  1
             24.68 0.3050 PO4_Tech_F  1
             51.89 0.5345 PO4_Tech_F  1
            113.29 0.7690 PO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 220, station 205:

 sample_key depth value      method qc
             5.00 0.770 SiO4_Tech_F  2
            23.58 1.420 SiO4_Tech_F  1
            49.79 6.945 SiO4_Tech_F  1
            94.37 8.540 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 221, station 206:

 sample_key  depth  value      method qc
              5.18  0.735 SiO4_Tech_F  2
             25.79  1.370 SiO4_Tech_F  1
             50.53  6.655 SiO4_Tech_F  1
            124.99 10.235 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 229, station 213:

 sample_key  depth value      method qc
              5.30 2.525 SiO4_Tech_F  2
             25.26 2.430 SiO4_Tech_F  1
             49.77 6.595 SiO4_Tech_F  1
            145.00 6.575 SiO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 274, station 251:

 sample_key  depth  value     method qc
              5.44 0.1550 PO4_Tech_F  1
             25.01 0.1900 PO4_Tech_F  1
             50.47 0.4345 PO4_Tech_F  1
            101.03 0.6745 PO4_Tech_F  2
            258.36 1.1435 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 288, station 309:

 sample_key  depth  value     method qc
              5.14 0.0835 PO4_Tech_F  2
             24.53 0.3420 PO4_Tech_F  1
             50.80 0.5515 PO4_Tech_F  1
            100.18 0.9190 PO4_Tech_F  1
            436.25 1.5525 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 289, station 311:

 sample_key  depth  value     method qc
              4.39 0.0870 PO4_Tech_F  2
             25.74 0.3545 PO4_Tech_F  1
             50.82 0.5645 PO4_Tech_F  1
            300.07 1.5560 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 296, station 342:

 sample_key  depth value      method qc
              4.55 0.715 SiO4_Tech_F  1
             25.42 2.595 SiO4_Tech_F  1
             49.92 7.515 SiO4_Tech_F  1
            126.71 7.325 SiO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 48, station 42:

 sample_key depth O2_CTD_mLL qc
             4.51     6.1472  0
            24.56     6.1147  0
            50.82     6.0320  0
            67.13     5.9948  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 60, station 56:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               4.39      31.3577    0   97.14           32.276    7
              24.67      31.7479    0   97.14           32.276    7
              50.01      32.1013    0   97.14           32.276    7
              97.14      32.6605    0   97.14           32.276    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE17002"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE17002 FLAG Report:,  2019-03-15 12:15:07
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged OXYGEN, event 5, station 9:

 sample_key depth O2_CTD_mLL qc
             5.46     5.0608  0
            82.70     6.3980  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 7, station 11:

 sample_key depth O2_CTD_mLL qc
             5.56     6.4008  0
            34.85     6.9676  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 8, station 12:

 sample_key depth O2_CTD_mLL qc
             4.67     6.2274  0
            66.16     6.7598  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 9, station HL_02:

 sample_key  depth O2_CTD_mLL qc
              1.87     7.6636  0
              5.60     7.6646  0
             10.29     7.6642  0
             20.80     7.6492  0
             31.43     7.6514  0
             40.41     7.2272  0
             50.76     7.2272  0
             76.70     6.7945  0
            101.19     6.7357  0
            159.22     6.4567  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE17020"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE17020 FLAG Report:,  2019-03-15 12:15:51
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged OXYGEN, event 108, station 113:

 sample_key  depth O2_CTD_mLL qc
              5.58     3.8395  0
             25.58     6.4372  0
             50.97     5.7516  0
            225.97     3.7024  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 134, station 135:

 sample_key  depth O2_CTD_mLL qc
              5.39     5.4223  0
             24.39     7.1544  0
             49.64     6.7904  0
            115.67     5.7995  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 135, station 136:

 sample_key  depth O2_CTD_mLL qc
              4.68     5.5586  0
             24.55     7.1634  0
             50.44     7.0070  0
            142.46     5.8656  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 161, station 163:

 sample_key  depth  value     method qc
              5.43 0.2130 PO4_Tech_F  1
             25.49 0.5295 PO4_Tech_F  1
             49.95 0.8560 PO4_Tech_F  1
            332.85 1.8170 PO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 161, station 163:

 sample_key  depth value      method qc
              5.43  0.68 SiO4_Tech_F  1
             25.49  1.37 SiO4_Tech_F  1
             49.95  4.72 SiO4_Tech_F  1
            332.85 30.80 SiO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 234, station 224:

 sample_key  depth  value        method qc
              5.59  0.295 NO2NO3_Tech_F  1
             24.86  2.240 NO2NO3_Tech_F  2
             49.80  4.085 NO2NO3_Tech_F  1
            211.89 18.140 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 237, station 227:

 sample_key  depth value        method qc
              4.20 0.225 NO2NO3_Tech_F  1
             24.96 0.155 NO2NO3_Tech_F  1
             50.62 2.470 NO2NO3_Tech_F  1
            120.99 7.970 NO2NO3_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 239, station 228:

 sample_key depth value      method qc
             4.93 0.310 SiO4_Tech_F  1
            25.38 0.300 SiO4_Tech_F  1
            37.77 0.475 SiO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 45, station 39:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               5.24      32.1653    0   25.17           32.435    7
              25.17      32.1638    0   25.17           32.435    7
              50.17      32.3449    0   25.17           32.435    7
              63.08      32.4319    0   25.17           32.435    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 62, station 59:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               5.20       1.4439    0    5.20           31.677    7
               5.20       1.4439    0   25.42           32.055    7
               5.20       1.4439    0   50.52           32.282    7
               5.20       1.4439    0  127.15           32.744    7
              25.42      14.0345    0    5.20           31.677    7
              25.42      14.0345    0   25.42           32.055    7
              25.42      14.0345    0   50.52           32.282    7
              25.42      14.0345    0  127.15           32.744    7
              50.52      31.3363    0    5.20           31.677    7
              50.52      31.3363    0   25.42           32.055    7
              50.52      31.3363    0   50.52           32.282    7
              50.52      31.3363    0  127.15           32.744    7
             127.15      31.8343    0    5.20           31.677    7
             127.15      31.8343    0   25.42           32.055    7
             127.15      31.8343    0   50.52           32.282    7
             127.15      31.8343    0  127.15           32.744    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 62, station 59:

 sample_key  depth O2_CTD_mLL qc
              5.20     5.4285  0
             25.42     4.7241  0
             50.52     4.3137  0
            127.15     4.3409  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 68, station 64:

 sample_key  depth O2_CTD_mLL qc
              4.39     5.9625  0
             24.72     6.5893  0
             50.63     5.8650  0
            217.14     4.1824  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 76, station 77:

 sample_key  depth  value      method qc
              5.48  0.000 SiO4_Tech_F  2
             24.60  1.585 SiO4_Tech_F  1
             50.29  4.435 SiO4_Tech_F  1
            313.90 10.450 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 77, station 78:

 sample_key  depth  value      method qc
              5.06  0.000 SiO4_Tech_F  2
             25.16  0.920 SiO4_Tech_F  1
             50.97  2.180 SiO4_Tech_F  1
            100.97  6.055 SiO4_Tech_F  1
            321.52 10.170 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 80, station 80:

 sample_key  depth value      method qc
              5.21  0.00 SiO4_Tech_F  2
             24.76  0.54 SiO4_Tech_F  1
             50.31  2.12 SiO4_Tech_F  1
            100.71  5.65 SiO4_Tech_F  1
            289.28 11.27 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 81, station 81:

 sample_key  depth  value      method qc
              5.69  0.000 SiO4_Tech_F  2
             24.77  0.650 SiO4_Tech_F  1
             50.19  3.280 SiO4_Tech_F  1
            170.89 13.665 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 90, station 90:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               5.20      34.2276    0     5.2           34.502    7
              25.40      35.1118    0     5.2           34.502    7
              51.06      35.1392    0     5.2           34.502    7
             129.95      35.4725    0     5.2           34.502    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 92, station 93:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               5.23      34.8652    0    5.23           35.277    7
              25.77      35.6377    0    5.23           35.277    7
              50.92      35.6192    0    5.23           35.277    7
             100.84      35.2641    0    5.23           35.277    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event 92, station 93:

 sample_key  depth O2_CTD_mLL qc
              5.23     4.6867  0
             25.77     4.7338  0
             50.92     4.9372  0
            100.84     4.1421  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 92, station 93:

 sample_key  depth  value        method qc
              5.23 11.895 NO2NO3_Tech_F  2
             25.77  0.890 NO2NO3_Tech_F  1
             50.92  0.210 NO2NO3_Tech_F  1
            100.84  0.215 NO2NO3_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 92, station 93:

 sample_key  depth  value     method qc
              5.23 0.8040 PO4_Tech_F  1
             25.77 0.1855 PO4_Tech_F  1
             50.92 0.0885 PO4_Tech_F  2
            100.84 0.1030 PO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 92, station 93:

 sample_key  depth value      method qc
              5.23 5.825 SiO4_Tech_F  2
             25.77 0.825 SiO4_Tech_F  1
             50.92 0.240 SiO4_Tech_F  1
            100.84 0.155 SiO4_Tech_F  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE17102"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE17102 FLAG Report:,  2019-03-15 12:17:11
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged OXYGEN, event 2, station 2:

 sample_key  depth O2_CTD_mLL qc
              5.06     7.3760  0
             25.08     7.3724  0
             50.08     7.3005  0
            113.79     5.9562  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18NE95031"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18NE95031 FLAG Report:,  2019-03-15 12:17:34
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged CHLOROPHYLL, event IML1995031161, station 161:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              1.59                 0.17  1
              5.55                 0.18  1
             15.27                 0.85  1
             60.08                 0.10  1
            322.62                 0.01  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1995031161, station 161:

 sample_key  depth   value      method qc
              1.59 0.47667 PO4_Tech_SF  1
              5.55 0.42000 PO4_Tech_SF  7
             15.27 0.64000 PO4_Tech_SF  1
             60.08 0.98000 PO4_Tech_SF  1
            322.62 1.82000 PO4_Tech_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1995031161, station 161:

 sample_key  depth value       method qc
              1.59  1.03 SiO4_Tech_SF  1
              5.55  1.11 SiO4_Tech_SF  1
             15.27  1.53 SiO4_Tech_SF  7
             60.08  3.27 SiO4_Tech_SF  1
            322.62 24.70 SiO4_Tech_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1995031211, station 211:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              0.50              0.09000  2
              5.06              0.10000  1
             14.28              0.16667  1
            159.79              0.01000  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML1995031211, station 211:

 sample_key  depth    value         method qc
              0.50  1.71333 NO2NO3_Tech_SF  1
              5.06  1.57000 NO2NO3_Tech_SF  1
             14.28  1.88000 NO2NO3_Tech_SF  1
            159.79 15.47000 NO2NO3_Tech_SF  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1995031251, station 251:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              1.78                 0.08  1
              4.96                 0.11  1
             14.87                 0.15  1
             49.68                 0.15  1
            148.30                 0.03  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1995031251, station 251:

 sample_key  depth value      method qc
              1.78  0.37 PO4_Tech_SF  7
              4.96  0.38 PO4_Tech_SF  1
             14.87  0.45 PO4_Tech_SF  1
             49.68  0.92 PO4_Tech_SF  1
            148.30  1.29 PO4_Tech_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1995031251, station 251:

 sample_key  depth   value       method qc
              1.78 0.78667 SiO4_Tech_SF  1
              4.96 0.75000 SiO4_Tech_SF  1
             14.87 0.48000 SiO4_Tech_SF  7
             49.68 0.62000 SiO4_Tech_SF  1
            148.30 9.46000 SiO4_Tech_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML1995031271, station 271:

 sample_key  depth    value         method qc
              0.99  1.32333 NO2NO3_Tech_SF  2
              4.96  1.96000 NO2NO3_Tech_SF  1
             14.87  1.82000 NO2NO3_Tech_SF  1
             59.49  5.83000 NO2NO3_Tech_SF  7
            416.08 24.32000 NO2NO3_Tech_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1995031271, station 271:

 sample_key  depth value      method qc
              0.99  0.42 PO4_Tech_SF  1
              4.96  0.35 PO4_Tech_SF  1
             14.87  0.46 PO4_Tech_SF  1
             59.49  1.04 PO4_Tech_SF  1
            416.08  1.88 PO4_Tech_SF  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML199503181, station 81:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              1.69                 0.13  1
              5.16                 0.16  1
             14.77                 0.16  7
             99.44                 0.04  1
            348.46                 0.01  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML199503181, station 81:

 sample_key  depth value       method qc
              1.69  2.35 SiO4_Tech_SF  7
              5.16  1.18 SiO4_Tech_SF  2
             14.77  0.93 SiO4_Tech_SF  1
             99.44  3.57 SiO4_Tech_SF  1
            348.46 30.49 SiO4_Tech_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18OK05644"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18OK05644 FLAG Report:,  2019-03-15 12:18:07
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18OL03004"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18OL03004 FLAG Report:,  2019-03-15 12:18:35
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged SILICATE, event IML2003004311, station 311:

 sample_key  depth  value      method qc
              1.09  2.610 SiO4_Alp_SF  1
              5.06  3.250 SiO4_Alp_SF  1
             14.87  3.615 SiO4_Alp_SF  1
             24.99  4.965 SiO4_Alp_SF  1
             50.37  8.235 SiO4_Alp_SF  1
            100.04  8.680 SiO4_Alp_SF  1
            200.22 21.720 SiO4_Alp_SF  1
            300.16 31.520 SiO4_Alp_SF  1
            320.26 35.690 SiO4_Alp_SF  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML2003004341, station 341:

 sample_key  depth  value        method qc
              1.59  6.070 NO2NO3_Alp_SF  2
              5.35  6.075 NO2NO3_Alp_SF  2
             14.97  5.755 NO2NO3_Alp_SF  1
             25.09  6.950 NO2NO3_Alp_SF  2
             49.87  6.990 NO2NO3_Alp_SF  1
             99.93  6.965 NO2NO3_Alp_SF  1
            199.92 11.430 NO2NO3_Alp_SF  1
            249.64 17.530 NO2NO3_Alp_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML2003004341, station 341:

 sample_key  depth  value      method qc
              1.59  8.185 SiO4_Alp_SF  1
              5.35  8.315 SiO4_Alp_SF  2
             14.97  7.930 SiO4_Alp_SF  2
             25.09  8.645 SiO4_Alp_SF  2
             49.87  7.980 SiO4_Alp_SF  1
             99.93  7.905 SiO4_Alp_SF  1
            199.92 11.770 SiO4_Alp_SF  1
            249.64 16.785 SiO4_Alp_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18OL03019"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18OL03019 FLAG Report:,  2019-03-15 12:19:29
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18OL03064"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18OL03064 FLAG Report:,  2019-03-15 12:20:09
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18OL06008"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18OL06008 FLAG Report:,  2019-03-15 12:20:32
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged OXYGEN, event IML2006008331, station 331:

 sample_key  depth O2_CTD_mLL qc
              1.59   290.2007  0
              5.06   291.6745  0
             15.67   332.5830  0
             25.58   370.3654  0
             50.57   342.0063  0
            100.13   298.9094  0
            200.12   171.3604  0
            300.35   170.2886  0
            400.73   180.0245  0
            459.42   187.6167  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event IML2006008371, station 371:

 sample_key depth O2_CTD_mLL qc
             2.28   264.5658  0
             5.06   264.1192  0
            15.17   286.8512  0
            25.39   316.2375  0
            50.08   343.3461  0
            54.44   313.5579  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event IML2006008401, station 401:

 sample_key depth O2_CTD_mLL qc
             2.38   267.6920  0
             5.26   267.5581  0
            15.67   318.8277  0
            25.68   408.2371  0
            34.90   335.7539  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18OL16015"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18OL16015 FLAG Report:,  2019-03-15 12:21:19
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged SILICATE, event IML20160150651, station 651:

 sample_key  depth  value       method qc
              1.29  0.170 SiO4_Tech_SF  1
              5.06  0.160 SiO4_Tech_SF  1
             15.07  0.115 SiO4_Tech_SF  1
             24.59  0.120 SiO4_Tech_SF  1
             49.88  0.605 SiO4_Tech_SF  1
             99.34  7.020 SiO4_Tech_SF  1
            199.92 23.070 SiO4_Tech_SF  1
            300.06 27.325 SiO4_Tech_SF  1
            400.05 31.745 SiO4_Tech_SF  1
            452.79 34.900 SiO4_Tech_SF  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML20160150661, station 661:

 sample_key  depth    value         method qc
              1.59  0.03667 NO2NO3_Tech_SF  1
              5.06  0.05000 NO2NO3_Tech_SF  1
             15.07  0.04500 NO2NO3_Tech_SF  1
             25.48  0.07000 NO2NO3_Tech_SF  1
             49.28  0.75000 NO2NO3_Tech_SF  1
            100.24  5.61000 NO2NO3_Tech_SF  1
            201.12 20.03500 NO2NO3_Tech_SF  1
            299.57 23.38000 NO2NO3_Tech_SF  2
            317.29 23.79500 NO2NO3_Tech_SF  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event IML20160151331, station 1331:

 sample_key depth O2_CTD_mLL qc
             2.68   333.3422  0
            23.90   366.9712  0
            53.44   255.0086  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event IML20160151821, station 1821:

 sample_key depth O2_CTD_mLL qc
             1.19   298.9987  0
             5.06   297.3909  0
            15.07   290.3347  0
            15.07   290.2900  0
            25.09   288.6376  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18OL17001"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18OL17001 FLAG Report:,  2019-03-15 12:23:07
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged SALINITY, event 12, station BBL_03:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               1.84      31.1251    0    1.84           31.699    7
               1.84      31.1251    0   80.62           31.875    1
               2.32      31.1255    0    1.84           31.699    7
               2.32      31.1255    0   80.62           31.875    1
              11.05      31.1256    0    1.84           31.699    7
              11.05      31.1256    0   80.62           31.875    1
              19.89      31.1378    0    1.84           31.699    7
              19.89      31.1378    0   80.62           31.875    1
              31.00      31.3222    0    1.84           31.699    7
              31.00      31.3222    0   80.62           31.875    1
              41.17      31.5201    0    1.84           31.699    7
              41.17      31.5201    0   80.62           31.875    1
              50.52      31.7556    0    1.84           31.699    7
              50.52      31.7556    0   80.62           31.875    1
              60.00      31.8019    0    1.84           31.699    7
              60.00      31.8019    0   80.62           31.875    1
              80.62      31.8934    0    1.84           31.699    7
              80.62      31.8934    0   80.62           31.875    1
              88.62      31.9641    0    1.84           31.699    7
              88.62      31.9641    0   80.62           31.875    1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 128, station STAB_05:

 sample_key depth value      method qc
             1.83 0.000 SiO4_Tech_F  2
            19.93 0.000 SiO4_Tech_F  2
            30.01 0.000 SiO4_Tech_F  2
            39.71 0.000 SiO4_Tech_F  2
            50.25 0.155 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 130, station STAB_06:

 sample_key  depth  value      method qc
             51.02  0.000 SiO4_Tech_F  2
             60.06  2.295 SiO4_Tech_F  1
             78.39  4.205 SiO4_Tech_F  1
            100.98  7.955 SiO4_Tech_F  1
            149.97 10.855 SiO4_Tech_F  1
            201.03 13.555 SiO4_Tech_F  1
            300.36 20.810 SiO4_Tech_F  1
            400.14 25.880 SiO4_Tech_F  1
            445.57 24.285 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 134, station CSL_06:

 sample_key depth value      method qc
             1.57 0.000 SiO4_Tech_F  2
            10.34 0.000 SiO4_Tech_F  2
            20.26 0.000 SiO4_Tech_F  2
            30.05 0.000 SiO4_Tech_F  2
            39.84 1.405 SiO4_Tech_F  1
            50.39 2.755 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 137, station CSL_05:

 sample_key depth value      method qc
             1.92 0.000 SiO4_Tech_F  2
            10.15 0.000 SiO4_Tech_F  2
            19.57 0.000 SiO4_Tech_F  2
            30.06 0.000 SiO4_Tech_F  2
            40.27 3.895 SiO4_Tech_F  1
            50.62 2.540 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 139, station CSL_04:

 sample_key  depth  value        method qc
             79.49  4.910 NO2NO3_Tech_F  7
             79.69  4.240 NO2NO3_Tech_F  7
            100.29  6.645 NO2NO3_Tech_F  1
            150.36 12.535 NO2NO3_Tech_F  1
            200.06 17.145 NO2NO3_Tech_F  1
            251.08 21.115 NO2NO3_Tech_F  1
            299.82 22.090 NO2NO3_Tech_F  1
            462.28 21.900 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 140, station CSL_04:

 sample_key depth value      method qc
             2.06  0.00 SiO4_Tech_F  2
            10.06  0.00 SiO4_Tech_F  2
            19.45  0.00 SiO4_Tech_F  2
            40.00  2.49 SiO4_Tech_F  1
            50.60  3.29 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 149, station BP_01:

 sample_key  depth  value      method qc
              2.69  0.200 SiO4_Tech_F  1
             11.12  0.000 SiO4_Tech_F  2
             20.82  0.220 SiO4_Tech_F  1
             30.93  0.720 SiO4_Tech_F  1
             39.28  2.600 SiO4_Tech_F  1
             49.50  2.980 SiO4_Tech_F  1
             57.74  4.840 SiO4_Tech_F  1
             80.34  6.575 SiO4_Tech_F  1
            100.17  7.035 SiO4_Tech_F  1
            223.58 12.245 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 151, station BP_04:

 sample_key  depth  value      method qc
              2.63  0.185 SiO4_Tech_F  1
             10.41  0.000 SiO4_Tech_F  2
             20.87  0.000 SiO4_Tech_F  2
             30.55  0.435 SiO4_Tech_F  1
             39.66  3.140 SiO4_Tech_F  1
             49.87  6.080 SiO4_Tech_F  1
             59.40  6.550 SiO4_Tech_F  1
             80.36  6.590 SiO4_Tech_F  1
            100.93  7.395 SiO4_Tech_F  1
            251.45 11.395 SiO4_Tech_F  1
            382.43 15.080 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 153, station BP_05:

 sample_key  depth  value      method qc
              2.63  0.000 SiO4_Tech_F  2
              9.12  0.045 SiO4_Tech_F  2
             19.32  0.000 SiO4_Tech_F  2
             29.24  0.125 SiO4_Tech_F  1
             39.29  0.575 SiO4_Tech_F  1
             50.44  0.860 SiO4_Tech_F  1
             60.88  1.195 SiO4_Tech_F  1
             78.65  3.030 SiO4_Tech_F  1
             99.93  4.575 SiO4_Tech_F  1
            251.44 14.310 SiO4_Tech_F  1
            400.92 16.660 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 156, station BANQ_B6:

 sample_key depth value      method qc
             2.48 0.000 SiO4_Tech_F  2
            10.27 0.000 SiO4_Tech_F  2
            19.19 0.000 SiO4_Tech_F  2
            30.36 0.000 SiO4_Tech_F  2
            40.29 0.000 SiO4_Tech_F  2
            49.93 0.175 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 158, station BANQ_B5:

 sample_key  depth  value      method qc
              2.29  0.000 SiO4_Tech_F  2
             10.47  0.000 SiO4_Tech_F  2
             19.92  0.000 SiO4_Tech_F  2
             30.03  0.000 SiO4_Tech_F  2
             40.95  0.000 SiO4_Tech_F  2
             49.26  0.395 SiO4_Tech_F  1
             60.30  1.200 SiO4_Tech_F  1
             80.32  4.220 SiO4_Tech_F  1
            100.70  4.330 SiO4_Tech_F  1
            200.00 11.705 SiO4_Tech_F  1
            422.37 15.050 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 160, station BANQ_B4:

 sample_key  depth  value      method qc
              2.75  0.000 SiO4_Tech_F  2
              9.64  0.045 SiO4_Tech_F  2
             19.27  0.000 SiO4_Tech_F  2
             30.40  0.050 SiO4_Tech_F  1
             39.87  0.000 SiO4_Tech_F  2
             48.39  0.000 SiO4_Tech_F  2
             60.02  0.095 SiO4_Tech_F  1
             80.11  1.170 SiO4_Tech_F  1
             99.74  3.550 SiO4_Tech_F  1
            197.67  9.165 SiO4_Tech_F  1
            382.74 30.500 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 17, station PS_05:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
              60.12      32.5105    0  228.12           35.857    7
              75.79      32.7337    0  228.12           35.857    7
              99.66      32.9831    0  228.12           35.857    7
             125.56      33.8032    0  228.12           35.857    7
             149.99      34.7591    0  228.12           35.857    7
             177.95      35.3382    0  228.12           35.857    7
             228.12      35.1735    0  228.12           35.857    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 18, station PS_05:

 sample_key depth value        method qc
             2.41 0.195 NO2NO3_Tech_F  1
            10.00 0.210 NO2NO3_Tech_F  1
            20.16 0.235 NO2NO3_Tech_F  1
            30.72 0.235 NO2NO3_Tech_F  2
            40.64 0.435 NO2NO3_Tech_F  2
            49.60 3.860 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 20, station PS_07:

 sample_key depth value        method qc
             2.45 0.190 NO2NO3_Tech_F  1
             9.71 0.175 NO2NO3_Tech_F  1
            20.89 0.200 NO2NO3_Tech_F  1
            30.16 0.225 NO2NO3_Tech_F  1
            40.35 0.325 NO2NO3_Tech_F  2
            50.94 0.940 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 20, station PS_07:

 sample_key depth value      method qc
             2.45 0.070 SiO4_Tech_F  1
             9.71 0.160 SiO4_Tech_F  1
            20.89 0.115 SiO4_Tech_F  1
            30.16 0.495 SiO4_Tech_F  1
            40.35 0.150 SiO4_Tech_F  2
            50.94 0.710 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 26, station PS_08:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               1.79      32.2866    0    1.85           32.824    7
               1.85      32.2852    0    1.85           32.824    7
              10.60      32.3070    0    1.85           32.824    7
              20.51      32.3180    0    1.85           32.824    7
              30.01      32.3381    0    1.85           32.824    7
              39.76      32.6241    0    1.85           32.824    7
              50.41      32.7486    0    1.85           32.824    7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 32, station PS_04:

 sample_key depth value      method qc
             1.89 0.110 SiO4_Tech_F  1
            10.01 0.115 SiO4_Tech_F  1
            19.53 0.110 SiO4_Tech_F  1
            30.53 0.160 SiO4_Tech_F  2
            40.10 0.320 SiO4_Tech_F  2
            51.28 1.635 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 36, station PS_01:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
               1.33      31.8198    0    1.33           31.803    1
               1.33      31.8198    0   40.92           33.663    7
               1.33      31.8198    0   86.73           33.227    1
               9.97      31.8324    0    1.33           31.803    1
               9.97      31.8324    0   40.92           33.663    7
               9.97      31.8324    0   86.73           33.227    1
              20.22      31.9248    0    1.33           31.803    1
              20.22      31.9248    0   40.92           33.663    7
              20.22      31.9248    0   86.73           33.227    1
              30.79      32.0407    0    1.33           31.803    1
              30.79      32.0407    0   40.92           33.663    7
              30.79      32.0407    0   86.73           33.227    1
              40.92      32.2099    0    1.33           31.803    1
              40.92      32.2099    0   40.92           33.663    7
              40.92      32.2099    0   86.73           33.227    1
              50.62      32.5707    0    1.33           31.803    1
              50.62      32.5707    0   40.92           33.663    7
              50.62      32.5707    0   86.73           33.227    1
              60.04      32.6873    0    1.33           31.803    1
              60.04      32.6873    0   40.92           33.663    7
              60.04      32.6873    0   86.73           33.227    1
              75.91      33.2050    0    1.33           31.803    1
              75.91      33.2050    0   40.92           33.663    7
              75.91      33.2050    0   86.73           33.227    1
              86.73      33.2475    0    1.33           31.803    1
              86.73      33.2475    0   40.92           33.663    7
              86.73      33.2475    0   86.73           33.227    1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SALINITY, event 44, station BBL_07:

 sample_key depth.x Salinity_CTD qc.x depth.y Salinity_Sal_PSS qc.y
              60.55      32.9872    0  249.54           35.290    7
              60.55      32.9872    0 1498.69           34.945    7
              60.55      32.9872    0 1880.21           34.931    7
              79.86      33.2161    0  249.54           35.290    7
              79.86      33.2161    0 1498.69           34.945    7
              79.86      33.2161    0 1880.21           34.931    7
             100.14      33.1348    0  249.54           35.290    7
             100.14      33.1348    0 1498.69           34.945    7
             100.14      33.1348    0 1880.21           34.931    7
             249.54      32.1977    0  249.54           35.290    7
             249.54      32.1977    0 1498.69           34.945    7
             249.54      32.1977    0 1880.21           34.931    7
             250.19      32.3778    0  249.54           35.290    7
             250.19      32.3778    0 1498.69           34.945    7
             250.19      32.3778    0 1880.21           34.931    7
             250.39      32.3263    0  249.54           35.290    7
             250.39      32.3263    0 1498.69           34.945    7
             250.39      32.3263    0 1880.21           34.931    7
             250.72      32.3432    0  249.54           35.290    7
             250.72      32.3432    0 1498.69           34.945    7
             250.72      32.3432    0 1880.21           34.931    7
             499.33      32.6035    0  249.54           35.290    7
             499.33      32.6035    0 1498.69           34.945    7
             499.33      32.6035    0 1880.21           34.931    7
             749.35      32.6650    0  249.54           35.290    7
             749.35      32.6650    0 1498.69           34.945    7
             749.35      32.6650    0 1880.21           34.931    7
             999.59      32.6924    0  249.54           35.290    7
             999.59      32.6924    0 1498.69           34.945    7
             999.59      32.6924    0 1880.21           34.931    7
            1498.69      32.4695    0  249.54           35.290    7
            1498.69      32.4695    0 1498.69           34.945    7
            1498.69      32.4695    0 1880.21           34.931    7
            1880.21      32.2612    0  249.54           35.290    7
            1880.21      32.2612    0 1498.69           34.945    7
            1880.21      32.2612    0 1880.21           34.931    7


-> QC repot:
      Filename   Pressure Uniqueno Variable   Values
 18OL17001_044  -5 to 5 m      NaN     psal  31.09  
                                                            Test.failed
  Out of TS Climatology by more than 3*std in box(es) 68 (31.67  0.57)



-> Flagged OXYGEN, event 44, station BBL_07:

 sample_key   depth O2_CTD_mLL qc
              60.55    11.0992  0
              79.86     9.6164  0
             100.14     9.6495  0
             249.54     8.2437  0
             250.19     8.3382  0
             250.39     8.3305  0
             250.72     8.3291  0
             499.33     7.4423  0
             749.35     7.2694  0
             999.59     7.2454  0
            1498.69     6.6556  0
            1880.21     6.8356  0


-> QC repot:
      Filename   Pressure Uniqueno Variable   Values
 18OL17001_044  -5 to 5 m      NaN     psal  31.09  
 18OL17001_044       1.92   440979     slca   0.00  
 18OL17001_044      10.16   440978     slca   0.00  
 18OL17001_044      19.58   440977     slca   0.00  
 18OL17001_044      30.07   440976     slca   0.00  
                                                            Test.failed
  Out of TS Climatology by more than 3*std in box(es) 68 (31.67  0.57)
     Out of Nutrient Climatology in box(es) 8 (Min=0.09 Max=8.20 n=109)
     Out of Nutrient Climatology in box(es) 8 (Min=0.09 Max=7.37 n=170)
     Out of Nutrient Climatology in box(es) 8 (Min=0.09 Max=7.37 n=170)
     Out of Nutrient Climatology in box(es) 8 (Min=0.09 Max=7.37 n=170)



-> Flagged OXYGEN, event 65, station HL_05:

 sample_key depth O2_CTD_mLL qc
             2.67     7.5318  0
             2.85     7.5498  0
            10.28     7.5612  0
            19.60     7.7102  0
            30.07     7.4250  0
            39.33     7.2886  0
            48.52     7.1314  0
            60.18     6.8970  0
            80.45     6.5709  0
            95.60     5.6534  0


-> QC repot:
      Filename Pressure Uniqueno Variable  Values
 18OL17001_065     2.49   441084     slca  0.00  
 18OL17001_065    10.27   441083     slca  0.00  
 18OL17001_065    19.19   441082     slca  0.00  
 18OL17001_065    30.37   441081     slca  0.00  
 18OL17001_065    40.30   441080     slca  0.00  
                                                          Test.failed
   Out of Nutrient Climatology in box(es) 8 (Min=0.09 Max=8.20 n=109)
   Out of Nutrient Climatology in box(es) 8 (Min=0.09 Max=7.37 n=170)
   Out of Nutrient Climatology in box(es) 8 (Min=0.09 Max=7.37 n=170)
  Out of Nutrient Climatology in box(es) 8 (Min=0.04 Max=18.04 n=352)
  Out of Nutrient Climatology in box(es) 8 (Min=0.04 Max=18.04 n=352)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18OL17048"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18OL17048 FLAG Report:,  2019-03-15 12:24:38
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event IML20170481021, station 1021:

 sample_key depth  value         method qc
             1.78  6.155 NO2NO3_Tech_SF  1
             4.96  5.985 NO2NO3_Tech_SF  1
            14.97  4.740 NO2NO3_Tech_SF  1
            25.09  3.535 NO2NO3_Tech_SF  7
            30.04 11.720 NO2NO3_Tech_SF  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18PZ96058"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18PZ96058 FLAG Report:,  2019-03-15 12:25:17
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged CHLOROPHYLL, event IML1996058101, station 101:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              0.50                 0.20  7
             10.41                 0.26  1
             19.44                 0.27  1
             29.35                 0.30  1
             53.05                 0.13  1
             79.12                 0.09  1
            102.91                 0.06  7
            152.85                 0.02  1
            203.09                 0.01  1
            235.18                 0.01  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML1996058101, station 101:

 sample_key  depth  value        method qc
             10.41  1.010 NO2NO3_Tech_F  1
             19.44  1.050 NO2NO3_Tech_F  1
             29.35  1.190 NO2NO3_Tech_F  1
             53.05  1.335 NO2NO3_Tech_F  7
             79.12  3.430 NO2NO3_Tech_F  2
            102.91  5.335 NO2NO3_Tech_F  1
            152.85 10.130 NO2NO3_Tech_F  1
            203.09 13.925 NO2NO3_Tech_F  1
            235.18 16.060 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1996058101, station 101:

 sample_key  depth value     method qc
             10.41 0.460 PO4_Tech_F  1
             19.44 0.500 PO4_Tech_F  1
             29.35 0.555 PO4_Tech_F  7
             53.05 0.535 PO4_Tech_F  1
             79.12 0.670 PO4_Tech_F  2
            102.91 0.770 PO4_Tech_F  1
            152.85 1.095 PO4_Tech_F  1
            203.09 1.220 PO4_Tech_F  1
            235.18 1.275 PO4_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1996058101, station 101:

 sample_key  depth  value      method qc
             10.41  1.860 SiO4_Tech_F  1
             19.44  2.000 SiO4_Tech_F  7
             29.35  2.040 SiO4_Tech_F  1
             53.05  2.145 SiO4_Tech_F  1
             79.12  3.390 SiO4_Tech_F  1
            102.91  4.680 SiO4_Tech_F  1
            152.85 10.220 SiO4_Tech_F  1
            203.09 14.395 SiO4_Tech_F  7
            235.18 15.975 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML199605811, station 11:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              0.50                 0.35  1
              7.54                 0.55  1
             28.86                 0.46  7
             53.45                 0.45  1
            102.52                 0.07  1
            151.87                 0.02  1
            202.70                 0.01  1
            251.54                 0.01  1
            302.74                 0.01  1
            351.85                 0.00  1
            370.46                 0.00  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML199605811, station 11:

 sample_key  depth value        method qc
              0.50  2.14 NO2NO3_Tech_F  7
              7.54  1.42 NO2NO3_Tech_F  1
             28.86  0.73 NO2NO3_Tech_F  1
             53.45  0.91 NO2NO3_Tech_F  1
            102.52  3.87 NO2NO3_Tech_F  1
            151.87  8.41 NO2NO3_Tech_F  1
            202.70 10.68 NO2NO3_Tech_F  7
            251.54 16.02 NO2NO3_Tech_F  1
            302.74 17.87 NO2NO3_Tech_F  1
            351.85 17.82 NO2NO3_Tech_F  1
            370.46 16.68 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML199605811, station 11:

 sample_key  depth value     method qc
              0.50  0.64 PO4_Tech_F  1
              7.54  0.42 PO4_Tech_F  1
             28.86  0.35 PO4_Tech_F  1
             53.45  0.39 PO4_Tech_F  1
            102.52  0.62 PO4_Tech_F  1
            151.87  0.85 PO4_Tech_F  7
            202.70  1.07 PO4_Tech_F  1
            251.54  1.34 PO4_Tech_F  1
            302.74  1.49 PO4_Tech_F  1
            351.85  1.43 PO4_Tech_F  1
            370.46  1.35 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML199605811, station 11:

 sample_key  depth value      method qc
              0.50  2.83 SiO4_Tech_F  1
              7.54  1.93 SiO4_Tech_F  1
             28.86  1.07 SiO4_Tech_F  1
             53.45  1.35 SiO4_Tech_F  1
            102.52  3.37 SiO4_Tech_F  7
            151.87  7.03 SiO4_Tech_F  1
            202.70 12.69 SiO4_Tech_F  1
            251.54 19.36 SiO4_Tech_F  1
            302.74 28.36 SiO4_Tech_F  1
            351.85 22.01 SiO4_Tech_F  1
            370.46 21.93 SiO4_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML199605821, station 21:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              0.50                 0.36  1
              8.03                 0.41  1
             19.14                 0.39  1
             27.86                 0.43  7
             51.96                 0.44  1
            102.22                 0.25  1
            152.17                 0.03  1
            160.79                 0.02  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML199605821, station 21:

 sample_key  depth  value        method qc
              8.03  1.300 NO2NO3_Tech_F  7
             19.14  1.790 NO2NO3_Tech_F  1
             27.86  1.780 NO2NO3_Tech_F  1
             51.96  1.990 NO2NO3_Tech_F  1
            102.22  6.620 NO2NO3_Tech_F  1
            152.17 11.285 NO2NO3_Tech_F  1
            160.79 15.595 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML199605821, station 21:

 sample_key  depth value     method qc
              8.03 0.460 PO4_Tech_F  1
             19.14 0.520 PO4_Tech_F  1
             27.86 0.565 PO4_Tech_F  1
             51.96 0.490 PO4_Tech_F  1
            102.22 0.915 PO4_Tech_F  1
            152.17 1.155 PO4_Tech_F  1
            160.79 1.400 PO4_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML199605821, station 21:

 sample_key  depth  value      method qc
              8.03  2.950 SiO4_Tech_F  1
             19.14  3.330 SiO4_Tech_F  1
             27.86  3.750 SiO4_Tech_F  1
             51.96  2.815 SiO4_Tech_F  1
            102.22  8.915 SiO4_Tech_F  1
            152.17 12.490 SiO4_Tech_F  7
            160.79 18.175 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML199605831, station 31:

 sample_key  depth  value        method qc
              0.50  1.860 NO2NO3_Tech_F  1
              9.12  1.725 NO2NO3_Tech_F  7
             19.24  1.680 NO2NO3_Tech_F  1
             28.96  1.760 NO2NO3_Tech_F  1
             53.74  2.420 NO2NO3_Tech_F  1
            103.11  7.380 NO2NO3_Tech_F  7
            153.86 12.345 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML199605831, station 31:

 sample_key  depth value     method qc
              0.50 0.635 PO4_Tech_F  7
              9.12 0.570 PO4_Tech_F  1
             19.24 0.530 PO4_Tech_F  1
             28.96 0.600 PO4_Tech_F  1
             53.74 0.530 PO4_Tech_F  7
            103.11 0.955 PO4_Tech_F  1
            153.86 1.220 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML199605831, station 31:

 sample_key  depth  value      method qc
              0.50  4.460 SiO4_Tech_F  1
              9.12  4.450 SiO4_Tech_F  1
             19.24  4.370 SiO4_Tech_F  1
             28.96  4.545 SiO4_Tech_F  7
             53.74  4.160 SiO4_Tech_F  1
            103.11  8.145 SiO4_Tech_F  1
            153.86 14.820 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event IML1996058431, station 431:

 sample_key depth O2_CTD_mLL qc
             7.54   342.6315  0
            17.75   341.7383  0
            27.27   340.2645  0
            51.76   278.1425  0
            61.67   240.8960  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1996058431, station 431:

 sample_key depth Chl_a_Holm-Hansen_sF qc
             0.50                 0.45  1
             7.54                 0.37  1
            17.75                 0.45  1
            27.27                 0.35  7
            51.76                 0.05  1
            61.67                 0.07  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML1996058431, station 431:

 sample_key depth  value        method qc
             0.50  2.585 NO2NO3_Tech_F  1
             7.54  3.625 NO2NO3_Tech_F  7
            17.75  3.680 NO2NO3_Tech_F  1
            27.27  3.700 NO2NO3_Tech_F  1
            51.76 14.180 NO2NO3_Tech_F  1
            61.67 15.670 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1996058431, station 431:

 sample_key depth  value      method qc
             0.50  2.795 SiO4_Tech_F  1
             7.54  3.485 SiO4_Tech_F  1
            17.75  4.050 SiO4_Tech_F  1
            27.27  4.135 SiO4_Tech_F  1
            51.76 24.200 SiO4_Tech_F  1
            61.67 28.420 SiO4_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1996058441, station 441:

 sample_key depth Chl_a_Holm-Hansen_sF qc
             0.50                 1.04  1
             5.95                 0.32  1
            19.24                 0.17  7
            29.45                 0.39  1
            53.04                 0.20  1
            68.81                 0.15  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML1996058441, station 441:

 sample_key depth value        method qc
             0.50  4.67 NO2NO3_Tech_F  7
             5.95  4.93 NO2NO3_Tech_F  1
            19.24  4.95 NO2NO3_Tech_F  1
            29.45  4.77 NO2NO3_Tech_F  1
            53.04  4.59 NO2NO3_Tech_F  1
            68.81  9.98 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1996058441, station 441:

 sample_key depth value     method qc
             0.50 0.710 PO4_Tech_F  1
             5.95 0.720 PO4_Tech_F  1
            19.24 0.785 PO4_Tech_F  1
            29.45 0.765 PO4_Tech_F  1
            53.04 0.690 PO4_Tech_F  1
            68.81 1.460 PO4_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1996058441, station 441:

 sample_key depth  value      method qc
             0.50  5.505 SiO4_Tech_F  1
             5.95  5.320 SiO4_Tech_F  1
            19.24  5.460 SiO4_Tech_F  1
            29.45  5.115 SiO4_Tech_F  1
            53.04  4.800 SiO4_Tech_F  7
            68.81 12.905 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1996058451, station 451:

 sample_key depth Chl_a_Holm-Hansen_sF qc
             0.50                 0.42  7
             4.26                 0.37  1
            16.16                 0.62  1
            23.60                 0.41  1
            33.81                 0.54  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1996058451, station 451:

 sample_key depth value     method qc
             0.50 0.755 PO4_Tech_F  1
             4.26 0.755 PO4_Tech_F  1
            16.16 0.755 PO4_Tech_F  1
            23.60 0.685 PO4_Tech_F  7
            33.81 0.760 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1996058451, station 451:

 sample_key depth value      method qc
             0.50 5.510 SiO4_Tech_F  1
             4.26 5.435 SiO4_Tech_F  1
            16.16 5.430 SiO4_Tech_F  7
            23.60 4.925 SiO4_Tech_F  1
            33.81 5.475 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML1996058461, station 461:

 sample_key depth  value        method qc
             0.50  3.855 NO2NO3_Tech_F  1
             8.03  3.990 NO2NO3_Tech_F  1
            17.45  4.050 NO2NO3_Tech_F  1
            27.67  4.030 NO2NO3_Tech_F  1
            52.65 11.860 NO2NO3_Tech_F  7
            56.12 12.160 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1996058461, station 461:

 sample_key depth value     method qc
             0.50 0.685 PO4_Tech_F  1
             8.03 0.730 PO4_Tech_F  1
            17.45 0.710 PO4_Tech_F  7
            27.67 0.690 PO4_Tech_F  1
            52.65 1.390 PO4_Tech_F  1
            56.12 1.415 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1996058461, station 461:

 sample_key depth  value      method qc
             0.50  4.625 SiO4_Tech_F  1
             8.03  4.715 SiO4_Tech_F  7
            17.45  4.725 SiO4_Tech_F  1
            27.67  4.670 SiO4_Tech_F  1
            52.65 17.635 SiO4_Tech_F  1
            56.12 17.445 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event IML1996058471, station 471:

 sample_key depth O2_CTD_mLL qc
             8.83   326.3306  0
            19.14   323.6064  0
            28.86   322.8025  0
            53.65   278.8570  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1996058471, station 471:

 sample_key depth Chl_a_Holm-Hansen_sF qc
             0.50                 0.36  1
             8.83                 0.40  1
            19.14                 0.36  1
            28.86                 0.29  1
            53.65                 0.08  1
            67.53                 0.07  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1996058471, station 471:

 sample_key depth value     method qc
             0.50 0.565 PO4_Tech_F  1
             8.83 0.590 PO4_Tech_F  7
            19.14 0.550 PO4_Tech_F  1
            28.86 0.615 PO4_Tech_F  1
            53.65 1.110 PO4_Tech_F  1
            67.53 1.145 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1996058471, station 471:

 sample_key depth  value      method qc
             0.50  3.470 SiO4_Tech_F  7
             8.83  3.595 SiO4_Tech_F  1
            19.14  3.365 SiO4_Tech_F  1
            28.86  3.655 SiO4_Tech_F  1
            53.65 13.735 SiO4_Tech_F  1
            67.53 14.340 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1996058481, station 481:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              0.50                 0.34  1
              9.62                 0.37  1
             18.94                 0.32  1
             28.66                 0.38  1
             54.34                 0.11  1
             78.43                 0.05  1
            102.91                 0.05  7
            108.07                 0.04  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1996058481, station 481:

 sample_key  depth value     method qc
              0.50 0.580 PO4_Tech_F  1
              9.62 0.560 PO4_Tech_F  1
             18.94 0.580 PO4_Tech_F  7
             28.66 0.550 PO4_Tech_F  1
             54.34 0.975 PO4_Tech_F  1
             78.43 1.050 PO4_Tech_F  1
            102.91 1.245 PO4_Tech_F  1
            108.07 1.210 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1996058481, station 481:

 sample_key  depth  value      method qc
              0.50  3.785 SiO4_Tech_F  1
              9.62  3.585 SiO4_Tech_F  7
             18.94  3.610 SiO4_Tech_F  1
             28.66  3.510 SiO4_Tech_F  1
             54.34 10.550 SiO4_Tech_F  1
             78.43 10.635 SiO4_Tech_F  1
            102.91 13.915 SiO4_Tech_F  1
            108.07 12.785 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1996058491, station 491:

 sample_key depth Chl_a_Holm-Hansen_sF qc
             0.50                 0.40  1
            15.37                 0.36  7
            25.29                 0.29  1
            34.91                 0.21  1
            60.09                 0.05  1
            76.45                 0.05  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML1996058501, station 501:

 sample_key depth value        method qc
             0.50 2.425 NO2NO3_Tech_F  7
             4.96 2.350 NO2NO3_Tech_F  1
            17.65 2.685 NO2NO3_Tech_F  1
            27.67 2.850 NO2NO3_Tech_F  1
            47.20 8.410 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1996058501, station 501:

 sample_key depth value     method qc
             0.50 0.565 PO4_Tech_F  1
             4.96 0.500 PO4_Tech_F  1
            17.65 0.610 PO4_Tech_F  1
            27.67 0.595 PO4_Tech_F  7
            47.20 0.945 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1996058501, station 501:

 sample_key depth  value      method qc
             0.50  3.575 SiO4_Tech_F  1
             4.96  2.895 SiO4_Tech_F  1
            17.65  3.935 SiO4_Tech_F  7
            27.67  3.795 SiO4_Tech_F  1
            47.20 10.140 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1996058511, station 511:

 sample_key depth Chl_a_Holm-Hansen_sF qc
             0.99                 0.42  7
             6.45                 0.43  1
            16.36                 0.33  1
            24.30                 0.31  1
            36.19                 0.18  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1996058511, station 511:

 sample_key depth value     method qc
             0.99 0.600 PO4_Tech_F  1
             6.45 0.665 PO4_Tech_F  1
            16.36 0.620 PO4_Tech_F  1
            24.30 0.540 PO4_Tech_F  1
            36.19 0.700 PO4_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML1996058511, station 511:

 sample_key depth value      method qc
             0.99 3.440 SiO4_Tech_F  1
             6.45 3.905 SiO4_Tech_F  1
            16.36 3.590 SiO4_Tech_F  7
            24.30 3.110 SiO4_Tech_F  1
            36.19 4.680 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML1996058521, station 521:

 sample_key depth Chl_a_Holm-Hansen_sF qc
             0.50                 0.55  1
             3.97                 0.32  7
            18.84                 0.59  1
            26.48                 0.35  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML1996058531, station 531:

 sample_key depth value        method qc
             0.50  2.12 NO2NO3_Tech_F  1
             6.94  2.14 NO2NO3_Tech_F  7
            16.76  2.16 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML1996058531, station 531:

 sample_key depth value     method qc
             0.50 0.540 PO4_Tech_F  7
             6.94 0.550 PO4_Tech_F  1
            16.76 0.585 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML199605861, station 61:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              0.50                 0.45  1
             14.87                 0.46  1
             24.79                 0.35  7
             53.25                 0.39  1
            102.42                 0.06  1
            152.56                 0.02  1
            202.20                 0.01  7
            251.14                 0.01  1
            302.04                 0.00  1
            352.04                 0.01  1
            401.54                 0.01  1
            431.92                 0.00  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML199605861, station 61:

 sample_key  depth  value        method qc
              8.53  1.805 NO2NO3_Tech_F  1
             14.87  1.200 NO2NO3_Tech_F  1
             24.79  1.475 NO2NO3_Tech_F  1
             53.25  1.140 NO2NO3_Tech_F  7
            102.42  6.135 NO2NO3_Tech_F  1
            152.56 11.605 NO2NO3_Tech_F  1
            202.20 16.630 NO2NO3_Tech_F  1
            251.14 19.465 NO2NO3_Tech_F  1
            302.04 22.640 NO2NO3_Tech_F  1
            352.04 23.680 NO2NO3_Tech_F  1
            401.54 23.615 NO2NO3_Tech_F  1
            431.92 23.730 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML199605861, station 61:

 sample_key  depth value     method qc
              8.53 0.400 PO4_Tech_F  1
             14.87 0.490 PO4_Tech_F  1
             24.79 0.480 PO4_Tech_F  1
             53.25 0.490 PO4_Tech_F  1
            102.42 0.860 PO4_Tech_F  1
            152.56 1.145 PO4_Tech_F  1
            202.20 1.310 PO4_Tech_F  1
            251.14 1.385 PO4_Tech_F  1
            302.04 1.550 PO4_Tech_F  1
            352.04 1.525 PO4_Tech_F  7
            401.54 1.745 PO4_Tech_F  1
            431.92 1.740 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML199605861, station 61:

 sample_key  depth  value      method qc
              8.53  2.140 SiO4_Tech_F  1
             14.87  2.485 SiO4_Tech_F  1
             24.79  2.660 SiO4_Tech_F  1
             53.25  2.415 SiO4_Tech_F  1
            102.42  5.440 SiO4_Tech_F  1
            152.56 12.860 SiO4_Tech_F  1
            202.20 17.885 SiO4_Tech_F  1
            251.14 19.970 SiO4_Tech_F  1
            302.04 23.370 SiO4_Tech_F  7
            352.04 28.035 SiO4_Tech_F  1
            401.54 34.645 SiO4_Tech_F  1
            431.92 34.385 SiO4_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML199605871, station 71:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              0.50                 0.43  1
              4.76                 0.27  1
             14.87                 0.37  1
             24.79                 0.30  1
             49.88                 0.16  7
             99.34                 0.05  1
            149.49                 0.02  1
            199.13                 0.01  1
            247.27                 0.01  1
            298.57                 0.00  1
            347.58                 0.00  1
            396.29                 0.00  7
            463.48                 0.01  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML199605871, station 71:

 sample_key  depth  value        method qc
              4.76  1.235 NO2NO3_Tech_F  1
             14.87  1.150 NO2NO3_Tech_F  1
             24.79  1.230 NO2NO3_Tech_F  7
             49.88  1.385 NO2NO3_Tech_F  1
             99.34  7.580 NO2NO3_Tech_F  1
            149.49 12.000 NO2NO3_Tech_F  1
            199.13 16.620 NO2NO3_Tech_F  1
            247.27 22.475 NO2NO3_Tech_F  7
            298.57 16.290 NO2NO3_Tech_F  1
            347.58 14.355 NO2NO3_Tech_F  1
            396.29 24.020 NO2NO3_Tech_F  1
            463.48 23.430 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML199605871, station 71:

 sample_key  depth value     method qc
              4.76 0.500 PO4_Tech_F  1
             14.87 0.460 PO4_Tech_F  7
             24.79 0.485 PO4_Tech_F  1
             49.88 0.480 PO4_Tech_F  1
             99.34 0.930 PO4_Tech_F  1
            149.49 1.170 PO4_Tech_F  1
            199.13 1.270 PO4_Tech_F  7
            247.27 1.550 PO4_Tech_F  1
            298.57 1.310 PO4_Tech_F  1
            347.58 1.210 PO4_Tech_F  1
            396.29 1.695 PO4_Tech_F  1
            463.48 1.740 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML199605871, station 71:

 sample_key  depth  value      method qc
              4.76  2.380 SiO4_Tech_F  1
             14.87  2.265 SiO4_Tech_F  1
             24.79  2.355 SiO4_Tech_F  1
             49.88  2.155 SiO4_Tech_F  1
             99.34  7.090 SiO4_Tech_F  1
            149.49 13.435 SiO4_Tech_F  7
            199.13 17.325 SiO4_Tech_F  1
            247.27 24.630 SiO4_Tech_F  1
            298.57 20.825 SiO4_Tech_F  1
            347.58 19.340 SiO4_Tech_F  1
            396.29 32.000 SiO4_Tech_F  1
            463.48 35.650 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML199605881, station 81:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              0.50                 0.32  1
              9.02                 0.35  1
             14.87                 0.36  7
             24.79                 0.27  1
             53.25                 0.35  1
            103.31                 0.04  1
            152.76                 0.03  1
            201.51                 0.01  1
            251.93                 0.01  1
            301.54                 0.00  1
            349.16                 0.00  1
            400.44                 0.00  1
            461.20                 0.01  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML199605881, station 81:

 sample_key  depth  value        method qc
              9.02  1.030 NO2NO3_Tech_F  1
             14.87  1.100 NO2NO3_Tech_F  1
             24.79  0.840 NO2NO3_Tech_F  1
             53.25  1.765 NO2NO3_Tech_F  1
            103.31  6.880 NO2NO3_Tech_F  7
            152.76  8.430 NO2NO3_Tech_F  1
            201.51 17.785 NO2NO3_Tech_F  1
            251.93 20.370 NO2NO3_Tech_F  1
            301.54 17.435 NO2NO3_Tech_F  1
            349.16 14.695 NO2NO3_Tech_F  7
            400.44 23.770 NO2NO3_Tech_F  1
            461.20 17.995 NO2NO3_Tech_F  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML199605881, station 81:

 sample_key  depth value     method qc
              9.02 0.450 PO4_Tech_F  1
             14.87 0.490 PO4_Tech_F  1
             24.79 0.400 PO4_Tech_F  1
             53.25 0.495 PO4_Tech_F  7
            103.31 0.775 PO4_Tech_F  1
            152.76 0.905 PO4_Tech_F  2
            201.51 1.335 PO4_Tech_F  1
            251.93 1.450 PO4_Tech_F  1
            301.54 1.235 PO4_Tech_F  7
            349.16 1.040 PO4_Tech_F  1
            400.44 1.720 PO4_Tech_F  7
            461.20 1.395 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML199605881, station 81:

 sample_key  depth  value      method qc
              9.02  1.755 SiO4_Tech_F  7
             14.87  1.900 SiO4_Tech_F  1
             24.79  1.555 SiO4_Tech_F  1
             53.25  2.075 SiO4_Tech_F  1
            103.31  6.600 SiO4_Tech_F  1
            152.76  9.245 SiO4_Tech_F  1
            201.51 17.625 SiO4_Tech_F  1
            251.93 21.140 SiO4_Tech_F  1
            301.54 17.155 SiO4_Tech_F  1
            349.16 16.860 SiO4_Tech_F  1
            400.44 33.715 SiO4_Tech_F  1
            461.20 27.525 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged CHLOROPHYLL, event IML199605891, station 91:

 sample_key  depth Chl_a_Holm-Hansen_sF qc
              0.50                 0.71  7
              8.92                 0.38  1
             14.87                 0.34  1
             24.79                 0.40  1
             52.65                 0.50  1
            101.92                 0.05  1
            152.76                 0.02  1
            196.25                 0.02  1
            247.86                 0.01  1
            300.05                 0.01  1
            349.36                 0.01  1
            399.84                 0.00  7
            435.17                 0.01  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML199605891, station 91:

 sample_key  depth  value        method qc
              0.50  1.345 NO2NO3_Tech_F  1
              8.92  0.750 NO2NO3_Tech_F  1
             14.87  0.825 NO2NO3_Tech_F  1
             24.79  1.175 NO2NO3_Tech_F  1
             52.65  1.070 NO2NO3_Tech_F  7
            101.92  7.975 NO2NO3_Tech_F  1
            152.76  9.960 NO2NO3_Tech_F  1
            196.25 11.420 NO2NO3_Tech_F  1
            247.86 18.680 NO2NO3_Tech_F  1
            300.05 23.475 NO2NO3_Tech_F  7
            349.36 19.355 NO2NO3_Tech_F  1
            399.84 19.865 NO2NO3_Tech_F  1
            435.17 21.885 NO2NO3_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event IML199605891, station 91:

 sample_key  depth value     method qc
              0.50 0.520 PO4_Tech_F  1
              8.92 0.430 PO4_Tech_F  7
             14.87 0.425 PO4_Tech_F  1
             24.79 0.465 PO4_Tech_F  1
             52.65 0.390 PO4_Tech_F  1
            101.92 0.965 PO4_Tech_F  1
            152.76 1.010 PO4_Tech_F  1
            196.25 0.965 PO4_Tech_F  1
            247.86 1.290 PO4_Tech_F  7
            300.05 1.585 PO4_Tech_F  1
            349.36 1.320 PO4_Tech_F  1
            399.84 1.490 PO4_Tech_F  1
            435.17 1.590 PO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event IML199605891, station 91:

 sample_key  depth  value      method qc
              0.50  1.605 SiO4_Tech_F  1
              8.92  1.460 SiO4_Tech_F  1
             14.87  1.545 SiO4_Tech_F  1
             24.79  1.535 SiO4_Tech_F  7
             52.65  1.515 SiO4_Tech_F  1
            101.92  7.265 SiO4_Tech_F  1
            152.76 10.640 SiO4_Tech_F  1
            196.25 11.000 SiO4_Tech_F  7
            247.86 16.905 SiO4_Tech_F  1
            300.05 23.805 SiO4_Tech_F  1
            349.36 19.425 SiO4_Tech_F  1
            399.84 28.495 SiO4_Tech_F  1
            435.17 31.895 SiO4_Tech_F  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL00002"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL00002 FLAG Report:,  2019-03-15 12:26:49
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged PHOSPHATE, event 1, station STN27:

           sample_key depth value method qc
 18TL00002_002_197910     7  0.79  PO4_0  1
 18TL00002_002_197909    11  0.86  PO4_0  1
 18TL00002_002_197908    20  0.84  PO4_0  1
 18TL00002_002_197907    31  0.87  PO4_0  3
 18TL00002_002_197906    41  0.87  PO4_0  1
 18TL00002_002_197905    52  1.63  PO4_0  1
 18TL00002_002_197904    76  1.74  PO4_0  1
 18TL00002_002_197903   100  1.78  PO4_0  1
 18TL00002_002_197902   150  2.04  PO4_0  1
 18TL00002_002_197901   167  1.98  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 1, station STN27:

           sample_key depth value method qc
 18TL00002_002_197910     7  0.31 SiO4_0  1
 18TL00002_002_197909    11  0.43 SiO4_0  1
 18TL00002_002_197908    20  0.31 SiO4_0  3
 18TL00002_002_197907    31  0.35 SiO4_0  1
 18TL00002_002_197906    41  0.40 SiO4_0  1
 18TL00002_002_197905    52  2.93 SiO4_0  7
 18TL00002_002_197904    76  5.15 SiO4_0  1
 18TL00002_002_197903   100  6.39 SiO4_0  1
 18TL00002_002_197902   150  9.05 SiO4_0  1
 18TL00002_002_197901   167  9.55 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 104, station FC-12:

           sample_key depth value method qc
 18TL00002_008_221206     6  0.75  PO4_0  3
 18TL00002_008_221205    10  0.68  PO4_0  1
 18TL00002_008_221204    20  0.77  PO4_0  1
 18TL00002_008_221203    30  0.80  PO4_0  1
 18TL00002_008_221202    40  0.98  PO4_0  1
 18TL00002_008_221201    50  1.56  PO4_0  1
 18TL00002_008_221200    76  1.95  PO4_0  1
 18TL00002_008_221199   101  1.97  PO4_0  1
 18TL00002_008_221198   130  2.13  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 104, station FC-12:

           sample_key depth value method qc
 18TL00002_008_221206     6  0.26 SiO4_0  1
 18TL00002_008_221205    10  0.13 SiO4_0  1
 18TL00002_008_221204    20  0.31 SiO4_0  7
 18TL00002_008_221203    30  0.23 SiO4_0  1
 18TL00002_008_221202    40  0.36 SiO4_0  1
 18TL00002_008_221201    50  0.57 SiO4_0  1
 18TL00002_008_221200    76  5.29 SiO4_0  1
 18TL00002_008_221199   101  7.80 SiO4_0  1
 18TL00002_008_221198   130 10.24 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 11, station SEGB-05:

           sample_key depth value   method qc
 18TL00002_014_197932     5  1.00 NO2NO3_0  1
 18TL00002_014_197931    10  0.93 NO2NO3_0  2
 18TL00002_014_197930    20  0.77 NO2NO3_0  1
 18TL00002_014_197929    30  0.40 NO2NO3_0  1
 18TL00002_014_197928    39  0.62 NO2NO3_0  1
 18TL00002_014_197927    50  0.58 NO2NO3_0  7
 18TL00002_014_197926    83 10.03 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 11, station SEGB-05:

           sample_key depth value method qc
 18TL00002_014_197932     5  0.66  PO4_0  1
 18TL00002_014_197931    10  0.75  PO4_0  1
 18TL00002_014_197930    20  0.79  PO4_0  1
 18TL00002_014_197929    30  0.76  PO4_0  1
 18TL00002_014_197928    39  0.66  PO4_0  1
 18TL00002_014_197927    50  0.68  PO4_0  7
 18TL00002_014_197926    83  2.09  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 11, station SEGB-05:

           sample_key depth value method qc
 18TL00002_014_197932     5  0.02 SiO4_0  1
 18TL00002_014_197931    10  0.08 SiO4_0  2
 18TL00002_014_197930    20  0.11 SiO4_0  1
 18TL00002_014_197929    30  0.17 SiO4_0  1
 18TL00002_014_197928    39  0.08 SiO4_0  1
 18TL00002_014_197927    50  0.04 SiO4_0  1
 18TL00002_014_197926    83 12.44 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 12, station SEGB-06:

           sample_key depth value   method qc
 18TL00002_025_197939     5  1.90 NO2NO3_0  1
 18TL00002_025_197938     9  1.91 NO2NO3_0  1
 18TL00002_025_197937    19  1.81 NO2NO3_0  1
 18TL00002_025_197936    29  1.79 NO2NO3_0  1
 18TL00002_025_197935    39  1.61 NO2NO3_0  1
 18TL00002_025_197934    49  1.68 NO2NO3_0  1
 18TL00002_025_197933    76  8.41 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 12, station SEGB-06:

           sample_key depth value method qc
 18TL00002_025_197939     5  0.85  PO4_0  1
 18TL00002_025_197938     9  0.86  PO4_0  1
 18TL00002_025_197937    19  0.85  PO4_0  1
 18TL00002_025_197936    29  0.84  PO4_0  1
 18TL00002_025_197935    39  0.71  PO4_0  1
 18TL00002_025_197934    49  0.80  PO4_0  7
 18TL00002_025_197933    76  1.48  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 12, station SEGB-06:

           sample_key depth value method qc
 18TL00002_025_197939     5  0.05 SiO4_0  1
 18TL00002_025_197938     9  0.06 SiO4_0  1
 18TL00002_025_197937    19  0.06 SiO4_0  1
 18TL00002_025_197936    29  0.02 SiO4_0  1
 18TL00002_025_197935    39  0.03 SiO4_0  1
 18TL00002_025_197934    49  0.14 SiO4_0  7
 18TL00002_025_197933    76  9.51 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 13, station SEGB-07:

           sample_key depth value   method qc
 18TL00002_036_197946     7  2.27 NO2NO3_0  1
 18TL00002_036_197945    11  2.14 NO2NO3_0  1
 18TL00002_036_197944    20  2.12 NO2NO3_0  1
 18TL00002_036_197943    30  2.14 NO2NO3_0  1
 18TL00002_036_197942    40  2.17 NO2NO3_0  1
 18TL00002_036_197941    50  2.08 NO2NO3_0  1
 18TL00002_036_197940    77  7.40 NO2NO3_0  2


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 15, station SEGB-09:

           sample_key depth value   method qc
 18TL00002_058_197960     5  0.00 NO2NO3_0  1
 18TL00002_058_197959    12  0.62 NO2NO3_0  1
 18TL00002_058_197958    21  0.70 NO2NO3_0  1
 18TL00002_058_197957    32  0.68 NO2NO3_0  1
 18TL00002_058_197956    40  0.68 NO2NO3_0  7
 18TL00002_058_197955    51  0.61 NO2NO3_0  1
 18TL00002_058_197954    67  1.56 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 153, station S27-06:

           sample_key depth value   method qc
 18TL00002_062_221441     5  0.00 NO2NO3_0  1
 18TL00002_062_221440    11  0.00 NO2NO3_0  1
 18TL00002_062_221439    19  0.00 NO2NO3_0  1
 18TL00002_062_221438    31  0.00 NO2NO3_0  7
 18TL00002_062_221437    39  0.00 NO2NO3_0  1
 18TL00002_062_221436    48  1.37 NO2NO3_0  1
 18TL00002_062_221435    74  7.12 NO2NO3_0  1
 18TL00002_062_221434    99  7.48 NO2NO3_0  1
 18TL00002_062_221433   138  9.32 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 153, station S27-06:

           sample_key depth value method qc
 18TL00002_062_221441     5  0.87  PO4_0  1
 18TL00002_062_221440    11  0.64  PO4_0  1
 18TL00002_062_221439    19  0.79  PO4_0  1
 18TL00002_062_221438    31  0.83  PO4_0  7
 18TL00002_062_221437    39  1.02  PO4_0  1
 18TL00002_062_221436    48  1.15  PO4_0  1
 18TL00002_062_221435    74  1.77  PO4_0  1
 18TL00002_062_221434    99  1.89  PO4_0  1
 18TL00002_062_221433   138  2.17  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 153, station S27-06:

           sample_key depth value method qc
 18TL00002_062_221441     5  0.17 SiO4_0  1
 18TL00002_062_221440    11  0.19 SiO4_0  1
 18TL00002_062_221439    19  0.09 SiO4_0  1
 18TL00002_062_221438    31  0.20 SiO4_0  1
 18TL00002_062_221437    39  0.20 SiO4_0  1
 18TL00002_062_221436    48  0.81 SiO4_0  1
 18TL00002_062_221435    74  5.97 SiO4_0  1
 18TL00002_062_221434    99  6.78 SiO4_0  1
 18TL00002_062_221433   138 11.21 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 155, station S27-04:

           sample_key depth value   method qc
 18TL00002_064_221451     6  0.00 NO2NO3_0  1
 18TL00002_064_221450    11  0.00 NO2NO3_0  1
 18TL00002_064_221449    20  0.00 NO2NO3_0  1
 18TL00002_064_221448    32  0.00 NO2NO3_0  1
 18TL00002_064_221447    40  0.00 NO2NO3_0  1
 18TL00002_064_221446    51  1.49 NO2NO3_0  1
 18TL00002_064_221445    75  6.41 NO2NO3_0  3
 18TL00002_064_221444    98  7.50 NO2NO3_0  1
 18TL00002_064_221443   151  8.89 NO2NO3_0  1
 18TL00002_064_221442   180  9.91 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 155, station S27-04:

           sample_key depth value method qc
 18TL00002_064_221451     6  0.45  PO4_0  1
 18TL00002_064_221450    11  0.37  PO4_0  1
 18TL00002_064_221449    20  0.40  PO4_0  1
 18TL00002_064_221448    32  0.39  PO4_0  1
 18TL00002_064_221447    40  1.16  PO4_0  1
 18TL00002_064_221446    51  1.28  PO4_0  1
 18TL00002_064_221445    75  1.78  PO4_0  1
 18TL00002_064_221444    98  1.99  PO4_0  1
 18TL00002_064_221443   151  1.92  PO4_0  7
 18TL00002_064_221442   180  2.28  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 155, station S27-04:

           sample_key depth value method qc
 18TL00002_064_221451     6  0.18 SiO4_0  1
 18TL00002_064_221450    11  0.00 SiO4_0  1
 18TL00002_064_221449    20  0.00 SiO4_0  1
 18TL00002_064_221448    32  0.00 SiO4_0  1
 18TL00002_064_221447    40  0.28 SiO4_0  1
 18TL00002_064_221446    51  0.50 SiO4_0  1
 18TL00002_064_221445    75  4.73 SiO4_0  1
 18TL00002_064_221444    98  6.72 SiO4_0  1
 18TL00002_064_221443   151 10.62 SiO4_0  7
 18TL00002_064_221442   180 13.44 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 157, station S27-02:

           sample_key depth value   method qc
 18TL00002_066_221461     5  0.00 NO2NO3_0  1
 18TL00002_066_221460    11  0.00 NO2NO3_0  1
 18TL00002_066_221459    20  0.00 NO2NO3_0  1
 18TL00002_066_221458    30  0.00 NO2NO3_0  1
 18TL00002_066_221457    40  0.00 NO2NO3_0  1
 18TL00002_066_221456    52  0.00 NO2NO3_0  1
 18TL00002_066_221455    77  7.11 NO2NO3_0  3
 18TL00002_066_221454    99  7.32 NO2NO3_0  1
 18TL00002_066_221453   149  8.98 NO2NO3_0  1
 18TL00002_066_221452   159  9.47 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 157, station S27-02:

           sample_key depth value method qc
 18TL00002_066_221461     5  0.39  PO4_0  1
 18TL00002_066_221460    11  0.42  PO4_0  1
 18TL00002_066_221459    20  0.39  PO4_0  1
 18TL00002_066_221458    30  0.42  PO4_0  1
 18TL00002_066_221457    40  0.41  PO4_0  1
 18TL00002_066_221456    52  0.61  PO4_0  3
 18TL00002_066_221455    77  0.93  PO4_0  1
 18TL00002_066_221454    99  0.94  PO4_0  1
 18TL00002_066_221453   149  1.04  PO4_0  7
 18TL00002_066_221452   159  1.12  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 157, station S27-02:

           sample_key depth value method qc
 18TL00002_066_221461     5  0.00 SiO4_0  1
 18TL00002_066_221460    11  0.00 SiO4_0  1
 18TL00002_066_221459    20  0.17 SiO4_0  1
 18TL00002_066_221458    30  0.00 SiO4_0  1
 18TL00002_066_221457    40  0.00 SiO4_0  1
 18TL00002_066_221456    52  0.00 SiO4_0  1
 18TL00002_066_221455    77  5.84 SiO4_0  1
 18TL00002_066_221454    99  6.10 SiO4_0  7
 18TL00002_066_221453   149  9.72 SiO4_0  7
 18TL00002_066_221452   159 12.37 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 158, station STN27:

           sample_key depth value   method qc
 18TL00002_067_221471     5  0.00 NO2NO3_0  1
 18TL00002_067_221470    10  0.00 NO2NO3_0  1
 18TL00002_067_221469    20  0.00 NO2NO3_0  1
 18TL00002_067_221468    30  0.00 NO2NO3_0  1
 18TL00002_067_221467    40  0.00 NO2NO3_0  3
 18TL00002_067_221466    50  1.00 NO2NO3_0  1
 18TL00002_067_221465    74  5.06 NO2NO3_0  1
 18TL00002_067_221464   100  5.14 NO2NO3_0  1
 18TL00002_067_221463   150  8.77 NO2NO3_0  1
 18TL00002_067_221462   165  9.10 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 158, station STN27:

           sample_key depth value method qc
 18TL00002_067_221471     5  0.46  PO4_0  1
 18TL00002_067_221470    10  0.45  PO4_0  1
 18TL00002_067_221469    20  0.42  PO4_0  1
 18TL00002_067_221468    30  0.44  PO4_0  1
 18TL00002_067_221467    40  0.39  PO4_0  1
 18TL00002_067_221466    50  0.55  PO4_0  1
 18TL00002_067_221465    74  0.89  PO4_0  7
 18TL00002_067_221464   100  0.83  PO4_0  1
 18TL00002_067_221463   150  1.06  PO4_0  1
 18TL00002_067_221462   165  1.10  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 158, station STN27:

           sample_key depth value method qc
 18TL00002_067_221471     5  0.00 SiO4_0  1
 18TL00002_067_221470    10  0.00 SiO4_0  1
 18TL00002_067_221469    20  0.00 SiO4_0  1
 18TL00002_067_221468    30  0.00 SiO4_0  1
 18TL00002_067_221467    40  0.15 SiO4_0  1
 18TL00002_067_221466    50  0.52 SiO4_0  1
 18TL00002_067_221465    74  2.39 SiO4_0  7
 18TL00002_067_221464   100  3.64 SiO4_0  1
 18TL00002_067_221463   150  9.84 SiO4_0  1
 18TL00002_067_221462   165 11.76 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 16, station SEGB-10:

           sample_key depth value method qc
 18TL00002_069_197967     6  0.22 SiO4_0  1
 18TL00002_069_197966    11  0.29 SiO4_0  1
 18TL00002_069_197965    19  0.15 SiO4_0  7
 18TL00002_069_197964    28  0.29 SiO4_0  1
 18TL00002_069_197963    39  0.18 SiO4_0  1
 18TL00002_069_197962    50  0.50 SiO4_0  1
 18TL00002_069_197961    65  1.44 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 25, station SEGB-19:

           sample_key depth value   method qc
 18TL00002_171_221018     6  4.08 NO2NO3_0  1
 18TL00002_171_221017    10  4.06 NO2NO3_0  1
 18TL00002_171_221016    20  4.13 NO2NO3_0  7
 18TL00002_171_221015    29  4.04 NO2NO3_0  7
 18TL00002_171_221014    40  4.37 NO2NO3_0  1
 18TL00002_171_221013    49  4.63 NO2NO3_0  1
 18TL00002_171_221012    74  5.67 NO2NO3_0  1
 18TL00002_171_221011    99  5.15 NO2NO3_0  1
 18TL00002_171_221010   150  7.40 NO2NO3_0  1
 18TL00002_171_221009  1500 18.07 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 25, station SEGB-19:

           sample_key depth value method qc
 18TL00002_171_221018     6  0.32  PO4_0  1
 18TL00002_171_221017    10  0.29  PO4_0  7
 18TL00002_171_221016    20  0.27  PO4_0  7
 18TL00002_171_221015    29  0.30  PO4_0  1
 18TL00002_171_221014    40  0.28  PO4_0  1
 18TL00002_171_221013    49  0.30  PO4_0  1
 18TL00002_171_221012    74  0.39  PO4_0  1
 18TL00002_171_221011    99  0.33  PO4_0  1
 18TL00002_171_221010   150  0.47  PO4_0  1
 18TL00002_171_221009  1500  1.22  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 25, station SEGB-19:

           sample_key depth value method qc
 18TL00002_171_221018     6  1.51 SiO4_0  7
 18TL00002_171_221017    10  1.78 SiO4_0  7
 18TL00002_171_221016    20  1.36 SiO4_0  1
 18TL00002_171_221015    29  1.82 SiO4_0  1
 18TL00002_171_221014    40  1.21 SiO4_0  1
 18TL00002_171_221013    49  1.33 SiO4_0  1
 18TL00002_171_221012    74  2.46 SiO4_0  7
 18TL00002_171_221011    99  1.48 SiO4_0  1
 18TL00002_171_221010   150  2.66 SiO4_0  1
 18TL00002_171_221009  1500 11.12 SiO4_0  1


-> QC repot:
      Filename Pressure Uniqueno Variable  Values
 18TL00002_025    76.84   197933     slca  9.51  
                                                         Test.failed
  Out of Nutrient Climatology in box(es) 9 (Min=0.00 Max=8.82 n=244)



-> Flagged PHOSPHATE, event 83, station STN27:

           sample_key depth value method qc
 18TL00002_330_221107     4  0.66  PO4_0  1
 18TL00002_330_221106     9  0.73  PO4_0  1
 18TL00002_330_221105    19  0.72  PO4_0  1
 18TL00002_330_221104    29  0.72  PO4_0  1
 18TL00002_330_221103    40  0.97  PO4_0  1
 18TL00002_330_221102    49  1.03  PO4_0  7
 18TL00002_330_221101    74  1.28  PO4_0  1
 18TL00002_330_221100    99  1.56  PO4_0  1
 18TL00002_330_221099   149  1.59  PO4_0  1
 18TL00002_330_221098   169  1.72  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 83, station STN27:

           sample_key depth value method qc
 18TL00002_330_221107     4  0.18 SiO4_0  1
 18TL00002_330_221106     9  0.17 SiO4_0  1
 18TL00002_330_221105    19  0.00 SiO4_0  1
 18TL00002_330_221104    29  0.00 SiO4_0  1
 18TL00002_330_221103    40  0.18 SiO4_0  7
 18TL00002_330_221102    49  1.36 SiO4_0  7
 18TL00002_330_221101    74  3.64 SiO4_0  1
 18TL00002_330_221100    99  5.88 SiO4_0  1
 18TL00002_330_221099   149  8.54 SiO4_0  1
 18TL00002_330_221098   169  9.73 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 85, station FC-01:

           sample_key depth value method qc
 18TL00002_334_221115     4  0.79  PO4_0  1
 18TL00002_334_221114     9  0.79  PO4_0  1
 18TL00002_334_221113    19  0.80  PO4_0  1
 18TL00002_334_221112    30  0.96  PO4_0  7
 18TL00002_334_221111    39  1.34  PO4_0  1
 18TL00002_334_221110    50  1.40  PO4_0  1
 18TL00002_334_221109    75  1.48  PO4_0  1
 18TL00002_334_221108    98  1.62  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 85, station FC-01:

           sample_key depth value method qc
 18TL00002_334_221115     4  0.30 SiO4_0  1
 18TL00002_334_221114     9  0.00 SiO4_0  1
 18TL00002_334_221113    19  0.01 SiO4_0  7
 18TL00002_334_221112    30  0.07 SiO4_0  7
 18TL00002_334_221111    39  2.34 SiO4_0  1
 18TL00002_334_221110    50  4.06 SiO4_0  1
 18TL00002_334_221109    75  5.25 SiO4_0  1
 18TL00002_334_221108    98  6.70 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 86, station FC-02:

           sample_key depth value method qc
 18TL00002_335_221125     5  0.71  PO4_0  1
 18TL00002_335_221124    10  0.69  PO4_0  1
 18TL00002_335_221123    20  0.73  PO4_0  1
 18TL00002_335_221122    30  0.81  PO4_0  1
 18TL00002_335_221121    40  0.79  PO4_0  1
 18TL00002_335_221120    49  1.11  PO4_0  1
 18TL00002_335_221119    75  1.33  PO4_0  1
 18TL00002_335_221118   100  1.43  PO4_0  1
 18TL00002_335_221117   148  1.56  PO4_0  1
 18TL00002_335_221116   178  1.86  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 86, station FC-02:

           sample_key depth value method qc
 18TL00002_335_221125     5  0.41 SiO4_0  1
 18TL00002_335_221124    10  0.29 SiO4_0  1
 18TL00002_335_221123    20  0.00 SiO4_0  1
 18TL00002_335_221122    30  0.05 SiO4_0  1
 18TL00002_335_221121    40  0.00 SiO4_0  1
 18TL00002_335_221120    49  0.59 SiO4_0  1
 18TL00002_335_221119    75  3.91 SiO4_0  1
 18TL00002_335_221118   100  5.87 SiO4_0  1
 18TL00002_335_221117   148  8.58 SiO4_0  1
 18TL00002_335_221116   178 13.35 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 87, station FC-03:

           sample_key depth value   method qc
 18TL00002_336_221134     5  0.07 NO2NO3_0  1
 18TL00002_336_221133    10  0.05 NO2NO3_0  1
 18TL00002_336_221132    20  0.07 NO2NO3_0  7
 18TL00002_336_221131    31  0.01 NO2NO3_0  1
 18TL00002_336_221130    40  0.01 NO2NO3_0  1
 18TL00002_336_221129    50  5.47 NO2NO3_0  1
 18TL00002_336_221128    74  6.39 NO2NO3_0  1
 18TL00002_336_221127   100  6.50 NO2NO3_0  1
 18TL00002_336_221126   152 10.15 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 87, station FC-03:

           sample_key depth value method qc
 18TL00002_336_221134     5  0.75  PO4_0  7
 18TL00002_336_221133    10  0.69  PO4_0  1
 18TL00002_336_221132    20  0.67  PO4_0  1
 18TL00002_336_221131    31  0.68  PO4_0  1
 18TL00002_336_221130    40  0.94  PO4_0  1
 18TL00002_336_221129    50  1.74  PO4_0  1
 18TL00002_336_221128    74  1.80  PO4_0  1
 18TL00002_336_221127   100  1.45  PO4_0  1
 18TL00002_336_221126   152  1.88  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 87, station FC-03:

           sample_key depth value method qc
 18TL00002_336_221134     5  0.13 SiO4_0  7
 18TL00002_336_221133    10  0.20 SiO4_0  1
 18TL00002_336_221132    20  0.11 SiO4_0  1
 18TL00002_336_221131    31  0.12 SiO4_0  1
 18TL00002_336_221130    40  0.26 SiO4_0  1
 18TL00002_336_221129    50  1.45 SiO4_0  7
 18TL00002_336_221128    74  5.36 SiO4_0  1
 18TL00002_336_221127   100  6.81 SiO4_0  1
 18TL00002_336_221126   152 14.81 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 88, station FC-04:

           sample_key depth value method qc
 18TL00002_337_221142     5  0.81  PO4_0  3
 18TL00002_337_221141    10  0.89  PO4_0  1
 18TL00002_337_221140    20  1.00  PO4_0  1
 18TL00002_337_221139    30  0.83  PO4_0  1
 18TL00002_337_221138    40  1.51  PO4_0  1
 18TL00002_337_221136    76  1.91  PO4_0  1
 18TL00002_337_221135   118  2.13  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 88, station FC-04:

           sample_key depth value method qc
 18TL00002_337_221142     5  0.09 SiO4_0  1
 18TL00002_337_221141    10  0.28 SiO4_0  1
 18TL00002_337_221140    20  1.16 SiO4_0  7
 18TL00002_337_221139    30  0.23 SiO4_0  1
 18TL00002_337_221138    40  1.40 SiO4_0  1
 18TL00002_337_221136    76  6.06 SiO4_0  1
 18TL00002_337_221135   118 15.58 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 90, station FC-06:

           sample_key depth value method qc
 18TL00002_340_221159     6  0.84  PO4_0  1
 18TL00002_340_221158    11  0.85  PO4_0  1
 18TL00002_340_221157    20  0.89  PO4_0  1
 18TL00002_340_221156    29  0.91  PO4_0  3
 18TL00002_340_221155    40  0.92  PO4_0  1
 18TL00002_340_221154    50  1.27  PO4_0  1
 18TL00002_340_221153    74  1.64  PO4_0  1
 18TL00002_340_221152    95  2.19  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 90, station FC-06:

           sample_key depth value method qc
 18TL00002_340_221159     6  0.00 SiO4_0  1
 18TL00002_340_221158    11  0.00 SiO4_0  1
 18TL00002_340_221157    20  0.00 SiO4_0  3
 18TL00002_340_221156    29  0.00 SiO4_0  1
 18TL00002_340_221155    40  0.00 SiO4_0  1
 18TL00002_340_221154    50  0.89 SiO4_0  7
 18TL00002_340_221153    74  4.46 SiO4_0  1
 18TL00002_340_221152    95 12.47 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 91, station FC-07:

           sample_key depth value   method qc
 18TL00002_353_221167     5  0.00 NO2NO3_0  1
 18TL00002_353_221166    10  0.00 NO2NO3_0  1
 18TL00002_353_221165    20  0.00 NO2NO3_0  7
 18TL00002_353_221164    29  0.00 NO2NO3_0  1
 18TL00002_353_221163    41  0.00 NO2NO3_0  1
 18TL00002_353_221162    50  0.37 NO2NO3_0  1
 18TL00002_353_221161    74  7.21 NO2NO3_0  1
 18TL00002_353_221160    99  9.76 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL00007"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL00007 FLAG Report:,  2019-03-15 12:30:40
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 18, station FC-12:

           sample_key depth value   method qc
 18TL00007_091_221651     6  0.00 NO2NO3_0  1
 18TL00007_091_221650    11  0.00 NO2NO3_0  1
 18TL00007_091_221649    20  0.00 NO2NO3_0  1
 18TL00007_091_221648    31  0.00 NO2NO3_0  1
 18TL00007_091_221647    41  0.00 NO2NO3_0  1
 18TL00007_091_221646    51  2.83 NO2NO3_0  1
 18TL00007_091_221644    75  6.93 NO2NO3_0  1
 18TL00007_091_221645   102  8.23 NO2NO3_0  1
 18TL00007_091_221643   128  9.34 NO2NO3_0  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 18, station FC-12:

           sample_key depth value method qc
 18TL00007_091_221651     6  0.97  PO4_0  1
 18TL00007_091_221650    11  0.94  PO4_0  1
 18TL00007_091_221649    20  1.07  PO4_0  1
 18TL00007_091_221648    31  0.98  PO4_0  1
 18TL00007_091_221647    41  0.99  PO4_0  1
 18TL00007_091_221646    51  1.73  PO4_0  1
 18TL00007_091_221644    75  1.83  PO4_0  3
 18TL00007_091_221645   102  1.82  PO4_0  1
 18TL00007_091_221643   128  2.14  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 4, station FC-01:

           sample_key depth value   method qc
 18TL00007_264_221489     6  0.00 NO2NO3_0  1
 18TL00007_264_221488    10  0.05 NO2NO3_0  1
 18TL00007_264_221487    20  0.05 NO2NO3_0  7
 18TL00007_264_221486    31  1.54 NO2NO3_0  1
 18TL00007_264_221485    40  2.45 NO2NO3_0  1
 18TL00007_264_221484    51  2.84 NO2NO3_0  1
 18TL00007_264_221483    75  4.25 NO2NO3_0  1
 18TL00007_264_221482    91  4.83 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 6, station FC-03:

           sample_key depth value   method qc
 18TL00007_304_221499     5  0.00 NO2NO3_0  1
 18TL00007_304_221498    10  0.00 NO2NO3_0  1
 18TL00007_304_221497    20  0.00 NO2NO3_0  1
 18TL00007_304_221496    30  0.01 NO2NO3_0  1
 18TL00007_304_221495    40  0.00 NO2NO3_0  1
 18TL00007_304_221494    50  2.03 NO2NO3_0  1
 18TL00007_304_221492   100  9.77 NO2NO3_0  7
 18TL00007_304_221491   148 10.51 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL01003"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL01003 FLAG Report:,  2019-03-15 12:31:06
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 11, station SEGB-05:

           sample_key depth value   method qc
 18TL01003_014_222187     5  1.64 NO2NO3_0  7
 18TL01003_014_222186    10  1.69 NO2NO3_0  7
 18TL01003_014_222185    20  1.52 NO2NO3_0  1
 18TL01003_014_222184    30  1.39 NO2NO3_0  3
 18TL01003_014_222183    41  1.62 NO2NO3_0  1
 18TL01003_014_222182    51  2.06 NO2NO3_0  1
 18TL01003_014_222181    74  4.08 NO2NO3_0  1
 18TL01003_014_222180    83  5.87 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 11, station SEGB-05:

           sample_key depth value method qc
 18TL01003_014_222187     5  0.39  PO4_0  7
 18TL01003_014_222186    10  0.49  PO4_0  1
 18TL01003_014_222185    20  0.65  PO4_0  3
 18TL01003_014_222184    30  0.47  PO4_0  1
 18TL01003_014_222183    41  0.51  PO4_0  1
 18TL01003_014_222182    51  0.59  PO4_0  1
 18TL01003_014_222181    74  0.98  PO4_0  1
 18TL01003_014_222180    83  1.73  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 11, station SEGB-05:

           sample_key depth value method qc
 18TL01003_014_222187     5  0.88 SiO4_0  1
 18TL01003_014_222186    10  0.95 SiO4_0  1
 18TL01003_014_222185    20  1.09 SiO4_0  1
 18TL01003_014_222184    30  0.87 SiO4_0  1
 18TL01003_014_222183    41  0.88 SiO4_0  1
 18TL01003_014_222182    51  0.92 SiO4_0  7
 18TL01003_014_222181    74  2.62 SiO4_0  1
 18TL01003_014_222180    83  6.16 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 12, station SEGB-06:

           sample_key depth value   method qc
 18TL01003_025_222194     5  0.46 NO2NO3_0  7
 18TL01003_025_222193    10  0.57 NO2NO3_0  1
 18TL01003_025_222192    20  0.53 NO2NO3_0  1
 18TL01003_025_222191    30  0.76 NO2NO3_0  1
 18TL01003_025_222190    40  1.00 NO2NO3_0  1
 18TL01003_025_222189    50  0.24 NO2NO3_0  1
 18TL01003_025_222188    75  2.67 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 12, station SEGB-06:

           sample_key depth value method qc
 18TL01003_025_222194     5  0.32  PO4_0  1
 18TL01003_025_222193    10  0.40  PO4_0  3
 18TL01003_025_222192    20  0.32  PO4_0  1
 18TL01003_025_222191    30  0.31  PO4_0  1
 18TL01003_025_222190    40  0.43  PO4_0  1
 18TL01003_025_222189    50  0.36  PO4_0  1
 18TL01003_025_222188    75  0.77  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 12, station SEGB-06:

           sample_key depth value method qc
 18TL01003_025_222194     5  0.21 SiO4_0  1
 18TL01003_025_222193    10  0.20 SiO4_0  1
 18TL01003_025_222192    20  0.17 SiO4_0  1
 18TL01003_025_222191    30  0.18 SiO4_0  1
 18TL01003_025_222190    40  0.22 SiO4_0  1
 18TL01003_025_222189    50  1.23 SiO4_0  7
 18TL01003_025_222188    75  0.51 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 121, station STN27:

           sample_key depth value   method qc
 18TL01003_027_223197     5  3.01 NO2NO3_0  1
 18TL01003_027_223196    10  2.38 NO2NO3_0  1
 18TL01003_027_223195    20  3.09 NO2NO3_0  1
 18TL01003_027_223194    30  3.24 NO2NO3_0  1
 18TL01003_027_223193    40  3.32 NO2NO3_0  1
 18TL01003_027_223192    50  3.54 NO2NO3_0  1
 18TL01003_027_223191    75  8.34 NO2NO3_0  7
 18TL01003_027_223190    99  5.06 NO2NO3_0  1
 18TL01003_027_223189   149  6.06 NO2NO3_0  1
 18TL01003_027_223188   167  7.18 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 121, station STN27:

           sample_key depth value method qc
 18TL01003_027_223197     5  2.67 SiO4_0  1
 18TL01003_027_223196    10  2.96 SiO4_0  3
 18TL01003_027_223195    20  3.26 SiO4_0  1
 18TL01003_027_223194    30  2.44 SiO4_0  1
 18TL01003_027_223193    40  1.66 SiO4_0  1
 18TL01003_027_223192    50  2.84 SiO4_0  1
 18TL01003_027_223191    75  3.00 SiO4_0  1
 18TL01003_027_223190    99  2.35 SiO4_0  1
 18TL01003_027_223189   149  5.36 SiO4_0  1
 18TL01003_027_223188   167 11.16 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 13, station SEGB-07:

           sample_key depth value   method qc
 18TL01003_036_222683     5  0.22 NO2NO3_0  7
 18TL01003_036_222200     9  0.26 NO2NO3_0  7
 18TL01003_036_222199    20  0.70 NO2NO3_0  1
 18TL01003_036_222198    30  0.13 NO2NO3_0  1
 18TL01003_036_222197    39  0.13 NO2NO3_0  1
 18TL01003_036_222196    49  0.38 NO2NO3_0  1
 18TL01003_036_222195    74  3.17 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 13, station SEGB-07:

           sample_key depth value method qc
 18TL01003_036_222683     5  0.29  PO4_0  7
 18TL01003_036_222200     9  0.33  PO4_0  1
 18TL01003_036_222199    20  0.25  PO4_0  1
 18TL01003_036_222198    30  0.34  PO4_0  1
 18TL01003_036_222197    39  0.32  PO4_0  1
 18TL01003_036_222196    49  0.30  PO4_0  1
 18TL01003_036_222195    74  0.91  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 14, station SEGB-08:

           sample_key depth value   method qc
 18TL01003_047_222690     5  0.38 NO2NO3_0  7
 18TL01003_047_222689    10  0.57 NO2NO3_0  1
 18TL01003_047_222688    20  0.53 NO2NO3_0  1
 18TL01003_047_222687    29  0.76 NO2NO3_0  1
 18TL01003_047_222686    39  0.99 NO2NO3_0  1
 18TL01003_047_222685    50  2.22 NO2NO3_0  1
 18TL01003_047_222684    68  3.66 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 14, station SEGB-08:

           sample_key depth value method qc
 18TL01003_047_222690     5  0.30  PO4_0  1
 18TL01003_047_222689    10  0.40  PO4_0  1
 18TL01003_047_222688    20  0.32  PO4_0  1
 18TL01003_047_222687    29  0.31  PO4_0  1
 18TL01003_047_222686    39  0.52  PO4_0  1
 18TL01003_047_222685    50  0.88  PO4_0  1
 18TL01003_047_222684    68  1.29  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 14, station SEGB-08:

           sample_key depth value method qc
 18TL01003_047_222690     5  0.28 SiO4_0  1
 18TL01003_047_222689    10  0.20 SiO4_0  1
 18TL01003_047_222688    20  0.17 SiO4_0  1
 18TL01003_047_222687    29  0.18 SiO4_0  1
 18TL01003_047_222686    39  0.85 SiO4_0  7
 18TL01003_047_222685    50  1.51 SiO4_0  7
 18TL01003_047_222684    68  2.59 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 15, station SEGB-09:

           sample_key depth value   method qc
 18TL01003_058_222697     4  0.25 NO2NO3_0  1
 18TL01003_058_222696    10  0.09 NO2NO3_0  1
 18TL01003_058_222695    20  0.11 NO2NO3_0  1
 18TL01003_058_222694    30  0.11 NO2NO3_0  1
 18TL01003_058_222693    40  0.15 NO2NO3_0  1
 18TL01003_058_222692    50  1.38 NO2NO3_0  1
 18TL01003_058_222691    69  1.14 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 15, station SEGB-09:

           sample_key depth value method qc
 18TL01003_058_222697     4  0.45  PO4_0  1
 18TL01003_058_222696    10  0.49  PO4_0  1
 18TL01003_058_222695    20  0.46  PO4_0  1
 18TL01003_058_222694    30  0.50  PO4_0  1
 18TL01003_058_222693    40  0.49  PO4_0  1
 18TL01003_058_222692    50  0.53  PO4_0  7
 18TL01003_058_222691    69  0.67  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 15, station SEGB-09:

           sample_key depth value method qc
 18TL01003_058_222697     4  2.17 SiO4_0  1
 18TL01003_058_222696    10  2.03 SiO4_0  1
 18TL01003_058_222695    20  2.14 SiO4_0  1
 18TL01003_058_222694    30  2.09 SiO4_0  7
 18TL01003_058_222693    40  2.04 SiO4_0  7
 18TL01003_058_222692    50  1.25 SiO4_0  1
 18TL01003_058_222691    69  2.19 SiO4_0  3


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 16, station SEGB-10:

           sample_key depth value   method qc
 18TL01003_069_222704     5  0.24 NO2NO3_0  1
 18TL01003_069_222703    11  0.17 NO2NO3_0  1
 18TL01003_069_222702    20  0.17 NO2NO3_0  1
 18TL01003_069_222701    30  0.17 NO2NO3_0  1
 18TL01003_069_222700    40  0.21 NO2NO3_0  1
 18TL01003_069_222699    50  0.16 NO2NO3_0  7
 18TL01003_069_222698    67  0.56 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 16, station SEGB-10:

           sample_key depth value method qc
 18TL01003_069_222704     5  0.41  PO4_0  1
 18TL01003_069_222703    11  0.49  PO4_0  1
 18TL01003_069_222702    20  0.50  PO4_0  1
 18TL01003_069_222701    30  0.71  PO4_0  1
 18TL01003_069_222700    40  0.46  PO4_0  7
 18TL01003_069_222699    50  0.48  PO4_0  7
 18TL01003_069_222698    67  0.38  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 16, station SEGB-10:

           sample_key depth value method qc
 18TL01003_069_222704     5  2.26 SiO4_0  1
 18TL01003_069_222703    11  2.14 SiO4_0  1
 18TL01003_069_222702    20  1.76 SiO4_0  7
 18TL01003_069_222701    30  1.71 SiO4_0  7
 18TL01003_069_222700    40  2.05 SiO4_0  1
 18TL01003_069_222699    50  2.21 SiO4_0  3
 18TL01003_069_222698    67  2.16 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 17, station SEGB-11:

           sample_key depth value   method qc
 18TL01003_080_222711     5  0.17 NO2NO3_0  7
 18TL01003_080_222710    10  0.09 NO2NO3_0  1
 18TL01003_080_222708    31  0.09 NO2NO3_0  1
 18TL01003_080_222707    39  0.09 NO2NO3_0  7
 18TL01003_080_222706    51  0.15 NO2NO3_0  7
 18TL01003_080_222705    64  0.13 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 17, station SEGB-11:

           sample_key depth value method qc
 18TL01003_080_222711     5  0.41  PO4_0  1
 18TL01003_080_222710    10  0.31  PO4_0  1
 18TL01003_080_222708    31  0.33  PO4_0  7
 18TL01003_080_222707    39  0.32  PO4_0  7
 18TL01003_080_222706    51  0.51  PO4_0  1
 18TL01003_080_222705    64  0.43  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 17, station SEGB-11:

           sample_key depth value method qc
 18TL01003_080_222711     5  1.93 SiO4_0  1
 18TL01003_080_222710    10  2.67 SiO4_0  1
 18TL01003_080_222708    31  2.35 SiO4_0  1
 18TL01003_080_222707    39  2.47 SiO4_0  3
 18TL01003_080_222706    51  1.82 SiO4_0  1
 18TL01003_080_222705    64  1.79 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 18, station SEGB-12:

           sample_key depth value   method qc
 18TL01003_091_222718     5  0.10 NO2NO3_0  1
 18TL01003_091_222717    10  0.10 NO2NO3_0  1
 18TL01003_091_222716    20  0.10 NO2NO3_0  1
 18TL01003_091_222715    30  0.38 NO2NO3_0  1
 18TL01003_091_222714    40  0.13 NO2NO3_0  1
 18TL01003_091_222713    50  0.21 NO2NO3_0  1
 18TL01003_091_222712    59  0.46 NO2NO3_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 18, station SEGB-12:

           sample_key depth value method qc
 18TL01003_091_222718     5  0.36  PO4_0  3
 18TL01003_091_222717    10  0.42  PO4_0  1
 18TL01003_091_222716    20  0.49  PO4_0  1
 18TL01003_091_222715    30  0.74  PO4_0  1
 18TL01003_091_222714    40  0.50  PO4_0  1
 18TL01003_091_222713    50  0.49  PO4_0  1
 18TL01003_091_222712    59  0.32  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 18, station SEGB-12:

           sample_key depth value method qc
 18TL01003_091_222718     5  2.75 SiO4_0  1
 18TL01003_091_222717    10  2.72 SiO4_0  1
 18TL01003_091_222716    20  3.08 SiO4_0  1
 18TL01003_091_222715    30  3.31 SiO4_0  7
 18TL01003_091_222714    40  2.96 SiO4_0  7
 18TL01003_091_222713    50  2.84 SiO4_0  1
 18TL01003_091_222712    59  0.21 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 19, station SEGB-13:

           sample_key depth value   method qc
 18TL01003_102_222725     6  0.06 NO2NO3_0  1
 18TL01003_102_222724    11  0.00 NO2NO3_0  1
 18TL01003_102_222723    21  0.00 NO2NO3_0  1
 18TL01003_102_222722    30  0.24 NO2NO3_0  7
 18TL01003_102_222721    40  0.10 NO2NO3_0  1
 18TL01003_102_222720    50  2.29 NO2NO3_0  1
 18TL01003_102_222719    60  2.43 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 21, station SEGB-15:

           sample_key depth value method qc
 18TL01003_127_222736     4  0.59  PO4_0  1
 18TL01003_127_222735    10  0.70  PO4_0  1
 18TL01003_127_222734    20  0.68  PO4_0  1
 18TL01003_127_222733    30  0.86  PO4_0  1
 18TL01003_127_222732    40  0.81  PO4_0  1
 18TL01003_127_222731    51  0.88  PO4_0  7
 18TL01003_127_222730    75  0.87  PO4_0  1
 18TL01003_127_222729    99  0.96  PO4_0  1
 18TL01003_127_222728   149  1.14  PO4_0  1
 18TL01003_127_222727   384  0.96  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 21, station SEGB-15:

           sample_key depth value method qc
 18TL01003_127_222736     4  3.19 SiO4_0  1
 18TL01003_127_222735    10  3.30 SiO4_0  1
 18TL01003_127_222734    20  3.30 SiO4_0  1
 18TL01003_127_222733    30  3.85 SiO4_0  7
 18TL01003_127_222732    40  3.57 SiO4_0  7
 18TL01003_127_222731    51  4.68 SiO4_0  1
 18TL01003_127_222730    75  6.51 SiO4_0  1
 18TL01003_127_222729    99  7.13 SiO4_0  1
 18TL01003_127_222728   149  7.92 SiO4_0  1
 18TL01003_127_222727   384  7.83 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 70, station FC-09:

           sample_key depth value   method qc
 18TL01003_316_222925     5  0.00 NO2NO3_0  7
 18TL01003_316_222924    10  0.00 NO2NO3_0  1
 18TL01003_316_222923    20  0.00 NO2NO3_0  1
 18TL01003_316_222922    30  0.00 NO2NO3_0  1
 18TL01003_316_222921    40  0.00 NO2NO3_0  1
 18TL01003_316_222920    50  0.03 NO2NO3_0  1
 18TL01003_316_222919    76  4.88 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 70, station FC-09:

           sample_key depth value method qc
 18TL01003_316_222925     5  0.30  PO4_0  1
 18TL01003_316_222924    10  0.40  PO4_0  1
 18TL01003_316_222923    20  0.28  PO4_0  1
 18TL01003_316_222922    30  0.25  PO4_0  1
 18TL01003_316_222921    40  0.33  PO4_0  1
 18TL01003_316_222920    50  0.51  PO4_0  1
 18TL01003_316_222919    76  1.33  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 70, station FC-09:

           sample_key depth value method qc
 18TL01003_316_222925     5  0.00 SiO4_0  1
 18TL01003_316_222924    10  0.00 SiO4_0  1
 18TL01003_316_222923    20  0.00 SiO4_0  1
 18TL01003_316_222922    30  0.00 SiO4_0  1
 18TL01003_316_222921    40  0.00 SiO4_0  7
 18TL01003_316_222920    50  0.13 SiO4_0  7
 18TL01003_316_222919    76  3.69 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 72, station FC-07:

           sample_key depth value   method qc
 18TL01003_318_222934     6  0.48 NO2NO3_0  7
 18TL01003_318_222933    11  0.67 NO2NO3_0  7
 18TL01003_318_222932    20  0.44 NO2NO3_0  1
 18TL01003_318_222931    30  0.72 NO2NO3_0  3
 18TL01003_318_222930    41  0.93 NO2NO3_0  1
 18TL01003_318_222929    51  2.65 NO2NO3_0  1
 18TL01003_318_222928    73  4.54 NO2NO3_0  1
 18TL01003_318_222927    95  6.46 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 72, station FC-07:

           sample_key depth value method qc
 18TL01003_318_222934     6  0.30  PO4_0  7
 18TL01003_318_222933    11  0.20  PO4_0  1
 18TL01003_318_222932    20  0.42  PO4_0  1
 18TL01003_318_222931    30  0.43  PO4_0  1
 18TL01003_318_222930    41  0.58  PO4_0  1
 18TL01003_318_222929    51  0.91  PO4_0  1
 18TL01003_318_222928    73  1.01  PO4_0  1
 18TL01003_318_222927    95  1.52  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 72, station FC-07:

           sample_key depth value method qc
 18TL01003_318_222934     6  0.28 SiO4_0  1
 18TL01003_318_222933    11  0.46 SiO4_0  1
 18TL01003_318_222932    20  0.33 SiO4_0  1
 18TL01003_318_222931    30  0.13 SiO4_0  1
 18TL01003_318_222930    41  0.25 SiO4_0  1
 18TL01003_318_222929    51  1.12 SiO4_0  7
 18TL01003_318_222928    73  3.20 SiO4_0  7
 18TL01003_318_222927    95  7.19 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 73, station FC-06:

           sample_key depth value   method qc
 18TL01003_319_222942     6  1.40 NO2NO3_0  7
 18TL01003_319_222941    10  1.56 NO2NO3_0  7
 18TL01003_319_222940    19  0.69 NO2NO3_0  1
 18TL01003_319_222939    31  1.99 NO2NO3_0  1
 18TL01003_319_222938    40  3.06 NO2NO3_0  1
 18TL01003_319_222937    50  4.15 NO2NO3_0  1
 18TL01003_319_222936    74  4.74 NO2NO3_0  1
 18TL01003_319_222935    94  5.38 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 73, station FC-06:

           sample_key depth value method qc
 18TL01003_319_222942     6  0.34  PO4_0  7
 18TL01003_319_222941    10  0.40  PO4_0  1
 18TL01003_319_222940    19  0.56  PO4_0  1
 18TL01003_319_222939    31  0.52  PO4_0  1
 18TL01003_319_222938    40  0.78  PO4_0  1
 18TL01003_319_222937    50  0.69  PO4_0  1
 18TL01003_319_222936    74  0.74  PO4_0  1
 18TL01003_319_222935    94  1.10  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 73, station FC-06:

           sample_key depth value method qc
 18TL01003_319_222942     6  0.26 SiO4_0  3
 18TL01003_319_222941    10  0.11 SiO4_0  1
 18TL01003_319_222940    19  0.49 SiO4_0  1
 18TL01003_319_222939    31  1.14 SiO4_0  1
 18TL01003_319_222938    40  1.65 SiO4_0  1
 18TL01003_319_222937    50  3.26 SiO4_0  1
 18TL01003_319_222936    74  6.40 SiO4_0  1
 18TL01003_319_222935    94  7.87 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 74, station FC-05:

           sample_key depth value   method qc
 18TL01003_320_222951     5  3.00 NO2NO3_0  1
 18TL01003_320_222950    11  1.25 NO2NO3_0  1
 18TL01003_320_222949    20  1.11 NO2NO3_0  1
 18TL01003_320_222948    31  1.85 NO2NO3_0  7
 18TL01003_320_222947    39  1.40 NO2NO3_0  7
 18TL01003_320_222946    49  1.81 NO2NO3_0  1
 18TL01003_320_222945    76  4.24 NO2NO3_0  3
 18TL01003_320_222944   101  4.25 NO2NO3_0  1
 18TL01003_320_222943   129  5.85 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 74, station FC-05:

           sample_key depth value method qc
 18TL01003_320_222951     5  0.45  PO4_0  1
 18TL01003_320_222950    11  0.39  PO4_0  1
 18TL01003_320_222949    20  0.43  PO4_0  1
 18TL01003_320_222948    31  0.54  PO4_0  7
 18TL01003_320_222947    39  0.37  PO4_0  1
 18TL01003_320_222946    49  0.53  PO4_0  1
 18TL01003_320_222945    76  0.60  PO4_0  1
 18TL01003_320_222944   101  0.65  PO4_0  1
 18TL01003_320_222943   129  0.91  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 74, station FC-05:

           sample_key depth value method qc
 18TL01003_320_222951     5  2.28 SiO4_0  1
 18TL01003_320_222950    11  1.04 SiO4_0  1
 18TL01003_320_222949    20  1.10 SiO4_0  1
 18TL01003_320_222948    31  0.93 SiO4_0  1
 18TL01003_320_222947    39  0.86 SiO4_0  1
 18TL01003_320_222946    49  1.78 SiO4_0  1
 18TL01003_320_222945    76  4.22 SiO4_0  1
 18TL01003_320_222944   101  4.28 SiO4_0  1
 18TL01003_320_222943   129  7.12 SiO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 75, station FC-04:

           sample_key depth value   method qc
 18TL01003_321_222960     5  1.75 NO2NO3_0  1
 18TL01003_321_222959    11  1.86 NO2NO3_0  1
 18TL01003_321_222958    21  1.38 NO2NO3_0  7
 18TL01003_321_222957    30  0.67 NO2NO3_0  1
 18TL01003_321_222956    41  1.89 NO2NO3_0  1
 18TL01003_321_222955    50  3.12 NO2NO3_0  1
 18TL01003_321_222954    75  3.64 NO2NO3_0  1
 18TL01003_321_222953   100  4.26 NO2NO3_0  1
 18TL01003_321_222952   116  3.48 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 75, station FC-04:

           sample_key depth value method qc
 18TL01003_321_222960     5  0.49  PO4_0  1
 18TL01003_321_222959    11  0.51  PO4_0  1
 18TL01003_321_222958    21  0.38  PO4_0  1
 18TL01003_321_222957    30  0.22  PO4_0  1
 18TL01003_321_222956    41  0.51  PO4_0  1
 18TL01003_321_222955    50  0.80  PO4_0  1
 18TL01003_321_222954    75  0.69  PO4_0  1
 18TL01003_321_222953   100  0.76  PO4_0  1
 18TL01003_321_222952   116  0.78  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 75, station FC-04:

           sample_key depth value method qc
 18TL01003_321_222960     5  1.19 SiO4_0  1
 18TL01003_321_222959    11  0.45 SiO4_0  1
 18TL01003_321_222958    21  0.27 SiO4_0  1
 18TL01003_321_222957    30  0.00 SiO4_0  1
 18TL01003_321_222956    41  1.72 SiO4_0  1
 18TL01003_321_222955    50  1.90 SiO4_0  1
 18TL01003_321_222954    75  2.81 SiO4_0  7
 18TL01003_321_222953   100  2.76 SiO4_0  7
 18TL01003_321_222952   116  3.67 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 76, station FC-03:

           sample_key depth value method qc
 18TL01003_322_222970     6  0.46  PO4_0  1
 18TL01003_322_222969     9  0.57  PO4_0  1
 18TL01003_322_222968    21  0.46  PO4_0  1
 18TL01003_322_222967    30  0.56  PO4_0  1
 18TL01003_322_222966    40  0.67  PO4_0  1
 18TL01003_322_222965    50  0.39  PO4_0  1
 18TL01003_322_222964    76  1.13  PO4_0  7
 18TL01003_322_222963   100  0.78  PO4_0  1
 18TL01003_322_222962   124  0.90  PO4_0  1
 18TL01003_322_222961   149  0.78  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 76, station FC-03:

           sample_key depth value method qc
 18TL01003_322_222970     6  0.83 SiO4_0  1
 18TL01003_322_222969     9  1.34 SiO4_0  1
 18TL01003_322_222968    21  1.41 SiO4_0  1
 18TL01003_322_222967    30  1.04 SiO4_0  1
 18TL01003_322_222966    40  0.75 SiO4_0  7
 18TL01003_322_222965    50  0.00 SiO4_0  7
 18TL01003_322_222964    76  5.12 SiO4_0  1
 18TL01003_322_222963   100  4.12 SiO4_0  1
 18TL01003_322_222962   124  3.98 SiO4_0  1
 18TL01003_322_222961   149  7.48 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 77, station FC-02:

           sample_key depth value   method qc
 18TL01003_323_222980     5  1.73 NO2NO3_0  1
 18TL01003_323_222979    11  1.66 NO2NO3_0  1
 18TL01003_323_222978    21  1.47 NO2NO3_0  1
 18TL01003_323_222977    31  2.23 NO2NO3_0  1
 18TL01003_323_222976    40  3.18 NO2NO3_0  1
 18TL01003_323_222975    49  2.93 NO2NO3_0  1
 18TL01003_323_222974    74  4.10 NO2NO3_0  3
 18TL01003_323_222973   100  4.35 NO2NO3_0  1
 18TL01003_323_222972   149  5.80 NO2NO3_0  1
 18TL01003_323_222971   179  5.12 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 77, station FC-02:

           sample_key depth value method qc
 18TL01003_323_222980     5  0.55  PO4_0  1
 18TL01003_323_222979    11  0.52  PO4_0  1
 18TL01003_323_222978    21  0.62  PO4_0  1
 18TL01003_323_222977    31  0.66  PO4_0  1
 18TL01003_323_222976    40  0.81  PO4_0  1
 18TL01003_323_222975    49  0.92  PO4_0  3
 18TL01003_323_222974    74  0.99  PO4_0  1
 18TL01003_323_222973   100  0.93  PO4_0  1
 18TL01003_323_222972   149  0.95  PO4_0  1
 18TL01003_323_222971   179  1.09  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 77, station FC-02:

           sample_key depth value method qc
 18TL01003_323_222980     5  3.93 SiO4_0  1
 18TL01003_323_222979    11  3.73 SiO4_0  1
 18TL01003_323_222978    21  3.01 SiO4_0  1
 18TL01003_323_222977    31  2.33 SiO4_0  1
 18TL01003_323_222976    40  5.00 SiO4_0  1
 18TL01003_323_222975    49  3.59 SiO4_0  1
 18TL01003_323_222974    74  6.72 SiO4_0  1
 18TL01003_323_222973   100  6.02 SiO4_0  1
 18TL01003_323_222972   149  9.68 SiO4_0  7
 18TL01003_323_222971   179  9.75 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 78, station FC-01:

           sample_key depth value   method qc
 18TL01003_324_222988     5  2.35 NO2NO3_0  1
 18TL01003_324_222987     9  2.81 NO2NO3_0  7
 18TL01003_324_222986    19  2.63 NO2NO3_0  7
 18TL01003_324_222985    30  2.66 NO2NO3_0  1
 18TL01003_324_222984    40  2.78 NO2NO3_0  3
 18TL01003_324_222983    49  3.04 NO2NO3_0  1
 18TL01003_324_222982    74  3.52 NO2NO3_0  1
 18TL01003_324_222981    99  3.23 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 78, station FC-01:

           sample_key depth value method qc
 18TL01003_324_222988     5  0.98  PO4_0  7
 18TL01003_324_222987     9  0.66  PO4_0  7
 18TL01003_324_222986    19  0.72  PO4_0  1
 18TL01003_324_222985    30  0.58  PO4_0  3
 18TL01003_324_222984    40  0.67  PO4_0  1
 18TL01003_324_222983    49  0.74  PO4_0  1
 18TL01003_324_222982    74  0.78  PO4_0  1
 18TL01003_324_222981    99  0.74  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 81, station STN27:

           sample_key depth value   method qc
 18TL01003_328_222998     6  2.42 NO2NO3_0  1
 18TL01003_328_222997    11  2.09 NO2NO3_0  1
 18TL01003_328_222996    20  2.85 NO2NO3_0  7
 18TL01003_328_222995    30  2.13 NO2NO3_0  7
 18TL01003_328_222994    40  4.04 NO2NO3_0  1
 18TL01003_328_222992    74  2.83 NO2NO3_0  1
 18TL01003_328_222991    99  3.01 NO2NO3_0  1
 18TL01003_328_222990   150  4.21 NO2NO3_0  1
 18TL01003_328_222989   168  5.43 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 81, station STN27:

           sample_key depth value method qc
 18TL01003_328_222998     6  0.59  PO4_0  1
 18TL01003_328_222997    11  0.62  PO4_0  1
 18TL01003_328_222996    20  0.67  PO4_0  7
 18TL01003_328_222995    30  0.64  PO4_0  1
 18TL01003_328_222994    40  0.76  PO4_0  3
 18TL01003_328_222992    74  0.90  PO4_0  1
 18TL01003_328_222991    99  0.62  PO4_0  1
 18TL01003_328_222990   150  0.91  PO4_0  1
 18TL01003_328_222989   168  1.09  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 81, station STN27:

           sample_key depth value method qc
 18TL01003_328_222998     6  3.78 SiO4_0  1
 18TL01003_328_222997    11  3.16 SiO4_0  1
 18TL01003_328_222996    20  3.72 SiO4_0  3
 18TL01003_328_222995    30  3.40 SiO4_0  1
 18TL01003_328_222994    40  3.19 SiO4_0  1
 18TL01003_328_222992    74  2.95 SiO4_0  1
 18TL01003_328_222991    99  2.91 SiO4_0  1
 18TL01003_328_222990   150  5.27 SiO4_0  1
 18TL01003_328_222989   168  7.54 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 9, station SEGB-03:

           sample_key depth value method qc
 18TL01003_339_222178     5  0.64  PO4_0  1
 18TL01003_339_222177    11  0.64  PO4_0  1
 18TL01003_339_222176    21  0.65  PO4_0  3
 18TL01003_339_222175    30  0.58  PO4_0  1
 18TL01003_339_222174    40  0.57  PO4_0  1
 18TL01003_339_222173    49  0.63  PO4_0  1
 18TL01003_339_222172    75  0.71  PO4_0  1
 18TL01003_339_222171   100  0.72  PO4_0  1
 18TL01003_339_222170   148  1.73  PO4_0  1
 18TL01003_339_222169   163  0.69  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL01006"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL01006 FLAG Report:,  2019-03-15 12:32:51
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 1, station STN27:

           sample_key depth value   method qc
 18TL01006_002_253009     9  0.34 NO2NO3_0  1
 18TL01006_002_253008    20  0.00 NO2NO3_0  3
 18TL01006_002_253007    30  0.93 NO2NO3_0  1
 18TL01006_002_253006    39  0.52 NO2NO3_0  1
 18TL01006_002_253005    50  0.40 NO2NO3_0  1
 18TL01006_002_253004    74  3.92 NO2NO3_0  1
 18TL01006_002_253003   101  6.91 NO2NO3_0  1
 18TL01006_002_253002   150  7.50 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 10, station FC-07:

           sample_key depth value   method qc
 18TL01006_003_253053     6  0.00 NO2NO3_0  1
 18TL01006_003_253052    11  0.00 NO2NO3_0  1
 18TL01006_003_253051    21  0.00 NO2NO3_0  3
 18TL01006_003_253050    31  0.00 NO2NO3_0  1
 18TL01006_003_253049    41  0.00 NO2NO3_0  1
 18TL01006_003_253048    50  3.54 NO2NO3_0  1
 18TL01006_003_253047    75  7.05 NO2NO3_0  1
 18TL01006_003_253046   100  6.23 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 10, station FC-07:

           sample_key depth value method qc
 18TL01006_003_253053     6  0.31  PO4_0  1
 18TL01006_003_253052    11  0.22  PO4_0  3
 18TL01006_003_253051    21  0.16  PO4_0  1
 18TL01006_003_253050    31  0.25  PO4_0  1
 18TL01006_003_253049    41  0.43  PO4_0  1
 18TL01006_003_253048    50  1.16  PO4_0  1
 18TL01006_003_253047    75  1.49  PO4_0  1
 18TL01006_003_253046   100  1.01  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 13, station FC-10:

           sample_key depth value method qc
 18TL01006_036_253068     5  0.39  PO4_0  3
 18TL01006_036_253067    10  0.35  PO4_0  1
 18TL01006_036_253066    20  0.35  PO4_0  1
 18TL01006_036_253065    30  0.22  PO4_0  1
 18TL01006_036_253064    39  0.57  PO4_0  1
 18TL01006_036_253063    50  1.21  PO4_0  1
 18TL01006_036_253062    76  1.89  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 4, station FC-01:

           sample_key depth value method qc
 18TL01006_264_253018     6  0.39 SiO4_0  1
 18TL01006_264_253017    12  0.11 SiO4_0  1
 18TL01006_264_253016    21  0.41 SiO4_0  1
 18TL01006_264_253015    31  0.33 SiO4_0  1
 18TL01006_264_253014    40  0.30 SiO4_0  1
 18TL01006_264_253013    49  0.24 SiO4_0  3
 18TL01006_264_253012    76  3.33 SiO4_0  1
 18TL01006_264_253011    96  6.32 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 6, station FC-03:

           sample_key depth value method qc
 18TL01006_304_253027     6  0.12 SiO4_0  1
 18TL01006_304_253026    10  0.08 SiO4_0  1
 18TL01006_304_253025    21  0.18 SiO4_0  1
 18TL01006_304_253024    31  0.41 SiO4_0  1
 18TL01006_304_253023    41  0.19 SiO4_0  3
 18TL01006_304_253022    50  0.07 SiO4_0  1
 18TL01006_304_253021    75  0.91 SiO4_0  1
 18TL01006_304_253020   100  8.32 SiO4_0  1
 18TL01006_304_253019   151 16.46 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 8, station FC-05:

           sample_key depth value method qc
 18TL01006_326_253045     6  0.27 SiO4_0  1
 18TL01006_326_253044    11  0.26 SiO4_0  3
 18TL01006_326_253043    21  0.27 SiO4_0  1
 18TL01006_326_253042    31  0.93 SiO4_0  1
 18TL01006_326_253041    40  0.64 SiO4_0  1
 18TL01006_326_253040    51  3.29 SiO4_0  1
 18TL01006_326_253039    76  1.25 SiO4_0  1
 18TL01006_326_253038   101  5.89 SiO4_0  1
 18TL01006_326_253037   130  1.95 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL02005"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL02005 FLAG Report:,  2019-03-15 12:33:28
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged NITRATE, event 6, station SEGB-05:

           sample_key depth value   method qc
 18TL02005_304_254360     5  2.76 NO2NO3_0  1
 18TL02005_304_254359    10  2.68 NO2NO3_0  1
 18TL02005_304_254358    20  3.04 NO2NO3_0  1
 18TL02005_304_254357    30  2.96 NO2NO3_0  1
 18TL02005_304_254356    40  4.36 NO2NO3_0  1
 18TL02005_304_254355    49  5.10 NO2NO3_0  7
 18TL02005_304_254354    74  5.92 NO2NO3_0  1
 18TL02005_304_254353    84  5.65 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 6, station SEGB-05:

           sample_key depth value method qc
 18TL02005_304_254360     5  1.03  PO4_0  1
 18TL02005_304_254359    10  0.76  PO4_0  1
 18TL02005_304_254358    20  0.70  PO4_0  1
 18TL02005_304_254357    30  0.91  PO4_0  1
 18TL02005_304_254356    40  0.92  PO4_0  7
 18TL02005_304_254355    49  1.11  PO4_0  1
 18TL02005_304_254354    74  1.23  PO4_0  1
 18TL02005_304_254353    84  1.03  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 6, station SEGB-05:

           sample_key depth value method qc
 18TL02005_304_254360     5  1.65 SiO4_0  1
 18TL02005_304_254359    10  1.50 SiO4_0  1
 18TL02005_304_254358    20  1.15 SiO4_0  7
 18TL02005_304_254357    30  1.43 SiO4_0  1
 18TL02005_304_254356    40  3.12 SiO4_0  1
 18TL02005_304_254355    49  4.25 SiO4_0  1
 18TL02005_304_254354    74  5.57 SiO4_0  1
 18TL02005_304_254353    84  5.36 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event 7, station SEGB-06:

           sample_key depth value   method qc
 18TL02005_315_254367     5  5.44 NO2NO3_0  1
 18TL02005_315_254366    10  5.27 NO2NO3_0  1
 18TL02005_315_254365    20  5.23 NO2NO3_0  1
 18TL02005_315_254364    30  5.12 NO2NO3_0  1
 18TL02005_315_254363    40  5.52 NO2NO3_0  1
 18TL02005_315_254362    49  5.52 NO2NO3_0  7
 18TL02005_315_254361    74  6.65 NO2NO3_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 8, station SEGB-07:

           sample_key depth value method qc
 18TL02005_326_254374     5  0.74  PO4_0  1
 18TL02005_326_254373    11  0.72  PO4_0  1
 18TL02005_326_254372    21  0.76  PO4_0  1
 18TL02005_326_254371    30  0.78  PO4_0  1
 18TL02005_326_254370    40  0.70  PO4_0  1
 18TL02005_326_254369    50  0.89  PO4_0  7
 18TL02005_326_254368    76  1.13  PO4_0  7


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL02010"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL02010 FLAG Report:,  2019-03-15 12:34:28
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL03004"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL03004 FLAG Report:,  2019-03-15 12:34:58
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged SILICATE, event 49, station FC-07:

           sample_key depth value method qc
 18TL03004_283_256343     4  2.17 SiO4_0  1
 18TL03004_283_256342    10  1.89 SiO4_0  1
 18TL03004_283_256341    20  2.08 SiO4_0  3
 18TL03004_283_256340    30  2.29 SiO4_0  1
 18TL03004_283_256339    39  2.15 SiO4_0  1
 18TL03004_283_256338    49  1.61 SiO4_0  1
 18TL03004_283_256337    74  6.11 SiO4_0  1
 18TL03004_283_256336   100  8.39 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged PHOSPHATE, event 52, station FC-04:

           sample_key depth value method qc
 18TL03004_296_256362     5  0.74  PO4_0  1
 18TL03004_296_256361    10  0.57  PO4_0  1
 18TL03004_296_256360    20  0.63  PO4_0  1
 18TL03004_296_256359    31  1.26  PO4_0  1
 18TL03004_296_256358    41  0.68  PO4_0  1
 18TL03004_296_256357    50  0.64  PO4_0  3
 18TL03004_296_256356    75  0.66  PO4_0  1
 18TL03004_296_256355   100  0.74  PO4_0  1
 18TL03004_296_256354   119  0.93  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged SILICATE, event 52, station FC-04:

           sample_key depth value method qc
 18TL03004_296_256362     5  2.63 SiO4_0  1
 18TL03004_296_256361    10  1.73 SiO4_0  1
 18TL03004_296_256360    20  1.63 SiO4_0  1
 18TL03004_296_256359    31  6.77 SiO4_0  4
 18TL03004_296_256358    41  1.06 SiO4_0  1
 18TL03004_296_256357    50  1.76 SiO4_0  1
 18TL03004_296_256356    75  1.58 SiO4_0  1
 18TL03004_296_256355   100  2.88 SiO4_0  1
 18TL03004_296_256354   119  8.16 SiO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL04021"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL04021 FLAG Report:,  2019-03-15 12:35:25
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged OXYGEN, event IML2004021361, station 361:

 sample_key  depth O2_CTD_mLL qc
              1.59   308.3773  0
              4.86   310.5656  0
             14.18   317.1307  0
             24.19   324.8122  0
             52.95   313.9598  0
             98.65   300.2492  0
            198.63   202.8457  0
            250.44   160.8207  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged NITRATE, event IML2004021401, station 401:

 sample_key  depth  value        method qc
              4.66  0.555 NO2NO3_Alp_SF  1
             14.38  0.175 NO2NO3_Alp_SF  1
             25.29  0.295 NO2NO3_Alp_SF  2
             51.17  0.925 NO2NO3_Alp_SF  1
            100.63  4.460 NO2NO3_Alp_SF  1
            175.16 15.985 NO2NO3_Alp_SF  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL04033"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL04033 FLAG Report:,  2019-03-15 12:35:58
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL04524"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL04524 FLAG Report:,  2019-03-15 12:36:35
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL05035"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL05035 FLAG Report:,  2019-03-15 12:37:05
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged OXYGEN, event IML2005035591, station 591:

 sample_key depth O2_CTD_mLL qc
             1.79   313.9151  0
             5.45   313.6918  0
            15.67   331.3325  0
            25.68   333.6549  0
            50.47   324.4549  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL05045"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL05045 FLAG Report:,  2019-03-15 12:37:28
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged OXYGEN, event IML2005045231, station 231:

 sample_key  depth O2_CTD_mLL qc
              1.09   267.6920  0
            249.74   168.8148  0
            423.08   202.3545  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)



-> Flagged OXYGEN, event IML2005045371, station 371:

 sample_key  depth O2_CTD_mLL qc
              2.48   268.9425  0
            249.54   170.5119  0
            495.02   203.0690  0


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> sink()

> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL05601"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)

> cat("\n")


> cat(paste(mission,"FLAG Report:, ", n))
18TL05601 FLAG Report:,  2019-03-15 12:37:50
> cat("\n")


> cat(c("-----------------------","\n","\n"))
----------------------- 
 

> # ========================= #
> # PLOT DATA FOR EACH EVENT
> # ========================= #
> 
> 
> for (i in 1:length(fe)) {
+   
+   event=sprintf( .... [TRUNCATED] 
-> Flagged PHOSPHATE, event 53, station STN27:

           sample_key depth value method qc
 18TL05601_297_259898     4  0.31  PO4_0  1
 18TL05601_297_259897    10  0.52  PO4_0  1
 18TL05601_297_259896    20  0.28  PO4_0  1
 18TL05601_297_259895    30  0.31  PO4_0  1
 18TL05601_297_259894    40  0.27  PO4_0  2
 18TL05601_297_259893    49  0.26  PO4_0  2
 18TL05601_297_259892    75  0.46  PO4_0  1
 18TL05601_297_259891    99  0.72  PO4_0  1
 18TL05601_297_259890   149  1.16  PO4_0  1
 18TL05601_297_259889   172  1.30  PO4_0  1


-> QC repot:
[1] Filename    Pressure    Uniqueno    Variable    Values      Test.failed
<0 rows> (or 0-length row.names)




> # plot flagged profiles using BC flagged file
> #original file from Gordana Lazin
> #updated by E Chisholm, March 2019
> 
> 
> source("flagcol2.r")

> require(lubridate)

> source("plot_profiles.r")

> wd="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC"

> # load flagged BCD file
> mission="18TL06043"

> fn=file.path(paste0(wd,'/BCD/',mission, '/',mission,"_BCD_flagged.csv"))

> df0=data.frame(read.csv(fn,  header = F, quote = '', fill = T, stringsAsFactors = F))

> names(df0) <- df0[1,]

> df0 <- df0[-1,1:25]

> df0$DIS_HEADER_START_DEPTH <- as.numeric(df0$DIS_HEADER_START_DEPTH)

> df0$DIS_DETAIL_DATA_VAL <- as.numeric(df0$DIS_DETAIL_DATA_VAL)

> # load QC report files 
> qc_folder="C:/Users/ChisholmE/Documents/BIOCHEM/IML QC/QC_V6"

> qcf=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format.txt")

> qcf_ctd=paste0("QC_data_",substr(mission,nchar(mission)-4,nchar(mission)),"_IML_format_ctd.txt")

> qcrep=read.table(file.path(qc_folder,qcf), stringsAsFactors=F, sep=";", header=T)

> #no ctd data
> #qcrep_ctd=read.table(file.path(qc_folder,qcf_ctd), stringsAsFactors=F, sep=";", header=T)
> 
> # if (mission %in% c("HUD99054","HUD9 ..." ... [TRUNCATED] 

> qcpar <-  vars$BCD_FIELDS[vars$qc == 'qc']

> #qcpar=c("Temp_CTD_1968","Salinity_CTD","O2_CTD_mLL","Salinity_Sal_PSS","Chl_a_Holm-Hansen_F","pH_CTD",
>         #"Chl_Fluor_Voltage", "O2_Electrod ..." ... [TRUNCATED] 

> # find events for which the dat was flagged
> 
> # 1. find indices of flagged data, fi
> fi=which(df$DIS_DETAIL_DATA_QC_CODE>1)

> # 2. Find flagged events, fe
> fe=unique(df$EVENT_COLLECTOR_EVENT_ID[fi])

> # order flagged events by event number
> fe=fe[order(fe)]

> # =================== #
> # DEFINE REPORT FILE
> # =================== #
> outpath=file.path(paste0(wd,'/BCD/',mission))

> n=now() # make time stamp to mark the start of processing

> timestamp=paste0(year(n), sprintf("%02d",month(n)),sprintf("%02d",day(n)),
+                  sprintf("%02d",hour(n)),sprintf("%02d",minute(n)),spri .... [TRUNCATED] 

> # name of the report file                 
> report_file=paste0("FLAG_report_",mission,"_",timestamp, ".txt")

> report_file=file.path(outpath,report_file)

> # write input files into report
> sink(file=report_file,append=TRUE, split=TRUE)
